<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.157.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Rise的自留地"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Rise,ZhangTuohui,技术,C++,Unity3D,Lua,NodeJS,C#,JavaScript,游戏开发,机器学习,深度学习,AI,编程,编程语言,编程技术,编程开发,游戏引擎,游戏设计,游戏制作,游戏开发者,游戏开发者博客,游戏开发者网站,游戏开发者工具,游戏开发者教程,游戏开发者学习,游戏开发者交流,游戏开发者分享,游戏开发者经验,游戏开发者心得,游戏开发者技巧,游戏开发者方法,游戏开发者思路,游戏开发者理念,游戏开发者文化,游戏开发者精神,游戏开发者信仰"><meta property="og:type" content="website"><meta property="og:title" content="Rise的自留地"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1772265586"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class="hvr-icon-pulse menu-item-active" rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>679</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>679</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>35</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>118</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2423147></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5207></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2026-02-28 15:59:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner index posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/lua-script-syntax-explanation-revised/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Lua脚本语法说明（修订）"><meta itemprop=description content='Lua脚本语法说明（增加lua5.1部份特性）　　Lua 的语法比较简单，学习起来也比较省力，但功能却并不弱。　　所以，我只简单的归纳一下Lua的一些语法规则，使用起来方便好查就可以了。估计看完了，就懂得怎么写Lua程序了。　　在Lua中，一切都是变量，除了关键字。I.&nbsp; 首先是注释　　写一个程序，总是少不了注释的。　　在Lua中，你可以使用单行注释和多行注释。　　单行注释中，连续两个减号"--"表示注释的开始，一直延续到行末为止。相当于C++语言中的"//"。　　多行注释中，由"--[["表示注释开始，并且一直延续到"]]"为止。这种注释相当于C语言中的"/*...*/"。在注释当中，"[["和"]]"是可以嵌套的（在lua5.1中，中括号中间是可以加若干个"="号的，如 [==[ ... ]==]），见下面的字符串表示说明。II.&nbsp; Lua编程　　经典的"Hello world"的程序总是被用来开始介绍一种语言。在Lua中，写一个这样的程序很简单：　　print("Hello world")　　在Lua中，语句之间可以用分号"；"隔开，也可以用空白隔开。一般来说，如果多个语句写在同一行的话，建议总是用分号隔开。　　Lua 有好几种程序控制语句，如：



控制语句
格式
示例

If
if 条件 then ... elseif 条件 then ... else ... end

if&nbsp;1+1=2&nbsp;then&nbsp;print("true")elseif&nbsp;1+2~=3&nbsp;then&nbsp;print("true")else&nbsp;print("false")&nbsp;end

While
while 条件 do ... end

while&nbsp;1+1~=2&nbsp;do&nbsp;print("true")&nbsp;end

Repeat
repeat ... until 条件

repeat&nbsp;print("Hello")&nbsp;until&nbsp;1+1~=2

For
for 变量=初值, 终点值, 步进 do&nbsp;... end

for&nbsp;i&nbsp;=&nbsp;1,&nbsp;10,&nbsp;2&nbsp;do&nbsp;print(i)&nbsp;end

For
for 变量1, 变量2, ... 变量n in 表或枚举函数 do ... end

for&nbsp;a,b&nbsp;in&nbsp;mylist&nbsp;do&nbsp;print(a,&nbsp;b)&nbsp;end　　注意一下，for的循环变量总是只作用于for的局部变量；当省略步进值时，for循环会使用1作为步进值。　　使用break可以用来中止一个循环。　　相对C语言来说，Lua有几个地方是明显不同的，所以面要特别注意一下：　　．语句块　　　　语句块在C中是用"{"和"}"括起来的，在Lua中，它是用do 和 end 括起来的。比如：　　　　do print("Hello") end　　　　可以在 函数 中和 语句块 中定局部变量。　　．赋值语句　　　　赋值语句在Lua被强化了。它可以同时给多个变量赋值。　　　　例如：　　　　a,b,c,d=1,2,3,4　　　　甚至是：　　　　a,b=b,a&nbsp; -- 多么方便的交换变量功能啊。　　　　在默认情况下，变量总是认为是全局的。假如需要定义局部变量，则在第一次赋值的时候，需要用local说明。比如：　　　　local a,b,c = 1,2,3&nbsp; -- a,b,c都是局部变量　　．数值运算　　　　和C语言一样，支持 +, -, *, /。但Lua还多了一个"^"。这表示指数乘方运算。比如2^3 结果为8, 2^4结果为16。　　　　连接两个字符串，可以用".."运处符。如：　　　　"This a " .. "string." -- 等于 "this a string"　　．比较运算



比较符号
<
>
<=
>=
==
~=

含义
小于
大于
小于或等于
大于或等于
相等
不相等　　　　所有这些操作符总是返回true或false。　　　　对于Table，Function和Userdata类型的数据，只有 == 和 ~=可以用。相等表示两个变量引用的是同一个数据。比如：
　　　　a={1,2}　　　　b=a　　　　print(a==b,&nbsp;a~=b)&nbsp;&nbsp;--输出&nbsp;true,&nbsp;false　　　　a={1,2}　　　　b={1,2}　　　　print(a==b,&nbsp;a~=b)&nbsp;&nbsp;--输出&nbsp;false,&nbsp;true　　．逻辑运算　　　　and, or, not　　　　其中，and 和 or 与C语言区别特别大。　　　　在这里，请先记住，在Lua中，只有false和nil才计算为false，其它任何数据都计算为true，0也是true！　　　　and 和 or的运算结果不是true和false，而是和它的两个操作数相关。　　　　a and b：如果a为false，则返回a；否则返回b　　　　a or b：如果 a 为true，则返回a；否则返回b　　　　举几个例子：
　　　　&nbsp;print(4&nbsp;and&nbsp;5)&nbsp;--输出&nbsp;5　　　　&nbsp;print(nil&nbsp;and&nbsp;13)&nbsp;--输出&nbsp;nil　　　　&nbsp;print(false&nbsp;and&nbsp;13)&nbsp;--输出&nbsp;false　　　　&nbsp;print(4&nbsp;or&nbsp;5)&nbsp;--输出&nbsp;4　　　　&nbsp;print(false&nbsp;or&nbsp;5)&nbsp;--输出&nbsp;5　　　　在Lua中这是很有用的特性，也是比较令人混洧的特性。　　　　我们可以模拟C语言中的语句：x = a? b : c，在Lua中，可以写成：x = a and b or c。　　　　最有用的语句是： x = x or v，它相当于：if not x then x = v end 。　　．运算符优先级，从低到高顺序如下：



&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp; and&nbsp;&nbsp;&nbsp;&nbsp; <&nbsp;&nbsp;&nbsp;&nbsp; >&nbsp;&nbsp;&nbsp;&nbsp; <=&nbsp;&nbsp;&nbsp; >=&nbsp;&nbsp;&nbsp; ~=&nbsp;&nbsp;&nbsp; ==&nbsp;&nbsp;&nbsp;&nbsp; .. (字符串连接)&nbsp;&nbsp;&nbsp;&nbsp; +&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp; %&nbsp;&nbsp;&nbsp;&nbsp; not&nbsp;&nbsp; #(lua5.1 取长度运算)&nbsp;&nbsp;&nbsp;&nbsp; - (一元运算)&nbsp;&nbsp;&nbsp;&nbsp; ^和C语言一样，括号可以改变优先级。III.&nbsp; 关键字　　关键字是不能做为变量的。Lua的关键字不多，就以下几个：&nbsp;&nbsp;&nbsp;&nbsp; 



and
break
do
else
elseif


end
false
for
function
if


in
local
nil
not
or


repeat
return
then
true
until
whileIV.&nbsp; 变量类型　　怎么确定一个变量是什么类型的呢？大家可以用type()函数来检查。Lua支持的类型有以下几种：



Nil
空值，所有没有使用过的变量，都是nil。nil既是值，又是类型。

Boolean
布尔值，只有两个有效值：true和false

Number
数值，在Lua里，数值相当于C语言的double

String
字符串，如果你愿意的话，字符串是可以包含"\0"字符的（这和C语言总是以"\0"结尾是不一样的）

Table
关系表类型，这个类型功能比较强大，请参考后面的内容。

Function
函数类型，不要怀疑，函数也是一种类型，也就是说，所有的函数，它本身就是一个变量。

Userdata
嗯，这个类型专门用来和Lua的宿主打交道的。宿主通常是用C和C++来编写的，在这种情况下，Userdata可以是宿主的任意数据类型，常用的有Struct和指针。

Thread
线程类型，在Lua中没有真正的线程。Lua中可以将一个函数分成几部份运行。如果感兴趣的话，可以去看看Lua的文档。现在回过头来看看，倒觉得不是线程类型。反而象是用来做遍历的，象是Iterator函数。如：
function&nbsp;range(n)&nbsp; local i&nbsp;=&nbsp;0&nbsp;&nbsp;while(i&nbsp;<&nbsp;n)&nbsp;do &nbsp;&nbsp;&nbsp; coroutine.yield( i )&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;i&nbsp;+&nbsp;1&nbsp;&nbsp;endend可惜的是要继续运行，需要coroutine.resume函数，有点鸡肋。请指教。V.&nbsp; 变量的定义　　所有的语言，都要用到变量。在Lua中，不管在什么地方使用变量，都不需要声明，并且所有的这些变量总是全局变量，除非我们在前面加上"local"。这一点要特别注意，因为我们可能想在函数里使用局部变量，却忘了用local来说明。　　至于变量名字，它是大小写相关的。也就是说，A和a是两个不同的变量。　　定义一个变量的方法就是赋值。"＝"操作就是用来赋值的　　我们一起来定义几种常用类型的变量吧。　　A.&nbsp; Nil　　　　正如前面所说的，没有使用过的变量的值，都是Nil。有时候我们也需要将一个变量清除，这时候，我们可以直接给变量赋以nil值。如：
　　　　var1=nil&nbsp;&nbsp;--&nbsp;请注意&nbsp;nil&nbsp;一定要小写　　B.&nbsp; Boolean　　　　布尔值通常是用在进行条件判断的时候。布尔值有两种：true 和 false。在Lua中，只有false和nil才被计算为false，而所有任何其它类型的值，都是true。比如0，空串等等，都是true。不要被 C语言的习惯所误导，0在Lua中的的确确是true。你也可以直接给一个变量赋以Boolean类型的值，如：
　　　　theBoolean&nbsp;=&nbsp;true　　C.&nbsp; Number　　　　在Lua中，是没有整数类型的，也不需要。一般情况下，只要数值不是很大（比如不超过100,000,000,000,000），是不会产生舍入误差的。在WindowsXP能跑的当今主流PC上，实数的运算并不比整数慢。　　　　实数的表示方法，同C语言类似，如：　　　　4 0.4 4.57e-3 0.3e12 5e+20　　D.&nbsp; String　　　　字符串，总是一种非常常用的高级类型。在Lua中，我们可以非常方便的定义很长很长的字符串。　　　　字符串在Lua中有几种方法来表示，最通用的方法，是用双引号或单引号来括起一个字符串的，如：　　　　"That&#39;s go!"　　　　或　　　　&#39;Hello world!&#39;　　　　和C语言相同的，它支持一些转义字符，列表如下：　　　　\a&nbsp; bell　　　　\b&nbsp; back space　　　　\f&nbsp; form feed　　　　\n&nbsp; newline　　　　\r&nbsp; carriage return　　　　\t&nbsp; horizontal tab　　　　\v&nbsp; vertical tab　　　　\\&nbsp; backslash　　　　\"&nbsp; double quote　　　　\"&nbsp; single quote　　　　\[&nbsp; left square bracket　　　　\]&nbsp; right square bracket　　　　由于这种字符串只能写在一行中，因此，不可避免的要用到转义字符。加入了转义字符的串，看起来实在是不敢恭维，比如：　　　　"one line\nnext line\n\"in quotes\", "in quotes""　　　　一大堆的"\"符号让人看起来很倒胃口。如果你与我有同感，那么，我们在Lua中，可以用另一种表示方法：用"[["和"]]"将多行的字符串括起来。（lua5.1: 中括号中间可以加入若干个"="号，如 [==[ ... ]==]，详见下面示例）　　　　示例：下面的语句所表示的是完全相同的字符串：
a&nbsp;=&nbsp;&#39;alo\n123"&#39;a&nbsp;=&nbsp;"alo\n123\""a&nbsp;=&nbsp;&#39;\97lo\10\04923"&#39;a&nbsp;=&nbsp;[[alo123"]]a&nbsp;=&nbsp;[==[alo123"]==]　　　　值得注意的是，在这种字符串中，如果含有单独使用的"[["或"]]"就仍然得用"\["或"\]"来避免歧义。当然，这种情况是极少会发生的。　　E.&nbsp; Table　　　　关系表类型，这是一个很强大的类型。我们可以把这个类型看作是一个数组。只是C语言的数组，只能用正整数来作索引；在Lua中，你可以用任意类型来作数组的索引，除了nil。同样，在C语言中，数组的内容只允许一种类型；在Lua中，你也可以用任意类型的值来作数组的内容，除了nil。　　　　Table的定义很简单，它的主要特征是用"{"和"}"来括起一系列数据元素的。比如：
　　　　T1&nbsp;=&nbsp;{}&nbsp;&nbsp;--&nbsp;定义一个空表　　　　T1[1]=10&nbsp;&nbsp;--&nbsp;然后我们就可以象C语言一样来使用它了。
　　　　T1["John"]={Age=27,&nbsp;Gender="Male"}　　　　这一句相当于：　　　　T1["John"]={}&nbsp;&nbsp;--&nbsp;必须先定义成一个表，还记得未定义的变量是nil类型吗　　　　T1["John"]["Age"]=27　　　　T1["John"]["Gender"]="Male"　　　　当表的索引是字符串的时候，我们可以简写成：　　　　T1.John={}　　　　T1.John.Age=27　　　　T1.John.Gender="Male"　　　　或　　　　T1.John{Age=27,&nbsp;Gender="Male"}这是一个很强的特性。　　　　在定义表的时候，我们可以把所有的数据内容一起写在"{"和"}"之间，这样子是非常方便，而且很好看。比如，前面的T1的定义，我们可以这么写：
　　　　T1=　　　　{　　　　　　10,&nbsp;&nbsp;--&nbsp;相当于&nbsp;[1]&nbsp;=&nbsp;10　　　　　　[100]&nbsp;=&nbsp;40,　　　　　　John=&nbsp;&nbsp;--&nbsp;如果你原意，你还可以写成：["John"]&nbsp;=　　　　　　{　　　　　　　　Age=27,&nbsp;&nbsp;&nbsp;--&nbsp;如果你原意，你还可以写成：["Age"]&nbsp;=27　　　　　　　　Gender=Male&nbsp;&nbsp;&nbsp;--&nbsp;如果你原意，你还可以写成：["Gender"]&nbsp;=Male　　　　　　},　　　　　　20&nbsp;&nbsp;--&nbsp;相当于&nbsp;[2]&nbsp;=&nbsp;20　　　　}　　　　看起来很漂亮，不是吗？我们在写的时候，需要注意三点：　　　　第一，所有元素之间，总是用逗号"，"隔开；　　　　第二，所有索引值都需要用"["和"]"括起来；如果是字符串，还可以去掉引号和中括号；　　　　第三，如果不写索引，则索引就会被认为是数字，并按顺序自动从1往后编；　　　　表类型的构造是如此的方便，以致于常常被人用来代替配置文件。是的，不用怀疑，它比ini文件要漂亮，并且强大的多。　　F.&nbsp; Function　　　　函数，在Lua中，函数的定义也很简单。典型的定义如下：
　　　　function&nbsp;add(a,b)&nbsp;&nbsp;--&nbsp;add&nbsp;是函数名字，a和b是参数名字　　　　&nbsp;return&nbsp;a+b&nbsp;&nbsp;--&nbsp;return&nbsp;用来返回函数的运行结果　　　　end　　　　请注意，return语言一定要写在end之前。假如我们非要在中间放上一句return，那么就应该要写成：do return end。　　　　还记得前面说过，函数也是变量类型吗？上面的函数定义，其实相当于：
　　　　add&nbsp;=&nbsp;function&nbsp;(a,b)&nbsp;return&nbsp;a+b&nbsp;end当重新给add赋值时，它就不再表示这个函数了。我们甚至可以赋给add任意数据，包括nil （这样，赋值为nil，将会把该变量清除）。Function是不是很象C语言的函数指针呢？　　　　和C语言一样，Lua的函数可以接受可变参数个数，它同样是用"..."来定义的，比如：
　　　　function&nbsp;sum&nbsp;(a,b,)如果想取得...所代表的参数，可以在函数中访问arg局部变量（表类型）得到 (lua5.1: 取消arg，并直接用"..."来代表可变参数了，本质还是arg)。　　　　如 sum(1,2,3,4)　　　　则，在函数中，a = 1, b = 2, arg = {3, 4}&nbsp; (lua5.1:&nbsp; a = 1, b = 2, ... = {3, 4})　　　　更可贵的是，它可以同时返回多个结果，比如：
　　　　function&nbsp;s()　　　　　　return&nbsp;1,2,3,4　　　　end　　　　a,b,c,d&nbsp;=&nbsp;s()&nbsp;&nbsp;--&nbsp;此时，a&nbsp;=&nbsp;1,&nbsp;b&nbsp;=&nbsp;2,&nbsp;c&nbsp;=&nbsp;3,&nbsp;d&nbsp;=&nbsp;4　　　　前面说过，表类型可以拥有任意类型的值，包括函数！因此，有一个很强大的特性是，拥有函数的表，哦，我想更恰当的应该说是对象吧。Lua可以使用面向对象编程了。不信？举例如下：
　　　　t&nbsp;=　　　　{　　　　&nbsp;Age&nbsp;=&nbsp;27　　　　&nbsp;add&nbsp;=&nbsp;function(self,&nbsp;n)&nbsp;self.Age&nbsp;=&nbsp;self.Age+n&nbsp;end　　　　}　　　　print(t.Age)&nbsp;&nbsp;--&nbsp;27　　　　t.add(t,&nbsp;10)　　　　print(t.Age)&nbsp;&nbsp;--&nbsp;37　　　　不过，t.add(t,10) 这一句实在是有点土对吧？没关系，在Lua中，我们可以简写成：
　　　　t:add(10)&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;相当于&nbsp;t.add(t,10)　　G.&nbsp; Userdata 和 Thread　　　　这两个类型的话题，超出了本文的内容，就不打算细说了。VI.&nbsp; 结束语　　就这么结束了吗？当然不是，接下来，我们需要用Lua解释器，来帮助理解和实践了。相信这样会更快的对Lua上手了。　　就象C语言一样，Lua提供了相当多的标准函数来增强语言的功能。使用这些标准函数，可以很方便的操作各种数据类型，并处理输入输出。有关这方面的信息，我们可以参考《Programming in Lua 》一书，也可以在网络上直接观看电子版，网址为：http://www.lua.org/pil/index.html　　备注：本文的部份内容摘、译自lua随机文档。相关链接：1. Lua 官方网站： http://www.lua.org/ 2. Lua Wiki网站，你可以在这里找到很多相关的资料，如文档、教程、扩展，以及C/C++的包装等： http://lua-users.org/wiki/3. Lua 打包下载（包括各种平台和编译器的工程文件如vs2003,vs2005）：http://luabinaries.luaforge.net/download.html这是我编译好的Lua5.02的解释器：http://www.cnblogs.com/Files/ly4cn/lua.zip'></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/lua-script-syntax-explanation-revised/ itemprop=url class=post-title-link>Lua脚本语法说明（修订）</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月21日 15:40:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-21 15:40:00 +0800 +0800">2007年09月21日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/lua/ itemprop=url rel=index><span itemprop=name>dev/Lua</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/lua-script-syntax-explanation-revised/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><div class=postText>Lua脚本语法说明（增加lua5.1部份特性）<br><br>　　Lua 的语法比较简单，学习起来也比较省力，但功能却并不弱。<br>　　所以，我只简单的归纳一下Lua的一些语法规则，使用起来方便好查就可以了。估计看完了，就懂得怎么写Lua程序了。<br><br>　　在Lua中，一切都是变量，除了关键字。<br><br>I.&nbsp; 首先是注释<br>　　写一个程序，总是少不了注释的。<br>　　在Lua中，你可以使用单行注释和多行注释。<br>　　单行注释中，连续两个减号"--"表示注释的开始，一直延续到行末为止。相当于C++语言中的"//"。<br>　　多行注释中，由"--[["表示注释开始，并且一直延续到"]]"为止。这种注释相当于C语言中的"/*...*/"。在注释当中，"[["和"]]"是可以嵌套的（<span style=color:red>在lua5.1中，中括号中间是可以加若干个"="号的，如 [==[ ... ]==]</span>），见下面的字符串表示说明。<br><br>II.&nbsp; Lua编程<br>　　经典的"Hello world"的程序总是被用来开始介绍一种语言。在Lua中，写一个这样的程序很简单：<br>　　print("Hello world")<br>　　在Lua中，语句之间可以用分号"；"隔开，也可以用空白隔开。一般来说，如果多个语句写在同一行的话，建议总是用分号隔开。<br>　　Lua 有好几种程序控制语句，如：<br><table style=width:760px;border-collapse:collapse;height:124px cellspacing=0 cellpadding=3 border=1><tbody><tr><td style=color:red>控制语句</td><td style=color:red>格式</td><td style=color:red>示例</td></tr><tr><td style=width:80px>If</td><td style=width:313px;height:44px>if 条件 then ... elseif 条件 then ... else ... end</td><td><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><span style=color:#00f>if</span><span style=color:#000>&nbsp;</span><span style=color:#000>1</span><span style=color:#000>+</span><span style=color:#000>1</span><span style=color:#000>=</span><span style=color:#000>2</span><span style=color:#000>&nbsp;</span><span style=color:#00f>then</span><span style=color:#000>&nbsp;print(</span><span style=color:#000>"</span><span style=color:#000>true</span><span style=color:#000>"</span><span style=color:#000>)<br></span><span style=color:#00f>elseif</span><span style=color:#000>&nbsp;</span><span style=color:#000>1</span><span style=color:#000>+</span><span style=color:#000>2</span><span style=color:#000>~</span><span style=color:#000>=</span><span style=color:#000>3</span><span style=color:#000>&nbsp;</span><span style=color:#00f>then</span><span style=color:#000>&nbsp;print(</span><span style=color:#000>"</span><span style=color:#000>true</span><span style=color:#000>"</span><span style=color:#000>)<br></span><span style=color:#00f>else</span><span style=color:#000>&nbsp;print(</span><span style=color:#000>"</span><span style=color:#000>false</span><span style=color:#000>"</span><span style=color:#000>)&nbsp;</span><span style=color:#00f>end</span></div><br></td></tr><tr><td>While</td><td>while 条件 do ... end</td><td><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><span style=color:#00f>while</span><span style=color:#000>&nbsp;</span><span style=color:#000>1</span><span style=color:#000>+</span><span style=color:#000>1</span><span style=color:#000>~</span><span style=color:#000>=</span><span style=color:#000>2</span><span style=color:#000>&nbsp;</span><span style=color:#00f>do</span><span style=color:#000>&nbsp;print(</span><span style=color:#000>"</span><span style=color:#000>true</span><span style=color:#000>"</span><span style=color:#000>)&nbsp;</span><span style=color:#00f>end</span></div><br></td></tr><tr><td>Repeat</td><td>repeat ... until 条件</td><td><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><span style=color:#000><span style=color:#2000ff>repeat</span>&nbsp;</span><span style=color:#00f>print</span><span style=color:#000>(</span><span style=font-weight:700;color:#000>"</span><span style=font-weight:700;color:#000>Hello</span><span style=font-weight:700;color:#000>"</span><span style=color:#000>)&nbsp;</span><span style=color:#00f>until</span><span style=color:#000>&nbsp;</span><span style=color:maroon>1</span><span style=color:#000>+</span><span style=color:maroon>1</span><span style=color:#000>~=</span><span style=color:maroon>2</span></div><br></td></tr><tr><td>For</td><td>for 变量=初值, 终点值, 步进 do&nbsp;... end</td><td><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><span style=color:#00f>for</span><span style=color:#000>&nbsp;i&nbsp;</span><span style=color:#000>=</span><span style=color:#000>&nbsp;</span><span style=color:#000>1</span><span style=color:#000>,&nbsp;</span><span style=color:#000>10</span><span style=color:#000>,&nbsp;</span><span style=color:#000>2</span><span style=color:#000>&nbsp;</span><span style=color:#00f>do</span><span style=color:#000>&nbsp;print(i)&nbsp;</span><span style=color:#00f>end</span></div><br></td></tr><tr><td>For</td><td>for 变量1, 变量2, ... 变量n in 表或枚举函数 do ... end</td><td><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><span style=color:#00f>for</span><span style=color:#000>&nbsp;a,b&nbsp;</span><span style=color:#00f>in</span><span style=color:#000>&nbsp;mylist&nbsp;</span><span style=color:#00f>do</span><span style=color:#000>&nbsp;</span><span style=color:#00f>print</span><span style=color:#000>(a,&nbsp;b)&nbsp;</span><span style=color:#00f>end</span></div><br></td></tr></tbody></table><br>　　注意一下，for的循环变量总是只作用于for的局部变量；当省略步进值时，for循环会使用1作为步进值。<br>　　使用break可以用来中止一个循环。<br>　　相对C语言来说，Lua有几个地方是明显不同的，所以面要特别注意一下：<br><br>　　．<strong>语句块</strong><br>　　　　语句块在C中是用"{"和"}"括起来的，在Lua中，它是用do 和 end 括起来的。比如：<br>　　　　do print("Hello") end<br>　　　　可以在 <strong>函数</strong> 中和 <strong>语句块</strong> 中定局部变量。<br><br>　　．<strong>赋值语句</strong><br>　　　　赋值语句在Lua被强化了。它可以同时给多个变量赋值。<br>　　　　例如：<br>　　　　a,b,c,d=1,2,3,4<br>　　　　甚至是：<br>　　　　a,b=b,a&nbsp; -- 多么方便的交换变量功能啊。<br>　　　　在默认情况下，变量总是认为是全局的。假如需要定义局部变量，则在第一次赋值的时候，需要用local说明。比如：<br>　　　　local a,b,c = 1,2,3&nbsp; -- a,b,c都是局部变量<br><br>　　．<strong>数值运算</strong><br>　　　　和C语言一样，支持 +, -, *, /。但Lua还多了一个"^"。这表示指数乘方运算。比如2^3 结果为8, 2^4结果为16。<br>　　　　连接两个字符串，可以用".."运处符。如：<br>　　　　"This a " .. "string." -- 等于 "this a string"<br><br>　　．<strong>比较运算<br></strong><table style=width:543px;border-collapse:collapse;height:70px cellspacing=0 cellpadding=3 border=1><tbody><tr><td style=color:red>比较符号</td><td>&lt;</td><td>></td><td>&lt;=</td><td>>=</td><td>==</td><td>~=</td></tr><tr><td style=color:red>含义</td><td>小于</td><td>大于</td><td>小于或等于</td><td>大于或等于</td><td>相等</td><td>不相等</td></tr></tbody></table><br>　　　　所有这些操作符总是返回true或false。<br>　　　　对于Table，Function和Userdata类型的数据，只有 == 和 ~=可以用。相等表示两个变量引用的是同一个数据。比如：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　a</span><span style=color:gray>=</span><span style=color:#000>{</span><span style=font-weight:700;color:maroon>1</span><span style=color:#000>,</span><span style=font-weight:700;color:maroon>2</span><span style=color:#000>}<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　b</span><span style=color:gray>=</span><span style=color:#000>a<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　</span><span style=color:#00f>print</span><span style=color:#000>(a</span><span style=color:gray>==</span><span style=color:#000>b,&nbsp;a</span><span style=color:gray>~=</span><span style=color:#000>b)&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>输出&nbsp;true,&nbsp;false</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　a</span><span style=color:gray>=</span><span style=color:#000>{</span><span style=font-weight:700;color:maroon>1</span><span style=color:#000>,</span><span style=font-weight:700;color:maroon>2</span><span style=color:#000>}<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　b</span><span style=color:gray>=</span><span style=color:#000>{</span><span style=font-weight:700;color:maroon>1</span><span style=color:#000>,</span><span style=font-weight:700;color:maroon>2</span><span style=color:#000>}<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　</span><span style=color:#00f>print</span><span style=color:#000>(a</span><span style=color:gray>==</span><span style=color:#000>b,&nbsp;a</span><span style=color:gray>~=</span><span style=color:#000>b)&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>输出&nbsp;false,&nbsp;true</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span></div><br><br>　　．逻辑运算<br>　　　　and, or, not<br>　　　　其中，and 和 or 与C语言区别特别大。<br>　　　　在这里，请先记住，在Lua中，只有false和nil才计算为false，其它任何数据都计算为true，0也是true！<br>　　　　and 和 or的运算结果不是true和false，而是和它的两个操作数相关。<br>　　　　a and b：如果a为false，则返回a；否则返回b<br>　　　　a or b：如果 a 为true，则返回a；否则返回b<br><br>　　　　举几个例子：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　&nbsp;</span><span style=color:#00f>print</span><span style=color:#000>(</span><span style=font-weight:700;color:maroon>4</span><span style=color:#000>&nbsp;</span><span style=color:gray>and</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>5</span><span style=color:#000>)&nbsp;</span><span style=color:teal>--</span><span style=color:teal>输出&nbsp;5</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　&nbsp;</span><span style=color:#00f>print</span><span style=color:#000>(nil&nbsp;</span><span style=color:gray>and</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>13</span><span style=color:#000>)&nbsp;</span><span style=color:teal>--</span><span style=color:teal>输出&nbsp;nil</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　&nbsp;</span><span style=color:#00f>print</span><span style=color:#000>(false&nbsp;</span><span style=color:gray>and</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>13</span><span style=color:#000>)&nbsp;</span><span style=color:teal>--</span><span style=color:teal>输出&nbsp;false</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　&nbsp;</span><span style=color:#00f>print</span><span style=color:#000>(</span><span style=font-weight:700;color:maroon>4</span><span style=color:#000>&nbsp;</span><span style=color:gray>or</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>5</span><span style=color:#000>)&nbsp;</span><span style=color:teal>--</span><span style=color:teal>输出&nbsp;4</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　&nbsp;</span><span style=color:#00f>print</span><span style=color:#000>(false&nbsp;</span><span style=color:gray>or</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>5</span><span style=color:#000>)&nbsp;</span><span style=color:teal>--</span><span style=color:teal>输出&nbsp;5</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span></div><br>　　　　在Lua中这是很有用的特性，也是比较令人混洧的特性。<br>　　　　我们可以模拟C语言中的语句：x = a? b : c，在Lua中，可以写成：x = a and b or c。<br>　　　　最有用的语句是： x = x or v，它相当于：if not x then x = v end 。<br><br>　　．运算符优先级，从低到高顺序如下：<br><table style=width:320px;border-collapse:collapse cellspacing=0 cellpadding=3 border=1><tbody><tr><td>&nbsp;&nbsp;&nbsp;&nbsp; or<br>&nbsp;&nbsp;&nbsp;&nbsp; and<br>&nbsp;&nbsp;&nbsp;&nbsp; &lt;&nbsp;&nbsp;&nbsp;&nbsp; >&nbsp;&nbsp;&nbsp;&nbsp; &lt;=&nbsp;&nbsp;&nbsp; >=&nbsp;&nbsp;&nbsp; ~=&nbsp;&nbsp;&nbsp; ==<br>&nbsp;&nbsp;&nbsp;&nbsp; .. (字符串连接)<br>&nbsp;&nbsp;&nbsp;&nbsp; +&nbsp;&nbsp;&nbsp;&nbsp; -<br>&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp; %<br>&nbsp;&nbsp;&nbsp;&nbsp; not&nbsp;&nbsp; #(<span style=color:red>lua5.1 取长度运算</span>)&nbsp;&nbsp;&nbsp;&nbsp; - (一元运算)<br>&nbsp;&nbsp;&nbsp;&nbsp; ^</td></tr></tbody></table>和C语言一样，括号可以改变优先级。<br><br>III.&nbsp; 关键字<br>　　关键字是不能做为变量的。Lua的关键字不多，就以下几个：<br>&nbsp;&nbsp;&nbsp;&nbsp;<table style=width:426px;border-collapse:collapse;height:105px cellspacing=0 cellpadding=3 border=1><tbody><tr><td>and</td><td>break</td><td>do</td><td>else</td><td>elseif</td><td></td></tr><tr><td>end</td><td>false</td><td>for</td><td>function</td><td>if</td><td></td></tr><tr><td>in</td><td>local</td><td>nil</td><td>not</td><td>or</td><td></td></tr><tr><td>repeat</td><td>return</td><td>then</td><td>true</td><td>until</td><td>while</td></tr></tbody></table><br>IV.&nbsp; 变量类型<br>　　怎么确定一个变量是什么类型的呢？大家可以用type()函数来检查。Lua支持的类型有以下几种：<br><table style=width:758px;border-collapse:collapse;height:143px cellspacing=0 cellpadding=3 border=1><tbody><tr><td style=width:74px>Nil</td><td>空值，所有没有使用过的变量，都是nil。nil既是值，又是类型。</td></tr><tr><td>Boolean</td><td>布尔值，只有两个有效值：true和false</td></tr><tr><td>Number</td><td>数值，在Lua里，数值相当于C语言的double</td></tr><tr><td>String</td><td>字符串，如果你愿意的话，字符串是可以包含"\0"字符的（这和C语言总是以"\0"结尾是不一样的）</td></tr><tr><td>Table</td><td>关系表类型，这个类型功能比较强大，请参考后面的内容。</td></tr><tr><td>Function</td><td>函数类型，不要怀疑，函数也是一种类型，也就是说，所有的函数，它本身就是一个变量。</td></tr><tr><td>Userdata</td><td>嗯，这个类型专门用来和Lua的宿主打交道的。宿主通常是用C和C++来编写的，在这种情况下，Userdata可以是宿主的任意数据类型，常用的有Struct和指针。</td></tr><tr><td>Thread</td><td><span style=text-decoration:line-through>线程类型，在Lua中没有真正的线程。Lua中可以将一个函数分成几部份运行。</span>如果感兴趣的话，可以去看看Lua的文档。<br>现在回过头来看看，倒觉得不是线程类型。反而象是用来做遍历的，象是Iterator函数。<br>如：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><span style=color:#00f>function</span><span style=color:#000>&nbsp;range(n)<br>&nbsp; <span style=color:#2000ff>local</span> i&nbsp;</span><span style=color:#000>=</span><span style=color:#000>&nbsp;</span><span style=color:#000>0</span><span style=color:#000><br>&nbsp;&nbsp;</span><span style=color:#00f>while</span><span style=color:#000>(i&nbsp;</span><span style=color:#000>&lt;</span><span style=color:#000>&nbsp;n)&nbsp;</span><span style=color:#00f>do</span><span style=color:#000></span><br>&nbsp;&nbsp;&nbsp; coroutine.yield( i )<br><span style=color:#000>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;</span><span style=color:#000>=</span><span style=color:#000>&nbsp;i&nbsp;</span><span style=color:#000>+</span><span style=color:#000>&nbsp;</span><span style=color:#000>1</span><span style=color:#000><br>&nbsp;&nbsp;</span><span style=color:#00f>end</span><span style=color:#000><br></span><span style=color:#00f>end</span></div>可惜的是要继续运行，需要coroutine.resume函数，有点鸡肋。请指教。<br></td></tr></tbody></table><br>V.&nbsp; 变量的定义<br>　　所有的语言，都要用到变量。在Lua中，不管在什么地方使用变量，都不需要声明，并且所有的这些变量总是全局变量，除非我们在前面加上"local"。这一点要特别注意，因为我们可能想在函数里使用局部变量，却忘了用local来说明。<br>　　至于变量名字，它是大小写相关的。也就是说，A和a是两个不同的变量。<br>　　定义一个变量的方法就是赋值。"＝"操作就是用来赋值的<br>　　我们一起来定义几种常用类型的变量吧。<br>　　A.&nbsp; Nil<br>　　　　正如前面所说的，没有使用过的变量的值，都是Nil。有时候我们也需要将一个变量清除，这时候，我们可以直接给变量赋以nil值。如：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　var1</span><span style=color:gray>=</span><span style=color:#000>nil&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;请注意&nbsp;nil&nbsp;一定要小写</span></div><br>　　B.&nbsp; Boolean<br>　　　　布尔值通常是用在进行条件判断的时候。布尔值有两种：true 和 false。在Lua中，只有false和nil才被计算为false，而所有任何其它类型的值，都是true。比如0，空串等等，都是true。不要被 C语言的习惯所误导，0在Lua中的的确确是true。你也可以直接给一个变量赋以Boolean类型的值，如：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　theBoolean&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;true</span></div><br>　　C.&nbsp; Number<br>　　　　在Lua中，是没有整数类型的，也不需要。一般情况下，只要数值不是很大（比如不超过100,000,000,000,000），是不会产生舍入误差的。在WindowsXP能跑的当今主流PC上，实数的运算并不比整数慢。<br>　　　　实数的表示方法，同C语言类似，如：<br>　　　　4 0.4 4.57e-3 0.3e12 5e+20<br><br>　　D.&nbsp; String<br>　　　　字符串，总是一种非常常用的高级类型。在Lua中，我们可以非常方便的定义很长很长的字符串。<br>　　　　字符串在Lua中有几种方法来表示，最通用的方法，是用双引号或单引号来括起一个字符串的，如：<br>　　　　"That's go!"<br>　　　　或<br>　　　　'Hello world!'<br><br>　　　　和C语言相同的，它支持一些转义字符，列表如下：<br>　　　　\a&nbsp; bell<br>　　　　\b&nbsp; back space<br>　　　　\f&nbsp; form feed<br>　　　　\n&nbsp; newline<br>　　　　\r&nbsp; carriage return<br>　　　　\t&nbsp; horizontal tab<br>　　　　\v&nbsp; vertical tab<br>　　　　\\&nbsp; backslash<br>　　　　\"&nbsp; double quote<br>　　　　\"&nbsp; single quote<br>　　　　\[&nbsp; left square bracket<br>　　　　\]&nbsp; right square bracket<br><br>　　　　由于这种字符串只能写在一行中，因此，不可避免的要用到转义字符。加入了转义字符的串，看起来实在是不敢恭维，比如：<br>　　　　"one line\nnext line\n\"in quotes\", "in quotes""<br>　　　　一大堆的"\"符号让人看起来很倒胃口。如果你与我有同感，那么，我们在Lua中，可以用另一种表示方法：用"[["和"]]"将多行的字符串括起来。（<span style=color:red>lua5.1: 中括号中间可以加入若干个"="号，如 [==[ ... ]==]，详见下面示例</span>）<br>　　　　示例：下面的语句所表示的是完全相同的字符串：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>a&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=color:red>'</span><span style=color:red>alo\n123"</span><span style=color:red>'</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>a&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;<span style=color:red>"alo\n123\""</span><br><img src=/Images/OutliningIndicators/None.gif align=top>a&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=color:red>'</span><span style=color:red>\97lo\10\04923"</span><span style=color:red>'</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>a&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=color:red>[</span><span style=color:red>[alo<br><img src=/Images/OutliningIndicators/None.gif align=top>123"</span><span style=color:red>]</span><span style=color:#000>]<br><img src=/Images/OutliningIndicators/None.gif align=top>a&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=color:red>[</span><span style=color:red>==[<br><img src=/Images/OutliningIndicators/None.gif align=top>alo<br><img src=/Images/OutliningIndicators/None.gif align=top>123"</span><span style=color:red>]</span><span style=color:gray>==</span><span style=color:#000>]</span></div><br>　　　　值得注意的是，在这种字符串中，如果含有单独使用的"[["或"]]"就仍然得用"\["或"\]"来避免歧义。当然，这种情况是极少会发生的。<br><br>　　E.&nbsp; Table<br>　　　　关系表类型，这是一个很强大的类型。我们可以把这个类型看作是一个数组。只是C语言的数组，只能用正整数来作索引；在Lua中，你可以用任意类型来作数组的索引，除了nil。同样，在C语言中，数组的内容只允许一种类型；在Lua中，你也可以用任意类型的值来作数组的内容，除了nil。<br>　　　　Table的定义很简单，它的主要特征是用"{"和"}"来括起一系列数据元素的。比如：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　T1&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;{}&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;定义一个空表</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　T1</span><span style=color:red>[</span><span style=color:red>1</span><span style=color:red>]</span><span style=color:gray>=</span><span style=font-weight:700;color:maroon>10</span><span style=color:#000>&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;然后我们就可以象C语言一样来使用它了。</span><span style=color:teal><img src=/Images/OutliningIndicators/None.gif align=top></span></div><br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　T1</span><span style=color:red>[</span><span style=color:red>"John"</span><span style=color:red>]</span><span style=color:gray>=</span><span style=color:#000>{Age</span><span style=color:gray>=</span><span style=font-weight:700;color:maroon>27</span><span style=color:#000>,&nbsp;Gender</span><span style=color:gray>=</span><span style=color:#000>"Male"}<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　这一句相当于：<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　T1</span><span style=color:red>[</span><span style=color:red>"John"</span><span style=color:red>]</span><span style=color:gray>=</span><span style=color:#000>{}&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;必须先定义成一个表，还记得未定义的变量是nil类型吗</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　T1</span><span style=color:red>[</span><span style=color:red>"John"</span><span style=color:red>][</span><span style=color:red>"Age"</span><span style=color:red>]</span><span style=color:gray>=</span><span style=font-weight:700;color:maroon>27</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　T1</span><span style=color:red>[</span><span style=color:red>"John"</span><span style=color:red>][</span><span style=color:red>"Gender"</span><span style=color:red>]</span><span style=color:gray>=</span><span style=color:#000>"Male"<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　当表的索引是字符串的时候，我们可以简写成：<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　T1.John</span><span style=color:gray>=</span><span style=color:#000>{}<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　T1.John.Age</span><span style=color:gray>=</span><span style=font-weight:700;color:maroon>27</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　T1.John.Gender</span><span style=color:gray>=</span><span style=color:#000>"Male"<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　或<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　T1.John{Age</span><span style=color:gray>=</span><span style=font-weight:700;color:maroon>27</span><span style=color:#000>,&nbsp;Gender</span><span style=color:gray>=</span><span style=color:#000>"Male"}</span></div>这是一个很强的特性。<br><br>　　　　在定义表的时候，我们可以把所有的数据内容一起写在"{"和"}"之间，这样子是非常方便，而且很好看。比如，前面的T1的定义，我们可以这么写：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　T1</span><span style=color:gray>=</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　{<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　　　</span><span style=font-weight:700;color:maroon>10</span><span style=color:#000>,&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;相当于&nbsp;[1]&nbsp;=&nbsp;10</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　　　</span><span style=color:red>[</span><span style=color:red>100</span><span style=color:red>]</span><span style=color:#000>&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>40</span><span style=color:#000>,<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　　　John</span><span style=color:gray>=</span><span style=color:#000>&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;如果你原意，你还可以写成：["John"]&nbsp;=</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　　　{<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　　　　　Age</span><span style=color:gray>=</span><span style=font-weight:700;color:maroon>27</span><span style=color:#000>,&nbsp;&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;如果你原意，你还可以写成：["Age"]&nbsp;=27</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　　　　　Gender</span><span style=color:gray>=</span><span style=color:#000>Male&nbsp;&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;如果你原意，你还可以写成：["Gender"]&nbsp;=Male</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　　　},<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　　　</span><span style=font-weight:700;color:maroon>20</span><span style=color:#000>&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;相当于&nbsp;[2]&nbsp;=&nbsp;20</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　}<br><img src=/Images/OutliningIndicators/None.gif align=top></span></div><br>　　　　看起来很漂亮，不是吗？我们在写的时候，需要注意三点：<br>　　　　第一，所有元素之间，总是用逗号"，"隔开；<br>　　　　第二，所有索引值都需要用"["和"]"括起来；如果是字符串，还可以去掉引号和中括号；<br>　　　　第三，如果不写索引，则索引就会被认为是数字，并按顺序自动从1往后编；<br><br>　　　　表类型的构造是如此的方便，以致于常常被人用来代替配置文件。是的，不用怀疑，它比ini文件要漂亮，并且强大的多。<br><br>　　F.&nbsp; Function<br>　　　　函数，在Lua中，函数的定义也很简单。典型的定义如下：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　</span><span style=color:#00f>function</span><span style=color:#000>&nbsp;</span><span style=color:#00f>add</span><span style=color:#000>(a,b)&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;add&nbsp;是函数名字，a和b是参数名字</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　&nbsp;</span><span style=color:#00f>return</span><span style=color:#000>&nbsp;a</span><span style=color:gray>+</span><span style=color:#000>b&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;return&nbsp;用来返回函数的运行结果</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　</span><span style=color:#00f>end</span><span style=color:#000><img src=/Images/OutliningIndicators/None.gif align=top></span></div><br>　　　　请注意，return语言一定要写在end之前。假如我们非要在中间放上一句return，那么就应该要写成：do return end。<br>　　　　还记得前面说过，函数也是变量类型吗？上面的函数定义，其实相当于：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　</span><span style=color:#00f>add</span><span style=color:#000>&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=color:#00f>function</span><span style=color:#000>&nbsp;(a,b)&nbsp;</span><span style=color:#00f>return</span><span style=color:#000>&nbsp;a</span><span style=color:gray>+</span><span style=color:#000>b&nbsp;</span><span style=color:#00f>end</span></div>当重新给add赋值时，它就不再表示这个函数了。我们甚至可以赋给add任意数据，包括nil （这样，赋值为nil，将会把该变量清除）。Function是不是很象C语言的函数指针呢？<br><br>　　　　和C语言一样，Lua的函数可以接受可变参数个数，它同样是用"..."来定义的，比如：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　</span><span style=color:#00f>function</span><span style=color:#000>&nbsp;</span><span style=color:#f0f>sum</span><span style=color:#000>&nbsp;(a,b,<img src=/Images/dot.gif>)</span></div>如果想取得...所代表的参数，可以在函数中访问arg局部变量（表类型）得到 (<span style=color:red>lua5.1: 取消arg，并直接用"..."来代表可变参数了，本质还是arg</span>)。<br>　　　　如 sum(1,2,3,4)<br>　　　　则，在函数中，a = 1, b = 2, arg = {3, 4}&nbsp; (<span style=color:red>lua5.1:&nbsp; a = 1, b = 2, ... = {3, 4}</span>)<br>　　　　更可贵的是，它可以同时返回多个结果，比如：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　</span><span style=color:#00f>function</span><span style=color:#000>&nbsp;s()<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　　　</span><span style=color:#00f>return</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>1</span><span style=color:#000>,</span><span style=font-weight:700;color:maroon>2</span><span style=color:#000>,</span><span style=font-weight:700;color:maroon>3</span><span style=color:#000>,</span><span style=font-weight:700;color:maroon>4</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　</span><span style=color:#00f>end</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　a,b,c,d&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;s()&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;此时，a&nbsp;=&nbsp;1,&nbsp;b&nbsp;=&nbsp;2,&nbsp;c&nbsp;=&nbsp;3,&nbsp;d&nbsp;=&nbsp;4</span><span style=color:teal><img src=/Images/OutliningIndicators/None.gif align=top></span></div><br>　　　　前面说过，表类型可以拥有任意类型的值，包括函数！因此，有一个很强大的特性是，拥有函数的表，哦，我想更恰当的应该说是对象吧。Lua可以使用面向对象编程了。不信？举例如下：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　t&nbsp;</span><span style=color:gray>=</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　{<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　&nbsp;Age&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=font-weight:700;color:maroon>27</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　&nbsp;</span><span style=color:#00f>add</span><span style=color:#000>&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;</span><span style=color:#00f>function</span><span style=color:#000>(self,&nbsp;n)&nbsp;self.Age&nbsp;</span><span style=color:gray>=</span><span style=color:#000>&nbsp;self.Age</span><span style=color:gray>+</span><span style=color:#000>n&nbsp;</span><span style=color:#00f>end</span><span style=color:#000><br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　}<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　</span><span style=color:#00f>print</span><span style=color:#000>(t.Age)&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;27</span><span style=color:teal><br><img src=/Images/OutliningIndicators/None.gif align=top></span><span style=color:#000>　　　　t.</span><span style=color:#00f>add</span><span style=color:#000>(t,&nbsp;</span><span style=font-weight:700;color:maroon>10</span><span style=color:#000>)<br><img src=/Images/OutliningIndicators/None.gif align=top>　　　　</span><span style=color:#00f>print</span><span style=color:#000>(t.Age)&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;37</span></div><br>　　　　不过，t.add(t,10) 这一句实在是有点土对吧？没关系，在Lua中，我们可以简写成：<br><div style="border-right:#ccc 1px solid;padding-right:5px;border-top:#ccc 1px solid;padding-left:4px;font-size:13px;padding-bottom:4px;border-left:#ccc 1px solid;width:98%;padding-top:4px;border-bottom:#ccc 1px solid;background-color:#eee"><img src=/Images/OutliningIndicators/None.gif align=top><span style=color:#000>　　　　t:</span><span style=color:#00f>add</span><span style=color:#000>(</span><span style=font-weight:700;color:maroon>10</span><span style=color:#000>)&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=color:teal>--</span><span style=color:teal>&nbsp;相当于&nbsp;t.add(t,10)</span></div><br>　　G.&nbsp; Userdata 和 Thread<br>　　　　这两个类型的话题，超出了本文的内容，就不打算细说了。<br><br>VI.&nbsp; 结束语<br>　　就这么结束了吗？当然不是，接下来，我们需要用Lua解释器，来帮助理解和实践了。相信这样会更快的对Lua上手了。<br>　　就象C语言一样，Lua提供了相当多的标准函数来增强语言的功能。使用这些标准函数，可以很方便的操作各种数据类型，并处理输入输出。有关这方面的信息，我们可以参考《Programming in Lua 》一书，也可以在网络上直接观看电子版，网址为：<a href=http://www.lua.org/pil/index.html>http://www.lua.org/pil/index.html</a><br>　　<br>备注：本文的部份内容摘、译自lua随机文档。<br>相关链接：<br>1. Lua 官方网站： <a href=http://www.lua.org/>http://www.lua.org/</a><br>2. Lua Wiki网站，你可以在这里找到很多相关的资料，如文档、教程、扩展，以及C/C++的包装等： <a href=http://lua-users.org/wiki/>http://lua-users.org/wiki/</a><br>3. Lua 打包下载（包括各种平台和编译器的工程文件如vs2003,vs2005）：http://luabinaries.luaforge.net/download.html<br><br>这是我编译好的Lua5.02的解释器：<a href=/Files/ly4cn/lua.zip>http://www.cnblogs.com/Files/ly4cn/lua.zip</a><br></div></div><footer class=post-footer><div class=post-button><a class=btn href=/post/lua-script-syntax-explanation-revised/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/lua-third-party-plugins-list/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Lua第三方插件列表"><meta itemprop=description content="下面的这些内容不包含在本文中：官方的Lua包和文档 (参看 http://www.lua.org/),；涉及到Lua使用但不是被Lua使用者普遍使用的东西 (参看 http://www.lua.org/uses.html), ；本wiki已经存在的内容(参看 LuaDirectory). 

类库和与Lua绑定的资源



LibrariesAndBindings 

开发环境


[LuaIDE] (5.0) - Windows平台Lua的整合开发环境(最新发布 2004-01-29). 
[wxLua] (5.0) -&nbsp;Lua and wxWidgets的混合体.有自己的带有调试器的IDE。这个IDE使用wxlua开发的。 
[LuaEclipse] (5.0) - Eclipse 平台的Lua IDE . 
[Vortex LuaIDE] (5.0) -&nbsp;Brazilian Portuguese的一些免费的Lua IDE! (Outra IDE para Lua gratuita, mas em Português!). 
[LuaX] (5.x) - 支持多种操作系统下开发Lua应用的开发平台(with GUI, serial port etc. modules)特别适合于工业自动化和嵌入式产品开发。 
[VisualWx] (5.x) -&nbsp;Lua & wxLua的IDE (自由软件) 
[QDE] (5.x) -&nbsp;Lua的Quotix 开发环境. 他支持工程管理，多文档接口等 (最新发布2005-03-06). 
[B:Lua] -&nbsp;开源项目： 具备各种特征的Lua IDE. 

代码封装

[CPB] (5.0)(Win32) - C++&nbsp;和 Lua连接之桥,实现两种语言的相互通信. 
[CaLua] (5.0) - 实现了绑定C函数和结构体到Lua，可以在Lua中使用C指针、数组、函数。(使用x86结构的计算机) 
[CppLua] (5.0) - lua API的C++封装。 
[lua2c] (5.0) - 将Lua代码转换成C代码的工具. 
[luabind] (5.0) - 基于模板的，绑定Lua和C++类以及函数 
[tolua] (5.0) - 自动绑定C/C++和Lua的工具. 
LuaWrapper 基于模版的封装包，很容易绑定C++代码和Lua。纯头文件。 
[tolua++] (5.0) - tolua的高级版本，带有c++面向对象的特征. ( CompilingToluappWithoutScons i.e., Compiling Tolua++ Without SCons ) 
[luapi] (5.0) - Lua api的C封装. 
[PBLua] (5.0.2) - Lua 5.0.2基本库的封装. 
[PowerBLua] (5.0) - PowerBASIC include & source for wrapping Lua (work in progress). 
[wxScript] (5.0.2) - 一些抽象类，添加到脚本解释器可以使你的wxWidgets支持Lua语言。 
[LunaticPython] (0.1) - Lua/Python&nbsp;的双向桥。可以将Lua解释器嵌入到python中，反过来也可以。 


Lua的使用Lua的使用列表[1]. 


[Premake] -一个用Lua语言实现的 automake 替代品. 可以为MS VC++, GNU make, 等创建工程文件. 
[Lumikki] (5.0) - 使用Lua宏创建web站点，可以使用导航菜单，风格等。

工具


ExpLua (5.0) - 代码文档工具(开发中。。。). 
[Hamster (ex SCons/Lua)] (5.x) - Lua front-end to the SCons build engine (or others). 
[Kepler Project] (5.0) - 使用 [CGILua 5.0]实现的Lua 5.0的web模板引擎&nbsp;. 
[Mod_Lua (5.0)] - &nbsp;Apache 2的 module，使得web应用与PHP类似。 
[ctrace] (5.0) - 跟踪Lua API调用的工具. 
[lper] (5.0) - 创建持久Lua 状态的工具,&nbsp;基于 [GNU mmalloc] (part of GDB). 
PlutoLibrary (5.0.2) - 为Lua创建重量级的持久性. 
[ChunkSpy] (5.0.2) - a binary chunk disassembler, with interactive mode, reading custom binary chunk formats, etc. 
[lua bakefile] (5.0.2) -&nbsp;创建 LUA&nbsp;工程的makefile和工程文件。 
[tolua bakefile] (5.0.2) - 创建 TOLUA&nbsp;工程的makefile和工程文件。 
[ChunkBake] (5.0.2) - a line-oriented assembler for Lua 5 virtual machine instructions 
[LuaSrcDiet] (5.0.2) - 通过删除不必要的空白和注释缩减Lua文件的大小。 
[LuaProfiler] (5.0) - 一个用来查找Lua应用瓶颈的工具time profiler 。



See also LuaEditorSupport. 

文档


[介绍性的指导] (5.0) - Lua 5.0 的介绍教程- 基于 Joe Taylor的评论. ( Try http://lua.riscos.org.uk/ ) 
[Lua&nbsp;5手册&nbsp;(webbook)] (5.0) -&nbsp; webbook格式的Lua 5.0手册。 
Lua简短参考 
Lua教程 
[Lua 5 快速参考] (5.0) - Lua 5.0的小参考手册(PDF)，包含彩色导航栏。&nbsp; 
[Lua 5 虚拟机指令介绍] (5.0) - SXW和PDF格式。 
Lua帮助, 方便在Lua手册中查找信息，类似Unix的man页面。


发布版
See LuaBinaries for links to precompiled vanilla Lua 5.0 executables for various platforms. Real binaries (without addons) should move from here to there. 


[LuaCheia] (5.0) - Lua 5.0 for GNU/Linux, Mac/OS X, Windows, *BSD, Solaris, etc. Includes many add-on binary modules. 
[LuaPlus] (5.0) - C++ enhancements and various extensions to core Lua functionality 
[Linux RPMs] (5.0) - i386 binary, source and spec file for Lua 5.0.2 
[RPMs for Lua] (5.0) - from Rpmfind.Net. 
[RPMs with Lua modules] 
[Lua 5 for EPOC] (5.0) - Lua 5.0.1 for Symbian OS v1-5. 
[LuaCE] (5.0) - additional source files for compiling Lua for Windows CE. 
[LuaPPC] (5.0) - Stand-alone Lua 5.0 interpreter for the Pocket PC. (Built using LuaCE above.) 
[LuaPocket] (5.0) - Stand-alone Lua 5.0 interpreter for the Pocket PC with graphic support. (Built using LuaPPC above.) 
[Lua for RISC OS] (5.0) 
[Lua for Palm OS] (5.0) Port of Lua for Palm (in alpha). 
[Lua89] (5.0) Experimental port of Lua to the TI89 graphing calculator. 

其他的一些Lua实现方式


[Sol] - Lua 的派生物. 
[Lua.NET] .net相关的Lua 
[LuaLeo] -&nbsp; 根据[Leonardo VM] 实现的Lua 3.1 
[Lua-ML] -&nbsp; 由面向对象的Caml实现的 Lua 2.5 
[Yindo] - Lua 的实现，作为OpenGL 浏览器插件(很快过时了) 
[Yueliang] (5.0.2) - 使用Lua实现Lua，包括词法解析、语法解析、代码生成和生成二进制chunks."></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/lua-third-party-plugins-list/ itemprop=url class=post-title-link>Lua第三方插件列表</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月21日 12:21:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-21 12:21:00 +0800 +0800">2007年09月21日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/lua/ itemprop=url rel=index><span itemprop=name>dev/Lua</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/lua-third-party-plugins-list/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>下面的这些内容不包含在本文中：<br>官方的Lua包和文档 (参看 <a href=http://www.lua.org/><u><font color=#800080><a href=http://www.lua.org/),；涉及到Lua使用但不是被Lua使用者普遍使用的东西%20(参看>http://www.lua.org/</font></u></a>),<font color=#000000>；<br></font>涉及到Lua使用但不是被Lua使用者普遍使用的东西<font color=#000000> (参看 </font></a><a href=http://www.lua.org/uses.html><u><font color=#0000ff>http://www.lua.org/uses.html</font></u></a><a href=http://www.lua.org/),；涉及到Lua使用但不是被Lua使用者普遍使用的东西；things><font color=#000000>), </font>；<br></a>本wiki已经存在的内容(参看 <a href=http://lua-users.org/wiki/LuaDirectory><u><font color=#0000ff>LuaDirectory</font></u></a>).<p><h2><a href=http://lua-users.org/wiki/LibrariesAndBindings><u><font color=#0000ff>类库和与Lua绑定的资源</font></u></a></h2><p><u><font color=#0000ff></font></u><dl><dt><u><font color=#0000ff></font></u><dd><a href=http://lua-users.org/wiki/LibrariesAndBindings><u><font color=#0000ff>LibrariesAndBindings</font></u></a></dd></dl><p><h2>开发环境</h2><p><ul><li><a href=http://www.gorlice.net.pl/~rybak/luaide><u><font color=#0000ff>[LuaIDE]</font></u></a> (5.0) - Windows平台Lua的整合开发环境(最新发布 2004-01-29).<li><a href=http://www.luascript.thersgb.net/><u><font color=#0000ff>[wxLua]</font></u></a> (5.0) -&nbsp;Lua and wxWidgets的混合体.有自己的带有调试器的IDE。这个IDE使用wxlua开发的。<li><a href=http://www.ideais.com.br/luaeclipse/><u><font color=#0000ff>[LuaEclipse]</font></u></a> (5.0) - Eclipse 平台的Lua IDE .<li><a href="http://www.vortexentertainment.com/produto.php?id=luaide"><u><font color=#0000ff>[Vortex LuaIDE]</font></u></a> (5.0) -&nbsp;Brazilian Portuguese的一些免费的Lua IDE! (Outra IDE para Lua gratuita, mas em Português!).<li><a href=http://luaforge.net/projects/luax/><u><font color=#0000ff>[LuaX]</font></u></a> (5.x) - 支持多种操作系统下开发Lua应用的开发平台(with GUI, serial port etc. modules)特别适合于工业自动化和嵌入式产品开发。<li><a href=http://visualwx.altervista.org/><u><font color=#0000ff>[VisualWx]</font></u></a> (5.x) -&nbsp;Lua & wxLua的IDE (自由软件)<li><a href=http://www.quotixsoftware.com/qde_index.htm><u><font color=#0000ff>[QDE]</font></u></a> (5.x) -&nbsp;Lua的Quotix 开发环境. 他支持工程管理，多文档接口等 (最新发布2005-03-06).<li><a href=http://blua.sourceforge.net/><u><font color=#0000ff>[B:Lua]</font></u></a> -&nbsp;开源项目： 具备各种特征的Lua IDE.</li></ul><p><h2>代码封装</h2><ul><li><a href=http://www.thomasandamy.com/projects/CPB/><u><font color=#0000ff>[CPB]</font></u></a> (5.0)(Win32) - C++&nbsp;和 Lua连接之桥,实现两种语言的相互通信.<li><a href=http://sourceforge.net/projects/calua><u><font color=#0000ff>[CaLua]</font></u></a> (5.0) - 实现了绑定C函数和结构体到Lua，可以在Lua中使用C指针、数组、函数。(使用x86结构的计算机)<li><a href=http://sourceforge.net/projects/cpplua><u><font color=#0000ff>[CppLua]</font></u></a> (5.0) - lua API的C++封装。<li><a href=ftp://ftp.tecgraf.puc-rio.br/pub/lhf/lua2c.tar.gz><u><font color=#0000ff>[lua2c]</font></u></a> (5.0) - 将Lua代码转换成C代码的工具.<li><a href=http://luabind.sf.net/><u><font color=#0000ff>[luabind]</font></u></a> (5.0) - 基于模板的，绑定Lua和C++类以及函数<li><a href=http://www.tecgraf.puc-rio.br/~celes/tolua/><u><font color=#0000ff>[tolua]</font></u></a> (5.0) - 自动绑定C/C++和Lua的工具.<li><a href=http://lua-users.org/wiki/LuaWrapper><u><font color=#0000ff>LuaWrapper</font></u></a> 基于模版的封装包，很容易绑定C++代码和Lua。纯头文件。<li><a href=http://www.codenix.com/~tolua><u><font color=#0000ff>[tolua++]</font></u></a> (5.0) - tolua的高级版本，带有c++面向对象的特征. ( <a href=http://lua-users.org/wiki/CompilingToluappWithoutScons><u><font color=#0000ff>CompilingToluappWithoutScons</font></u></a> i.e., Compiling Tolua++ Without SCons )<li><a href=http://lua-users.org/files/wiki_insecure/users/luapi/><u><font color=#0000ff>[luapi]</font></u></a> (5.0) - Lua api的C封装.<li><a href=http://rzserv2.fhnon.de/~lg016586/PBLua/><u><font color=#0000ff>[PBLua]</font></u></a> (5.0.2) - Lua 5.0.2基本库的封装.<li><a href=http://mark0.net/code-powerblua-e.html><u><font color=#0000ff>[PowerBLua]</font></u></a> (5.0) - PowerBASIC include & source for wrapping Lua (work in progress).<li><a href=http://wxcode.sourceforge.net/components/wxscript/index.html><u><font color=#0000ff>[wxScript]</font></u></a> (5.0.2) - 一些抽象类，添加到脚本解释器可以使你的wxWidgets支持Lua语言。<li><a href=http://moin.conectiva.com.br/LunaticPython><u><font color=#0000ff>[LunaticPython]</font></u></a> (0.1) - Lua/Python&nbsp;的双向桥。可以将Lua解释器嵌入到python中，反过来也可以。</li></ul><p><p><h2>Lua的使用</h2><em>Lua的使用列表<a href=http://www.lua.org/uses.html><u><font color=#0000ff>[1]</font></u></a>.</em><p><ul><li><a href=http://premake.sourceforge.net/><u><font color=#0000ff>[Premake]</font></u></a> -一个用Lua语言实现的 automake 替代品. 可以为MS VC++, GNU make, 等创建工程文件.<li><a href=http://luaforge.net/projects/lumikki><u><font color=#0000ff>[Lumikki]</font></u></a> (5.0) - 使用Lua宏创建web站点，可以使用导航菜单，风格等。</li></ul><p><h2>工具</h2><p><ul><li><a href=http://lua-users.org/wiki/ExpLua><u><font color=#0000ff>ExpLua</font></u></a> (5.0) - 代码文档工具(开发中。。。).<li><a href=http://luaforge.net/projects/hamster/><u><font color=#0000ff>[Hamster (ex SCons/Lua)]</font></u></a> (5.x) - Lua front-end to the SCons build engine (or others).<li><a href=http://www.keplerproject.org/><u><font color=#0000ff>[Kepler Project]</font></u></a> (5.0) - 使用 <a href=http://www.keplerproject.org/cgilua/><u><font color=#0000ff>[CGILua 5.0]</font></u></a>实现的Lua 5.0的web模板引擎&nbsp;.<li><a href=http://www.xtgsystems.com/linux/lua/mod_lua.php><u><font color=#0000ff>[Mod_Lua (5.0)]</font></u></a> - &nbsp;Apache 2的 module，使得web应用与PHP类似。<li><a href=http://www.tecgraf.puc-rio.br/~lhf/ftp/lua/><u><font color=#0000ff>[ctrace]</font></u></a> (5.0) - 跟踪Lua API调用的工具.<li><a href=http://www.tecgraf.puc-rio.br/~lhf/ftp/lua/><u><font color=#0000ff>[lper]</font></u></a> (5.0) - 创建持久Lua 状态的工具,&nbsp;基于 <a href=http://sources.redhat.com/gdb/5/onlinedocs/mmalloc.html><u><font color=#0000ff>[GNU mmalloc]</font></u></a> (part of GDB).<li><a href=http://lua-users.org/wiki/PlutoLibrary><u><font color=#0000ff>PlutoLibrary</font></u></a> (5.0.2) - 为Lua创建重量级的持久性.<li><a href=http://luaforge.net/projects/chunkspy/><u><font color=#0000ff>[ChunkSpy]</font></u></a> (5.0.2) - a binary chunk disassembler, with interactive mode, reading custom binary chunk formats, etc.<li><a href=http://www.geocities.com/f18m_cpp217828/prog/lua_win32.zip><u><font color=#0000ff>[lua bakefile]</font></u></a> (5.0.2) -&nbsp;创建 LUA&nbsp;工程的makefile和工程文件。<li><a href=http://www.geocities.com/f18m_cpp217828/prog/tolua_win32.zip><u><font color=#0000ff>[tolua bakefile]</font></u></a> (5.0.2) - 创建 TOLUA&nbsp;工程的makefile和工程文件。<li><a href=http://luaforge.net/projects/chunkbake/><u><font color=#0000ff>[ChunkBake]</font></u></a> (5.0.2) - a line-oriented assembler for Lua 5 virtual machine instructions<li><a href=http://luaforge.net/projects/luasrcdiet/><u><font color=#0000ff>[LuaSrcDiet]</font></u></a> (5.0.2) - 通过删除不必要的空白和注释缩减Lua文件的大小。<li><a href=http://www.keplerproject.org/luaprofiler><u><font color=#0000ff>[LuaProfiler]</font></u></a> (5.0) - 一个用来查找Lua应用瓶颈的工具time profiler 。</li></ul><p><dl><dt><dd>See also <a href=http://lua-users.org/wiki/LuaEditorSupport><u><font color=#0000ff>LuaEditorSupport</font></u></a>.</dd></dl><p><h2>文档</h2><p><ul><li><a href=http://lua.riscos.org.uk/Guide/><u><font color=#0000ff>[介绍性的指导]</font></u></a> (5.0) - Lua 5.0 的介绍教程- 基于 Joe Taylor的评论. ( Try <a href=http://lua.riscos.org.uk/><u><font color=#0000ff>http://lua.riscos.org.uk/</font></u></a> )<li><a href=http://lua-users.org/files/wiki_insecure/users/lcandido/lua5.0man_webbook.zip><u><font color=#0000ff>[Lua&nbsp;5手册&nbsp;(webbook)]</font></u></a> (5.0) -&nbsp; webbook格式的Lua 5.0手册。<li><a href=http://lua-users.org/wiki/LuaShortReference><u><font color=#0000ff>Lua简短参考</font></u></a><li><u><font color=#800080>Lua教程</font></u><li><a href="http://luaforge.net/docman/?group_id=80"><u><font color=#0000ff>[Lua 5 快速参考]</font></u></a> (5.0) - Lua 5.0的小参考手册(PDF)，包含彩色导航栏。&nbsp;<li><a href="http://luaforge.net/docman/?group_id=83"><u><font color=#0000ff>[Lua 5 虚拟机指令介绍]</font></u></a> (5.0) - SXW和PDF格式。<li><a href=http://lua-users.org/wiki/LuaHelp><u><font color=#0000ff>Lua帮助</font></u></a>, 方便在Lua手册中查找信息，类似Unix的man页面。</li></ul><p><p><h2>发布版</h2><p>See <a href=http://lua-users.org/wiki/LuaBinaries><u><font color=#0000ff>LuaBinaries</font></u></a> for links to precompiled vanilla Lua 5.0 executables for various platforms. Real binaries (without addons) should move from here to there.<p><ul><li><a href=http://luacheia.lua-users.org/><u><font color=#0000ff>[LuaCheia]</font></u></a> (5.0) - Lua 5.0 for GNU/Linux, Mac/OS X, Windows, *BSD, Solaris, etc. Includes many add-on binary modules.<li><a href=http://luaplus.org/tiki-index.php><u><font color=#0000ff>[LuaPlus]</font></u></a> (5.0) - C++ enhancements and various extensions to core Lua functionality<li><a href=http://gwpr03.microlink.com.br/~acosta/lua/><u><font color=#0000ff>[Linux RPMs]</font></u></a> (5.0) - i386 binary, source and spec file for Lua 5.0.2<li><a href="http://rpmfind.net/linux/rpm2html/search.php?query=lua"><u><font color=#0000ff>[RPMs for Lua]</font></u></a> (5.0) - from Rpmfind.Net.<li><a href=http://lsp2html.sourceforge.net/luarpms/><u><font color=#0000ff>[RPMs with Lua modules]</font></u></a><li><a href="http://www.freepoc.org/viewapp.php?id=32"><u><font color=#0000ff>[Lua 5 for EPOC]</font></u></a> (5.0) - Lua 5.0.1 for Symbian OS v1-5.<li><a href=http://www.inf.puc-rio.br/~miller/luace><u><font color=#0000ff>[LuaCE]</font></u></a> (5.0) - additional source files for compiling Lua for Windows CE.<li><a href=http://www.uoam.net/lua.html><u><font color=#0000ff>[LuaPPC]</font></u></a> (5.0) - Stand-alone Lua 5.0 interpreter for the Pocket PC. (Built using LuaCE above.)<li><a href=http://luaforge.net/projects/luapocket/><u><font color=#0000ff>[LuaPocket]</font></u></a> (5.0) - Stand-alone Lua 5.0 interpreter for the Pocket PC with graphic support. (Built using LuaPPC above.)<li><a href=http://lua.riscos.org.uk/><u><font color=#0000ff>[Lua for RISC OS]</font></u></a> (5.0)<li><a href=http://sourceforge.net/projects/luapalmos/><u><font color=#0000ff>[Lua for Palm OS]</font></u></a> (5.0) Port of Lua for Palm (in alpha).<li><a href=http://lekernel.lya-fr.com/lua.html><u><font color=#0000ff>[Lua89]</font></u></a> (5.0) Experimental port of Lua to the TI89 graphing calculator.</li></ul><p><h2>其他的一些Lua实现方式</h2><p><ul><li><a href=http://www.goron.de/~froese/sol/><u><font color=#0000ff>[Sol]</font></u></a> - Lua 的派生物.<li><a href=http://www.tecgraf.puc-rio.br/~rcerq/luadotnet/><u><font color=#0000ff>[Lua.NET]</font></u></a> .net相关的Lua<li><a href=http://www.dis.uniroma1.it/pub/demetres/LeonardoPrograms/lua.sit.bin><u><font color=#0000ff>[LuaLeo]</font></u></a> -&nbsp; 根据<a href=http://www.dis.uniroma1.it/~demetres/Leonardo/><u><font color=#0000ff>[Leonardo VM]</font></u></a> 实现的Lua 3.1<li><a href=http://www.cminusminus.org/code.html#luaml><u><font color=#0000ff>[Lua-ML]</font></u></a> -&nbsp; 由面向对象的Caml实现的 Lua 2.5<li><a href="http://www.yindo.com/?from=steve"><u><font color=#0000ff>[Yindo]</font></u></a> - Lua 的实现，作为OpenGL 浏览器插件(很快过时了)<li><a href=http://luaforge.net/projects/yueliang/><u><font color=#0000ff>[Yueliang]</font></u></a> (5.0.2) - 使用Lua实现Lua，包括词法解析、语法解析、代码生成和生成二进制chunks.</li></ul></div><footer class=post-footer><div class=post-button><a class=btn href=/post/lua-third-party-plugins-list/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/lua-useful-resources-links/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Lua常用资源连接"><meta itemprop=description content="
官方资源&nbsp; 

[Lua 官方主页]
Lua社区&nbsp; 

[Lua 邮件列表] 
[Lua IRC 聊天频道] (#来自irc.freenode.net) 
[Jean-Claude Wippler的wiki]. (不再维护)
Lua&nbsp;文档 

[Lua架构] - 描述了Lua的业务驱动方式，目的以及架构解决方案。
带有例证的Lua文档 

[与Will Harvey的谈话记录]
Lua&nbsp;教程 

[来自GameDev.net的：An Introduction to Lua] 
[扩展性的Lua] 
[嵌入式的 Lua] 
[Win32平台下使用Pelles C编译Lua] 
[在BlitzMax中使用 Lua]
认证考试&nbsp; 

[Lua高级认证] 提供Lua认证考试和相关练习. 
Benchmarks 

[Experiments with Scripting and User-Interface Language] is a paper by Kernighan and Van Wyk that benchmarks several scripting languages. An [implementation] of these benchmarks in Lua is available. 
Doug Bagley's的书： [Great Computer Language Shootout] 的更新版本.还有一个不太新的[Windows版本] . 
语言比较&nbsp; 

[Hello World!] 
[Hello You]: [Lua entry]. 
[99 Bottles of Beer]: [Lua entry]. 
[ROT13]: [Lua entry] 
[The Quine Page] 
[OO 例子] 
[APLC: Andreas' 实践语言对比]. 
[Scriptometer] 
[Syntax accross languages] (Big page!) 
[Michael Neumann's关于语言的比较] 
[与C++一起使用Lua:简短的教程] 
[PLEAC - 类似食谱一样的编程语言例子]
Lua 其他相关站点 

[Lua使用指南],&nbsp;来自 [Google Groups]. 
[Dr. Dobb's 的脚本语言列表]. 
[免费的编译器和解释器分类]: [Lua entry]. 
[编程语言字典]: [Lua entry]. 
[SAL, Linux上的科学上的应用]: [Lua entry] (site no longer exists?). 
[Freshmeat]: [Lua entry]. 
[FreeBSD]: [Lua entry]. 
[NetBSD]: [Lua entry]. 
[Mathtools.net]: [Lua entry] (404 error). 
[Wikipedia]: [Lua entry]. 
[Conectiva]: [Lua entry] (404 error). 
[Hypernews Computer Language List]. 
[语言列表- Version 2.4] (开始于1995年! 现在404错误,&nbsp;到 [主页] 察看原因). 
[现存语言的评论]: [Lua entry]. 
[开源的工程目录]: [Lua entry]. 
[GNU 自由软件目录]: [Lua entry]. 
[流行的脚本语言]"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/lua-useful-resources-links/ itemprop=url class=post-title-link>Lua常用资源连接</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月21日 12:16:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-21 12:16:00 +0800 +0800">2007年09月21日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/lua/ itemprop=url rel=index><span itemprop=name>dev/Lua</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/lua-useful-resources-links/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><ul><li>官方资源&nbsp;<ul><li><a href=http://www.lua.org/><u><font color=#800080>[Lua 官方主页]</font></u></a></li></ul><li>Lua社区&nbsp;<ul><li><a href=http://lua-users.org/lists/lua-l/><u><font color=#0000ff>[Lua 邮件列表]</font></u></a><li><a href=irc://irc.freenode.net/lua><u><font color=#800080>[Lua IRC 聊天频道]</font></u></a> (#来自irc.freenode.net)<li><a href=http://mini.net/cgi-bin/lua/><u><font color=#0000ff>[Jean-Claude Wippler的wiki]</font></u></a>. <em>(不再维护)</em></li></ul><li>Lua&nbsp;文档<ul><li><em><a href=http://www.tecgraf.org/~mark/luaarchitecture.doc><u><font color=#0000ff>[Lua架构]</font></u></a></em> - 描述了Lua的业务驱动方式，目的以及架构解决方案。</li></ul><li>带有例证的Lua文档<ul><li><em><a href="http://www.acmqueue.org/modules.php?name=Content&amp;pa=showpage&amp;pid=112"><u><font color=#0000ff>[与Will Harvey的谈话记录]</font></u></a></em></li></ul><li>Lua&nbsp;教程<ul><li><a href=http://www.gamedev.net/reference/articles/article1932.asp><u><font color=#0000ff>[来自GameDev.net的：An Introduction to Lua]</font></u></a><li><a href=http://davespalace.co.uk/tutorials/lua_extend.html><u><font color=#0000ff>[扩展性的Lua]</font></u></a><li><a href=http://davespalace.co.uk/tutorials/lua_embed.html><u><font color=#0000ff>[嵌入式的 Lua]</font></u></a><li><a href="http://smorgasbordet.com/phpBB2/viewtopic.php?p=778#778"><u><font color=#0000ff>[Win32平台下使用Pelles C编译Lua]</font></u></a><li><a href=http://www.blitzwiki.org/index.php/Introduction_to_Lua><u><font color=#0000ff>[在BlitzMax中使用 Lua]</font></u></a></li></ul><li>认证考试&nbsp;<ul><li><a href=http://www.high-levelcert.com/><u><font color=#0000ff>[Lua高级认证]</font></u></a> 提供Lua认证考试和相关练习.</li></ul><li>Benchmarks<ul><li><a href=http://cm.bell-labs.com/cm/cs/who/bwk/interps/pap.html><u><font color=#0000ff>[Experiments with Scripting and User-Interface Language]</font></u></a> is a paper by Kernighan and Van Wyk that benchmarks several scripting languages. An <a href=http://www.inf.puc-rio.br/~roberto/bwk-lua.tar.gz><u><font color=#0000ff>[implementation]</font></u></a> of these benchmarks in Lua is available.<li>Doug Bagley's的书： <a href=http://shootout.alioth.debian.org/><u><font color=#0000ff>[Great Computer Language Shootout]</font></u></a> 的更新版本.还有一个不太新的<a href=http://dada.perl.it/shootout/><u><font color=#0000ff>[Windows版本]</font></u></a> .</li></ul><li>语言比较&nbsp;<ul><li><a href=http://www.latech.edu/~acm/HelloWorld.shtml><u><font color=#0000ff>[Hello World!]</font></u></a><li><a href=http://kevin.alteu.com/code/helloyou/index.html><u><font color=#0000ff>[Hello You]</font></u></a>: <a href=http://kevin.alteu.com/code/helloyou/lua.html><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.99-bottles-of-beer.net/><u><font color=#0000ff>[99 Bottles of Beer]</font></u></a>: <a href=http://www.99-bottles-of-beer.net/language-lua-365.html><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.miranda.org/~jkominek/rot13/><u><font color=#0000ff>[ROT13]</font></u></a>: <a href=http://www.miranda.org/~jkominek/rot13/lua/><u><font color=#0000ff>[Lua entry]</font></u></a><li><a href=http://www.nyx.net/~gthompso/quine.htm><u><font color=#0000ff>[The Quine Page]</font></u></a><li><a href=http://www.angelfire.com/tx4/cus/shapes/index.html><u><font color=#0000ff>[OO 例子]</font></u></a><li><a href=http://www.kochandreas.com/home/language/lang.htm><u><font color=#0000ff>[APLC: Andreas' 实践语言对比]</font></u></a>.<li><a href=http://***.sourceforge.net/pixel/language-study/scripting-language/><u><font color=#0000ff>[Scriptometer]</font></u></a><li><a href=http://***.sourceforge.net/pixel/language-study/syntax-across-languages.html><u><font color=#0000ff>[Syntax accross languages]</font></u></a> (Big page!)<li><a href=http://www.ntecs.de/old-hp/uu9r/lang/html/lang.en.html><u><font color=#0000ff>[Michael Neumann's关于语言的比较]</font></u></a><li><a href=http://csl.sublevel3.org/lua/><u><font color=#0000ff>[与C++一起使用Lua:简短的教程]</font></u></a><li><a href=http://pleac.sourceforge.net/><u><font color=#0000ff>[PLEAC - 类似食谱一样的编程语言例子]</font></u></a></li></ul><li>Lua 其他相关站点<ul><li><a href="http://groups.google.com/groups?as_q=Lua&amp;num=20&amp;as_scoring=date&amp;btnG=Google+Search&amp;as_ugroup=comp.*+*game*&amp;as_drrb=quick"><u><font color=#0000ff>[Lua使用指南]</font></u></a>,&nbsp;来自 <a href=http://groups.google.com/><u><font color=#0000ff>[Google Groups]</font></u></a>.<li><a href="http://www.ddj.com/topics/altlang/sites.htm?topic=altlang"><u><font color=#0000ff>[Dr. Dobb's 的脚本语言列表]</font></u></a>.<li><a href=http://www.idiom.com/free-compilers/><u><font color=#0000ff>[免费的编译器和解释器分类]</font></u></a>: <a href=http://www.idiom.com/free-compilers/TOOL/lua-1.html><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.erols.com/ziring/dopl.html><u><font color=#0000ff>[编程语言字典]</font></u></a>: <a href="http://cgibin.erols.com/ziring/cgi-bin/cep/cep.pl?_key=Lua"><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://sal.kachinatech.com/><u><font color=#0000ff>[SAL, Linux上的科学上的应用]</font></u></a>: <a href=http://sal.kachinatech.com/F/1/LUA.html><u><font color=#0000ff>[Lua entry]</font></u></a> (site no longer exists?).<li><a href=http://freshmeat.net/><u><font color=#0000ff>[Freshmeat]</font></u></a>: <a href=http://freshmeat.net/projects/lua/><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.freebsd.org/><u><font color=#0000ff>[FreeBSD]</font></u></a>: <a href=http://www.freebsd.org/ports/lang.html><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.netbsd.org/><u><font color=#0000ff>[NetBSD]</font></u></a>: <a href=ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/lang/lua/README.html><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.mathtools.net/><u><font color=#0000ff>[Mathtools.net]</font></u></a>: <a href=http://www.mathtools.net/C++/Interpreters/Other/><u><font color=#0000ff>[Lua entry]</font></u></a> (404 error).<li><a href=http://www.wikipedia.com/><u><font color=#0000ff>[Wikipedia]</font></u></a>: <a href=http://wikipedia.org/wiki/Lua_programming_language><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.conectiva.com/><u><font color=#0000ff>[Conectiva]</font></u></a>: <a href=http://snapshot.conectiva.com/SRPMS/Interpreters/lua.html><u><font color=#0000ff>[Lua entry]</font></u></a> (404 error).<li><a href=http://www.hypernews.org/HyperNews/get/computing/lang-list.html><u><font color=#0000ff>[Hypernews Computer Language List]</font></u></a>.<li><a href=http://wuarchive.wustl.edu/doc/misc/lang-list.txt><u><font color=#0000ff>[语言列表- Version 2.4]</font></u></a> (开始于1995年! 现在404错误,&nbsp;到 <a href=http://wuarchive.wustl.edu/><u><font color=#0000ff>[主页]</font></u></a> 察看原因).<li><a href=http://cliki.tunes.org/Programming%20Languages><u><font color=#0000ff>[现存语言的评论]</font></u></a>: <a href=http://cliki.tunes.org/LUA><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://dmoz.org/><u><font color=#0000ff>[开源的工程目录]</font></u></a>: <a href=http://dmoz.org/Computers/Programming/Languages/Lua/><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.gnu.org/directory/><u><font color=#0000ff>[GNU 自由软件目录]</font></u></a>: <a href=http://www.gnu.org/directory/lua.html><u><font color=#0000ff>[Lua entry]</font></u></a>.<li><a href=http://www.scriptol.org/choose.php><u><font color=#0000ff>[流行的脚本语言]</font></u></a></li></ul></li></ul></div><footer class=post-footer><div class=post-button><a class=btn href=/post/lua-useful-resources-links/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/windows-nt-2000-xp-ring0-implementation-without-driver/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Windows NT/2000/XP下不用驱动的Ring0代码实现"><meta itemprop=description content='大家知道，Windows NT/2000为实现其可靠性，严格将系统划分为内核模式与用户模式，在i386系统中分别对应CPU的Ring0与Ring3级别。Ring0下，可以执行特权级指令，对任何I/O设备都有访问权等等。要实现从用户态进入核心态，即从Ring 3进入Ring 0必须借助CPU的某种门机制，如中断门、调用门等。而Windows NT/2000提供用户态执行系统服务(Ring 0例程)的此类机制即System Service的int 2eh中断服务等，严格的参数检查，只能严格的执行Windows NT/2000提供的服务，而如果想执行用户提供的Ring 0代码(指运行在Ring 0权限的代码)，常规方法似乎只有编写设备驱动程序。本文将介绍一种在用户态不借助任何驱动程序执行Ring0代码的方法。    Windows NT/2000将设备驱动程序调入内核区域(常见的位于地址0x80000000上)，由DPL为0的GDT项8，即cs为8时实现Ring 0权限。本文通过在系统中构造一个指向我们的代码的调用门(CallGate)，实现Ring0代码。基于这个思路，为实现这个目的主要是构造自己的CallGate。CallGate由系统中叫Global Descriptor Table(GDT)的全局表指定。GDT地址可由i386指令sgdt获得(sgdt不是特权级指令，普通Ring 3程序均可执行)。GDT地址在Windows NT/2000保存于KPCR(Processor Control Region)结构中(见《再谈Windows NT/2000环境切换》)。GDT中的CallGate是如下的格式：    typedef struct    {        unsigned short  offset_0_15;        unsigned short  selector;        unsigned char    param_count : 4;        unsigned char    some_bits   : 4;        unsigned char    type        : 4;        unsigned char    app_system  : 1;        unsigned char    dpl         : 2;        unsigned char    present     : 1;            unsigned short  offset_16_31;    } CALLGATE_DESCRIPTOR;    GDT位于内核区域，一般用户态的程序是不可能对这段内存区域有直接的访问权。幸运的是Windows NT/2000提供了一个叫PhysicalMemory的Section内核对象位于\Device的路径下。顾名思义，通过这个Section对象可以对物理内存进行操作。用objdir.exe对这个对象分析如下：    C:\NTDDK\bin>objdir /D \Device    PhysicalMemory                           Section        DACL -            Ace[ 0] - Grant - 0xf001f - NT AUTHORITY\SYSTEM                             Inherit:                              Access: 0x001F  and  ( D RCtl WOwn WDacl )           Ace[ 1] - Grant - 0x2000d - BUILTIN\Administrators                             Inherit:                              Access: 0x000D  and  ( RCtl )    从dump出的这个对象DACL的Ace可以看出默认情况下只有SYSTEM用户才有对这个对象的读写权限，即对物理内存有读写能力，而Administrator只有读权限，普通用户根本就没有权限。不过如果我们有Administrator权限就可以通过GetSecurityInfo、SetEntriesInAcl与SetSecurityInfo这些API来修改这个对象的ACE。这也是我提供的代码需要Administrator的原因。实现的代码如下：    VOID SetPhyscialMemorySectionCanBeWrited(HANDLE hSection)    {       PACL pDacl=NULL;       PACL pNewDacl=NULL;       PSECURITY_DESCRIPTOR pSD=NULL;       DWORD dwRes;       EXPLICIT_ACCESS ea;       if(dwRes=GetSecurityInfo(hSection,SE_KERNEL_OBJECT,DACL_SECURITY_INFORMATION,                  NULL,NULL,&amp;pDacl,NULL,&amp;pSD)!=ERROR_SUCCESS)          {             printf( &ldquo;GetSecurityInfo Error %u\n&rdquo;, dwRes );             goto CleanUp;          }       ZeroMemory(&amp;ea, sizeof(EXPLICIT_ACCESS));       ea.grfAccessPermissions = SECTION_MAP_WRITE;       ea.grfAccessMode = GRANT_ACCESS;       ea.grfInheritance= NO_INHERITANCE;       ea.Trustee.TrusteeForm = TRUSTEE_IS_NAME;       ea.Trustee.TrusteeType = TRUSTEE_IS_USER;       ea.Trustee.ptstrName = &ldquo;CURRENT_USER&rdquo;;       if(dwRes=SetEntriesInAcl(1,&amp;ea,pDacl,&amp;pNewDacl)!=ERROR_SUCCESS)          {             printf( &ldquo;SetEntriesInAcl %u\n&rdquo;, dwRes );             goto CleanUp;          }       if(dwRes=SetSecurityInfo(hSection,SE_KERNEL_OBJECT,DACL_SECURITY_INFORMATION,NULL,NULL,pNewDacl,NULL)!=ERROR_SUCCESS)          {             printf(&ldquo;SetSecurityInfo %u\n&rdquo;,dwRes);             goto CleanUp;          }    CleanUp:       if(pSD)          LocalFree(pSD);       if(pNewDacl)          LocalFree(pSD);    }    这段代码对给定HANDLE的对象增加了如下的ACE:     PhysicalMemory                           Section        DACL -            Ace[ 0] - Grant - 0x2 - WEBCRAZY\Administrator                             Inherit:                              Access: 0x0002    //SECTION_MAP_WRITE    这样我们在有Administrator权限的条件下就有了对物理内存的读写能力。但若要修改GDT表实现Ring 0代码。我们将面临着另一个难题，因为sgdt指令获得的GDT地址是虚拟地址(线性地址)，我们只有知道GDT表的物理地址后才能通过\Device\PhysicalMemory对象修改GDT表，这就牵涉到了线性地址转化成物理地址的问题。我们先来看一看Windows NT/2000是如何实现这个的：    kd> u nt!MmGetPhysicalAddress l 30    ntoskrnl!MmGetPhysicalAddress:    801374e0 56               push    esi    801374e1 8b742408         mov     esi,[esp+0x8]    801374e5 33d2             xor     edx,edx    801374e7 81fe00000080     cmp     esi,0x80000000    801374ed 722c             jb    ntoskrnl!MmGetPhysicalAddress+0x2b (8013751b)    801374ef 81fe000000a0     cmp     esi,0xa0000000    801374f5 7324             jnb   ntoskrnl!MmGetPhysicalAddress+0x2b (8013751b)    801374f7 39153ce71780     cmp     [ntoskrnl!MmKseg2Frame (8017e73c)],edx    801374fd 741c             jz    ntoskrnl!MmGetPhysicalAddress+0x2b (8013751b)    801374ff 8bc6             mov     eax,esi    80137501 c1e80c           shr     eax,0xc    80137504 25ffff0100       and     eax,0x1ffff    80137509 6a0c             push    0xc    8013750b 59               pop     ecx    8013750c e8d3a7fcff       call    ntoskrnl!_allshl (80101ce4)    80137511 81e6ff0f0000     and     esi,0xfff    80137517 03c6             add     eax,esi    80137519 eb17             jmp   ntoskrnl!MmGetPhysicalAddress+0x57 (80137532)    8013751b 8bc6             mov     eax,esi    8013751d c1e80a           shr     eax,0xa    80137520 25fcff3f00       and     eax,0x3ffffc    80137525 2d00000040       sub     eax,0x40000000    8013752a 8b00             mov     eax,[eax]    8013752c a801             test    al,0x1    8013752e 7506             jnz   ntoskrnl!MmGetPhysicalAddress+0x44 (80137536)    80137530 33c0             xor     eax,eax    80137532 5e               pop     esi    80137533 c20400           ret     0x4    从这段汇编代码可看出如果线性地址在0x80000000与0xa0000000范围内，只是简单的进行移位操作(位于801374ff-80137519指令间)，并未查页表。我想Microsoft这样安排肯定是出于执行效率的考虑。这也为我们指明了一线曙光，因为GDT表在Windows NT/2000中一般情况下均位于这个区域(我不知道/3GB开关的Windows NT/2000是不是这种情况)。    经过这样的分析，我们就可以只通过用户态程序修改GDT表了。而增加一个CallGate就不是我可以介绍的了，找本Intel手册自己看一看了。具体实现代码如下：    typedef struct gdtr {        short Limit;        short BaseLow;        short BaseHigh;    } Gdtr_t, PGdtr_t;    ULONG MiniMmGetPhysicalAddress(ULONG virtualaddress)    {        if(virtualaddress<0x80000000||virtualaddress>=0xA0000000)           return 0;        return virtualaddress&amp;0x1FFFF000;    }    BOOL ExecRing0Proc(ULONG Entry,ULONG seglen)    {       Gdtr_t gdt;       __asm sgdt gdt;            ULONG mapAddr=MiniMmGetPhysicalAddress(gdt.BaseHigh<<16U|gdt.BaseLow);       if(!mapAddr) return 0;       HANDLE   hSection=NULL;       NTSTATUS status;       OBJECT_ATTRIBUTES        objectAttributes;       UNICODE_STRING objName;       CALLGATE_DESCRIPTOR cg;       status = STATUS_SUCCESS;          RtlInitUnicodeString(&amp;objName,L"\Device\PhysicalMemory");       InitializeObjectAttributes(&amp;objectAttributes,                                  &amp;objName,                                  OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE,                                  NULL,                                 (PSECURITY_DESCRIPTOR) NULL);       status = ZwOpenSection(&amp;hSection,SECTION_MAP_READ|SECTION_MAP_WRITE,&amp;objectAttributes);       if(status == STATUS_ACCESS_DENIED){          status = ZwOpenSection(&amp;hSection,READ_CONTROL|WRITE_DAC,&amp;objectAttributes);          SetPhyscialMemorySectionCanBeWrited(hSection);          ZwClose(hSection);          status =ZwOpenSection(&amp;hSection,SECTION_MAP_WRITE|SECTION_MAP_WRITE,&amp;objectAttributes);       }       if(status != STATUS_SUCCESS)         {            printf(&ldquo;Error Open PhysicalMemory Section Object,Status:%08X\n&rdquo;,status);            return 0;         }             PVOID BaseAddress;       BaseAddress=MapViewOfFile(hSection,                     FILE_MAP_READ|FILE_MAP_WRITE,                     0,                     mapAddr,    //low part                     (gdt.Limit+1));       if(!BaseAddress)          {             printf(&ldquo;Error MapViewOfFile:&rdquo;);             PrintWin32Error(GetLastError());             return 0;          }       BOOL setcg=FALSE;       for(cg=(CALLGATE_DESCRIPTOR )((ULONG)BaseAddress+(gdt.Limit&amp;0xFFF8));(ULONG)cg>(ULONG)BaseAddress;cg&ndash;)           if(cg->type == 0){             cg->offset_0_15 = LOWORD(Entry);             cg->selector = 8;             cg->param_count = 0;             cg->some_bits = 0;             cg->type = 0xC;          // 386 call gate             cg->app_system = 0;      // A system descriptor             cg->dpl = 3;             // Ring 3 code can call             cg->present = 1;             cg->offset_16_31 = HIWORD(Entry);             setcg=TRUE;             break;          }       if(!setcg){            ZwClose(hSection);            return 0;       }       short farcall[3];       farcall[2]=((short)((ULONG)cg-(ULONG)BaseAddress))|3;  //Ring 3 callgate;       if(!VirtualLock((PVOID)Entry,seglen))          {             printf(&ldquo;Error VirtualLock:&rdquo;);             PrintWin32Error(GetLastError());             return 0;          }       SetThreadPriority(GetCurrentThread(),THREAD_PRIORITY_TIME_CRITICAL);       Sleep(0);       _asm call fword ptr [farcall]       SetThreadPriority(GetCurrentThread(),THREAD_PRIORITY_NORMAL);       VirtualUnlock((PVOID)Entry,seglen);       //Clear callgate       (ULONG )cg=0;       ((ULONG *)cg+1)=0;       ZwClose(hSection);       return TRUE;    }    我在提供的代码中演示了对Control Register与I/O端口的操作。CIH病毒在Windows 9X中就是因为获得Ring 0权限才有了一定的危害，但Windows NT/2000毕竟不是Windows 9X，她已经有了比较多的安全审核机制，本文提供的代码也要求具有Administrator权限，但如果系统存在某种漏洞，如缓冲区溢出等等，还是有可能获得这种权限的，所以我不对本文提供的方法负有任何的责任，所有讨论只是一个技术热爱者在讨论技术而已。谢谢！     参考资料：      1.Intel Corp<<Intel Architecture Software Developer&rsquo;s Manual,Volume 3>>  代码下载:http://www.cnblogs.com/Files/flying_bat/ntring0.zip'></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/windows-nt-2000-xp-ring0-implementation-without-driver/ itemprop=url class=post-title-link>Windows NT/2000/XP下不用驱动的Ring0代码实现</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月21日 09:38:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-21 09:38:00 +0800 +0800">2007年09月21日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新于>更新于：
</span><time title="修改时间：2007年09月21日 09:40:00 CST" itemprop="dateModified dateLastmod" datetime="2007-09-21 09:40:00 +0800 +0800">2007年09月21日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/safe/ itemprop=url rel=index><span itemprop=name>dev/Safe</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/windows-nt-2000-xp-ring0-implementation-without-driver/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>大家知道，Windows NT/2000为实现其可靠性，严格将系统划分为内核模式与用户模式，在i386系统中分别对应CPU的Ring0与Ring3级别。Ring0下，可以执行特权级指令，对任何I/O设备都有访问权等等。要实现从用户态进入核心态，即从Ring 3进入Ring 0必须借助CPU的某种门机制，如中断门、调用门等。而Windows NT/2000提供用户态执行系统服务(Ring 0例程)的此类机制即System Service的int 2eh中断服务等，严格的参数检查，只能严格的执行Windows NT/2000提供的服务，而如果想执行用户提供的Ring 0代码(指运行在Ring 0权限的代码)，常规方法似乎只有编写设备驱动程序。本文将介绍一种在用户态不借助任何驱动程序执行Ring0代码的方法。<br><br>    Windows NT/2000将设备驱动程序调入内核区域(常见的位于地址0x80000000上)，由DPL为0的GDT项8，即cs为8时实现Ring 0权限。本文通过在系统中构造一个指向我们的代码的调用门(CallGate)，实现Ring0代码。基于这个思路，为实现这个目的主要是构造自己的CallGate。CallGate由系统中叫Global Descriptor Table(GDT)的全局表指定。GDT地址可由i386指令sgdt获得(sgdt不是特权级指令，普通Ring 3程序均可执行)。GDT地址在Windows NT/2000保存于KPCR(Processor Control Region)结构中(见《再谈Windows NT/2000环境切换》)。GDT中的CallGate是如下的格式：<br><br>    typedef struct<br>    {<br>        unsigned short  offset_0_15;<br>        unsigned short  selector;<br><br>        unsigned char    param_count : 4;<br>        unsigned char    some_bits   : 4;<br><br>        unsigned char    type        : 4;<br>        unsigned char    app_system  : 1;<br>        unsigned char    dpl         : 2;<br>        unsigned char    present     : 1;<br>    <br>        unsigned short  offset_16_31;<br>    } CALLGATE_DESCRIPTOR;<br><br>    GDT位于内核区域，一般用户态的程序是不可能对这段内存区域有直接的访问权。幸运的是Windows NT/2000提供了一个叫PhysicalMemory的Section内核对象位于\Device的路径下。顾名思义，通过这个Section对象可以对物理内存进行操作。用objdir.exe对这个对象分析如下：<br><br>    C:\NTDDK\bin>objdir /D \Device<br><br>    PhysicalMemory                   <br>        Section<br>        DACL - <br>           Ace[ 0] - Grant - 0xf001f - NT AUTHORITY\SYSTEM<br>                             Inherit: <br>                             Access: 0x001F  and  ( D RCtl WOwn WDacl )<br><br>           Ace[ 1] - Grant - 0x2000d - BUILTIN\Administrators<br>                             Inherit: <br>                             Access: 0x000D  and  ( RCtl )<br><br>    从dump出的这个对象DACL的Ace可以看出默认情况下只有SYSTEM用户才有对这个对象的读写权限，即对物理内存有读写能力，而Administrator只有读权限，普通用户根本就没有权限。不过如果我们有Administrator权限就可以通过GetSecurityInfo、SetEntriesInAcl与SetSecurityInfo这些API来修改这个对象的ACE。这也是我提供的代码需要Administrator的原因。实现的代码如下：<br><br>    VOID SetPhyscialMemorySectionCanBeWrited(HANDLE hSection)<br>    {<br><br>       PACL pDacl=NULL;<br>       PACL pNewDacl=NULL;<br>       PSECURITY_DESCRIPTOR pSD=NULL;<br>       DWORD dwRes;<br>       EXPLICIT_ACCESS ea;<br><br>       if(dwRes=GetSecurityInfo(hSection,SE_KERNEL_OBJECT,DACL_SECURITY_INFORMATION,<br>                  NULL,NULL,&amp;pDacl,NULL,&amp;pSD)!=ERROR_SUCCESS)<br>          {<br>             printf( &ldquo;GetSecurityInfo Error %u\n&rdquo;, dwRes );<br>             goto CleanUp;<br>          }<br><br>       ZeroMemory(&amp;ea, sizeof(EXPLICIT_ACCESS));<br>       ea.grfAccessPermissions = SECTION_MAP_WRITE;<br>       ea.grfAccessMode = GRANT_ACCESS;<br>       ea.grfInheritance= NO_INHERITANCE;<br>       ea.Trustee.TrusteeForm = TRUSTEE_IS_NAME;<br>       ea.Trustee.TrusteeType = TRUSTEE_IS_USER;<br>       ea.Trustee.ptstrName = &ldquo;CURRENT_USER&rdquo;;<br><br><br>       if(dwRes=SetEntriesInAcl(1,&amp;ea,pDacl,&amp;pNewDacl)!=ERROR_SUCCESS)<br>          {<br>             printf( &ldquo;SetEntriesInAcl %u\n&rdquo;, dwRes );<br>             goto CleanUp;<br>          }<br><br>       if(dwRes=SetSecurityInfo(hSection,SE_KERNEL_OBJECT,DACL_SECURITY_INFORMATION,NULL,NULL,pNewDacl,NULL)!=ERROR_SUCCESS)<br>          {<br>             printf(&ldquo;SetSecurityInfo %u\n&rdquo;,dwRes);<br>             goto CleanUp;<br>          }<br><br>    CleanUp:<br><br>       if(pSD)<br>          LocalFree(pSD);<br>       if(pNewDacl)<br>          LocalFree(pSD);<br>    }<br><br>    这段代码对给定HANDLE的对象增加了如下的ACE:<br><br>    PhysicalMemory                   <br>        Section<br>        DACL - <br>           Ace[ 0] - Grant - 0x2 - WEBCRAZY\Administrator<br>                             Inherit: <br>                             Access: 0x0002    //SECTION_MAP_WRITE<br><br>    这样我们在有Administrator权限的条件下就有了对物理内存的读写能力。但若要修改GDT表实现Ring 0代码。我们将面临着另一个难题，因为sgdt指令获得的GDT地址是虚拟地址(线性地址)，我们只有知道GDT表的物理地址后才能通过\Device\PhysicalMemory对象修改GDT表，这就牵涉到了线性地址转化成物理地址的问题。我们先来看一看Windows NT/2000是如何实现这个的：<br><br>    kd> u nt!MmGetPhysicalAddress l 30<br>    ntoskrnl!MmGetPhysicalAddress:<br>    801374e0 56               push    esi<br>    801374e1 8b742408         mov     esi,[esp+0x8]<br>    801374e5 33d2             xor     edx,edx<br>    801374e7 81fe00000080     cmp     esi,0x80000000<br>    801374ed 722c             jb    ntoskrnl!MmGetPhysicalAddress+0x2b (8013751b)<br>    801374ef 81fe000000a0     cmp     esi,0xa0000000<br>    801374f5 7324             jnb   ntoskrnl!MmGetPhysicalAddress+0x2b (8013751b)<br>    801374f7 39153ce71780     cmp     [ntoskrnl!MmKseg2Frame (8017e73c)],edx<br>    801374fd 741c             jz    ntoskrnl!MmGetPhysicalAddress+0x2b (8013751b)<br>    801374ff 8bc6             mov     eax,esi<br>    80137501 c1e80c           shr     eax,0xc<br>    80137504 25ffff0100       and     eax,0x1ffff<br>    80137509 6a0c             push    0xc<br>    8013750b 59               pop     ecx<br>    8013750c e8d3a7fcff       call    ntoskrnl!_allshl (80101ce4)<br>    80137511 81e6ff0f0000     and     esi,0xfff<br>    80137517 03c6             add     eax,esi<br>    80137519 eb17             jmp   ntoskrnl!MmGetPhysicalAddress+0x57 (80137532)<br>    8013751b 8bc6             mov     eax,esi<br>    8013751d c1e80a           shr     eax,0xa<br>    80137520 25fcff3f00       and     eax,0x3ffffc<br>    80137525 2d00000040       sub     eax,0x40000000<br>    8013752a 8b00             mov     eax,[eax]<br>    8013752c a801             test    al,0x1<br>    8013752e 7506             jnz   ntoskrnl!MmGetPhysicalAddress+0x44 (80137536)<br>    80137530 33c0             xor     eax,eax<br>    80137532 5e               pop     esi<br>    80137533 c20400           ret     0x4<br><br>    从这段汇编代码可看出如果线性地址在0x80000000与0xa0000000范围内，只是简单的进行移位操作(位于801374ff-80137519指令间)，并未查页表。我想Microsoft这样安排肯定是出于执行效率的考虑。这也为我们指明了一线曙光，因为GDT表在Windows NT/2000中一般情况下均位于这个区域(我不知道/3GB开关的Windows NT/2000是不是这种情况)。<br><br>    经过这样的分析，我们就可以只通过用户态程序修改GDT表了。而增加一个CallGate就不是我可以介绍的了，找本Intel手册自己看一看了。具体实现代码如下：<br><br>    typedef struct gdtr {<br>        short Limit;<br>        short BaseLow;<br>        short BaseHigh;<br>    } Gdtr_t, <em>PGdtr_t;<br><br>    ULONG MiniMmGetPhysicalAddress(ULONG virtualaddress)<br>    {<br>        if(virtualaddress&lt;0x80000000||virtualaddress>=0xA0000000)<br>           return 0;<br>        return virtualaddress&amp;0x1FFFF000;<br>    }<br><br>    BOOL ExecRing0Proc(ULONG Entry,ULONG seglen)<br>    {<br>       Gdtr_t gdt;<br>       __asm sgdt gdt;<br>     <br>       ULONG mapAddr=MiniMmGetPhysicalAddress(gdt.BaseHigh&lt;&lt;16U|gdt.BaseLow);<br>       if(!mapAddr) return 0;<br><br>       HANDLE   hSection=NULL;<br>       NTSTATUS status;<br>       OBJECT_ATTRIBUTES        objectAttributes;<br>       UNICODE_STRING objName;<br>       CALLGATE_DESCRIPTOR <em>cg;<br><br>       status = STATUS_SUCCESS;<br>   <br>       RtlInitUnicodeString(&amp;objName,L"\Device\PhysicalMemory");<br><br>       InitializeObjectAttributes(&amp;objectAttributes,<br>                                  &amp;objName,<br>                                  OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE,<br>                                  NULL,<br>                                 (PSECURITY_DESCRIPTOR) NULL);<br><br>       status = ZwOpenSection(&amp;hSection,SECTION_MAP_READ|SECTION_MAP_WRITE,&amp;objectAttributes);<br><br>       if(status == STATUS_ACCESS_DENIED){<br>          status = ZwOpenSection(&amp;hSection,READ_CONTROL|WRITE_DAC,&amp;objectAttributes);<br>          SetPhyscialMemorySectionCanBeWrited(hSection);<br>          ZwClose(hSection);<br>          status =ZwOpenSection(&amp;hSection,SECTION_MAP_WRITE|SECTION_MAP_WRITE,&amp;objectAttributes);<br>       }<br><br>       if(status != STATUS_SUCCESS)<br>         {<br>            printf(&ldquo;Error Open PhysicalMemory Section Object,Status:%08X\n&rdquo;,status);<br>            return 0;<br>         }<br>      <br>       PVOID BaseAddress;<br><br>       BaseAddress=MapViewOfFile(hSection,<br>                     FILE_MAP_READ|FILE_MAP_WRITE,<br>                     0,<br>                     mapAddr,    //low part<br>                     (gdt.Limit+1));<br><br>       if(!BaseAddress)<br>          {<br>             printf(&ldquo;Error MapViewOfFile:&rdquo;);<br>             PrintWin32Error(GetLastError());<br>             return 0;<br>          }<br><br>       BOOL setcg=FALSE;<br><br>       for(cg=(CALLGATE_DESCRIPTOR </em>)((ULONG)BaseAddress+(gdt.Limit&amp;0xFFF8));(ULONG)cg>(ULONG)BaseAddress;cg&ndash;)<br>           if(cg->type == 0){<br>             cg->offset_0_15 = LOWORD(Entry);<br>             cg->selector = 8;<br>             cg->param_count = 0;<br>             cg->some_bits = 0;<br>             cg->type = 0xC;          // 386 call gate<br>             cg->app_system = 0;      // A system descriptor<br>             cg->dpl = 3;             // Ring 3 code can call<br>             cg->present = 1;<br>             cg->offset_16_31 = HIWORD(Entry);<br>             setcg=TRUE;<br>             break;<br>          }<br><br>       if(!setcg){<br>            ZwClose(hSection);<br>            return 0;<br>       }<br><br>       short farcall[3];<br><br>       farcall[2]=((short)((ULONG)cg-(ULONG)BaseAddress))|3;  //Ring 3 callgate;<br><br>       if(!VirtualLock((PVOID)Entry,seglen))<br>          {<br>             printf(&ldquo;Error VirtualLock:&rdquo;);<br>             PrintWin32Error(GetLastError());<br>             return 0;<br>          }<br><br>       SetThreadPriority(GetCurrentThread(),THREAD_PRIORITY_TIME_CRITICAL);<br><br>       Sleep(0);<br><br>       _asm call fword ptr [farcall]<br><br>       SetThreadPriority(GetCurrentThread(),THREAD_PRIORITY_NORMAL);<br><br>       VirtualUnlock((PVOID)Entry,seglen);<br><br>       //Clear callgate<br>       </em>(ULONG <em>)cg=0;<br>       </em>((ULONG *)cg+1)=0;<br><br>       ZwClose(hSection);<br>       return TRUE;<br><br>    }<br><br>    我在提供的代码中演示了对Control Register与I/O端口的操作。CIH病毒在Windows 9X中就是因为获得Ring 0权限才有了一定的危害，但Windows NT/2000毕竟不是Windows 9X，她已经有了比较多的安全审核机制，本文提供的代码也要求具有Administrator权限，但如果系统存在某种漏洞，如缓冲区溢出等等，还是有可能获得这种权限的，所以我不对本文提供的方法负有任何的责任，所有讨论只是一个技术热爱者在讨论技术而已。谢谢！ <br><br>    参考资料：<br>      1.Intel Corp&lt;&lt;Intel Architecture Software Developer&rsquo;s Manual,Volume 3>>  <br><br><br>代码下载:http://www.cnblogs.com/Files/flying_bat/ntring0.zip</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/windows-nt-2000-xp-ring0-implementation-without-driver/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/alpha-color-blending-in-d3d-3/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="D3D中的Alpha颜色混合（3）"><meta itemprop=description content="本篇是{% post_link alpha-color-blending-in-D3D-2 &ldquo;D3D中的Alpha颜色混合（2）&rdquo; %}的后续篇。
另一种实现实现背景透明显示的简便方法是直接应用渲染管道流水线的Alpha测试功能进行，{% post_link alpha-color-blending-in-D3D-2 &ldquo;D3D中的Alpha颜色混合（2）&rdquo; %}介绍的接口方法实际就是对Alpha测试的一个包装。Alpha测试是对需要写入绘图表面的像素颜色Alpha值进行测试，判断该Alpha值是否满足预先设定的条件，如果满足条件，则将该像素颜色值写入绘图表面，否则不写入。"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/alpha-color-blending-in-d3d-3/ itemprop=url class=post-title-link>D3D中的Alpha颜色混合（3）</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月20日 21:36:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-20 21:36:00 +0800 +0800">2007年09月20日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/gamedev/ itemprop=url rel=index><span itemprop=name>dev/GameDev</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/alpha-color-blending-in-d3d-3/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>本篇是{% post_link alpha-color-blending-in-D3D-2 &ldquo;D3D中的Alpha颜色混合（2）&rdquo; %}的后续篇。</p><p>另一种实现实现背景透明显示的简便方法是直接应用渲染管道流水线的Alpha测试功能进行，{% post_link alpha-color-blending-in-D3D-2 &ldquo;D3D中的Alpha颜色混合（2）&rdquo; %}介绍的接口方法实际就是对Alpha测试的一个包装。Alpha测试是对需要写入绘图表面的像素颜色Alpha值进行测试，判断该Alpha值是否满足预先设定的条件，如果满足条件，则将该像素颜色值写入绘图表面，否则不写入。</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/alpha-color-blending-in-d3d-3/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/alpha-color-blending-in-d3d-2/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="D3D中的Alpha颜色混合（2）"><meta itemprop=description content="本篇是{% post_link alpha-color-blending-in-D3D-1 &ldquo;D3D中的Alpha颜色混合（1）&rdquo; %}的后续篇，主要讲利用ID3DXSprite来实现图片间的颜色透明效果。"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/alpha-color-blending-in-d3d-2/ itemprop=url class=post-title-link>D3D中的Alpha颜色混合（2）</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月20日 21:35:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-20 21:35:00 +0800 +0800">2007年09月20日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/gamedev/ itemprop=url rel=index><span itemprop=name>dev/GameDev</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/alpha-color-blending-in-d3d-2/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>本篇是{% post_link alpha-color-blending-in-D3D-1 &ldquo;D3D中的Alpha颜色混合（1）&rdquo; %}的后续篇，主要讲利用ID3DXSprite来实现图片间的颜色透明效果。</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/alpha-color-blending-in-d3d-2/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/alpha-color-blending-in-d3d-1/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="D3D中的Alpha颜色混合（1）"><meta itemprop=description content="渲染管道流水线通常需要将来自顶点的颜色，纹理像素的颜色，光照颜色以及物体表面材质反射光颜色进行混合，生成计算机屏幕的像素颜色。将多种颜色混合在一起，必须考虑各种颜色的成分比例，这个比例由Alpha因子决定。对于游戏开发来说，利用Alpha颜色混合可产生背景透明的渲染效果。"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/alpha-color-blending-in-d3d-1/ itemprop=url class=post-title-link>D3D中的Alpha颜色混合（1）</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月20日 21:34:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-20 21:34:00 +0800 +0800">2007年09月20日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/gamedev/ itemprop=url rel=index><span itemprop=name>dev/GameDev</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/alpha-color-blending-in-d3d-1/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>渲染管道流水线通常需要将来自顶点的颜色，纹理像素的颜色，光照颜色以及物体表面材质反射光颜色进行混合，生成计算机屏幕的像素颜色。将多种颜色混合在一起，必须考虑各种颜色的成分比例，这个比例由Alpha因子决定。对于游戏开发来说，利用Alpha颜色混合可产生背景透明的渲染效果。</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/alpha-color-blending-in-d3d-1/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/verify-microsoft-digital-signature/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="验证微软数字签名"><meta itemprop=description content='代码共享如下，在Win2K sp4/WinXP sp2上调试通过。



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81


BOOL CheckFileTrust( LPCWSTR lpFileName )
{
        BOOL bRet = FALSE;
    WINTRUST_DATA wd = { 0 };
    WINTRUST_FILE_INFO wfi = { 0 };
    WINTRUST_CATALOG_INFO wci = { 0 };
    CATALOG_INFO ci = { 0 };

    HCATADMIN hCatAdmin = NULL;
    <FONT color=blue>if</FONT> ( !CryptCATAdminAcquireContext( &amp;amp;hCatAdmin, NULL, 0 ) )
    {
            <FONT color=blue>return</FONT> FALSE;
    }

    HANDLE hFile = CreateFileW( lpFileName, GENERIC_READ, FILE_SHARE_READ,
        NULL, OPEN_EXISTING, 0, NULL );
    <FONT color=blue>if</FONT> ( INVALID_HANDLE_VALUE == hFile )
    {
            CryptCATAdminReleaseContext( hCatAdmin, 0 );
        <FONT color=blue>return</FONT> FALSE;
    }

    DWORD dwCnt = 100;
    BYTE byHash[100];
    CryptCATAdminCalcHashFromFileHandle( hFile, &amp;amp;dwCnt, byHash, 0 );
    CloseHandle( hFile );

    LPWSTR pszMemberTag = <FONT color=blue>new</FONT> WCHAR[dwCnt * 2 + 1];
    <FONT color=blue>for</FONT> ( DWORD dw = 0; dw &amp;lt; dwCnt; ++dw )
    {
            wsprintfW( &amp;amp;pszMemberTag[dw * 2], L"%02X", byHash[dw] );
    }

    HCATINFO hCatInfo = CryptCATAdminEnumCatalogFromHash( hCatAdmin,
        byHash, dwCnt, 0, NULL );
    <FONT color=blue>if</FONT> ( NULL == hCatInfo )
    {
            wfi.cbStruct       = <FONT color=blue>sizeof</FONT>( WINTRUST_FILE_INFO );
        wfi.pcwszFilePath  = lpFileName;
        wfi.hFile          = NULL;
        wfi.pgKnownSubject = NULL;

        wd.cbStruct            = <FONT color=blue>sizeof</FONT>( WINTRUST_DATA );
        wd.dwUnionChoice       = WTD_CHOICE_FILE;
        wd.pFile               = &amp;amp;wfi;
        wd.dwUIChoice          = WTD_UI_NONE;
        wd.fdwRevocationChecks = WTD_REVOKE_NONE;
        wd.dwStateAction       = WTD_STATEACTION_IGNORE;
        wd.dwProvFlags         = WTD_SAFER_FLAG;
        wd.hWVTStateData       = NULL;
        wd.pwszURLReference    = NULL;
    }
    <FONT color=blue>else</FONT>
    {
            CryptCATCatalogInfoFromContext( hCatInfo, &amp;amp;ci, 0 );
        wci.cbStruct             = <FONT color=blue>sizeof</FONT>( WINTRUST_CATALOG_INFO );
        wci.pcwszCatalogFilePath = ci.wszCatalogFile;
        wci.pcwszMemberFilePath  = lpFileName;
        wci.pcwszMemberTag       = pszMemberTag;

        wd.cbStruct            = <FONT color=blue>sizeof</FONT>( WINTRUST_DATA );
        wd.dwUnionChoice       = WTD_CHOICE_CATALOG;
        wd.pCatalog            = &amp;amp;wci;
        wd.dwUIChoice          = WTD_UI_NONE;
        wd.fdwRevocationChecks = WTD_STATEACTION_VERIFY;
        wd.dwProvFlags         = 0;
        wd.hWVTStateData       = NULL;
        wd.pwszURLReference    = NULL;
    }
    GUID action = WINTRUST_ACTION_GENERIC_VERIFY_V2;
    HRESULT hr  = WinVerifyTrust( NULL, &amp;amp;action, &amp;amp;wd );
    bRet        = SUCCEEDED( hr );

    <FONT color=blue>if</FONT> ( NULL != hCatInfo )
    {
            CryptCATAdminReleaseCatalogContext( hCatAdmin, hCatInfo, 0 );
    }
    CryptCATAdminReleaseContext( hCatAdmin, 0 ); <FONT color=green>// 2007.4.10感谢童志明君指出一处内存泄漏</FONT>
    <FONT color=blue>delete</FONT>[] pszMemberTag;
    <FONT color=blue>return</FONT> bRet;
}



这段代码是在一个老外的论坛上不经意搜索到的，一个貌似德国人（因为他的注释不是英文写的，德国亦仅猜测尔，西班牙、葡萄牙、法兰西、俄罗斯亦都有可能）写的Delphi代码，其中使用了WinTrust.dll中的导出函数。使用VS2005的朋友们可以包含WinTrust.h、SoftPub.h和Mscat.h，并添加导入库WinTrust.lib；使用VC6的朋友们可以参考MSDN上的函数及结构体声明，并用函数指针进行调用。'></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/verify-microsoft-digital-signature/ itemprop=url class=post-title-link>验证微软数字签名</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月20日 14:30:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-20 14:30:00 +0800 +0800">2007年09月20日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/win32dev/ itemprop=url rel=index><span itemprop=name>dev/Win32Dev</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/verify-microsoft-digital-signature/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>代码共享如下，在Win2K sp4/WinXP sp2上调试通过。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39>39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40>40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41>41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42>42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43>43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44>44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45>45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46>46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47>47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48>48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49>49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50>50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51>51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52>52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53>53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54>54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55>55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56>56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57>57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58>58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59>59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60>60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61>61</a>
</span><span class=lnt id=hl-0-62><a class=lnlinks href=#hl-0-62>62</a>
</span><span class=lnt id=hl-0-63><a class=lnlinks href=#hl-0-63>63</a>
</span><span class=lnt id=hl-0-64><a class=lnlinks href=#hl-0-64>64</a>
</span><span class=lnt id=hl-0-65><a class=lnlinks href=#hl-0-65>65</a>
</span><span class=lnt id=hl-0-66><a class=lnlinks href=#hl-0-66>66</a>
</span><span class=lnt id=hl-0-67><a class=lnlinks href=#hl-0-67>67</a>
</span><span class=lnt id=hl-0-68><a class=lnlinks href=#hl-0-68>68</a>
</span><span class=lnt id=hl-0-69><a class=lnlinks href=#hl-0-69>69</a>
</span><span class=lnt id=hl-0-70><a class=lnlinks href=#hl-0-70>70</a>
</span><span class=lnt id=hl-0-71><a class=lnlinks href=#hl-0-71>71</a>
</span><span class=lnt id=hl-0-72><a class=lnlinks href=#hl-0-72>72</a>
</span><span class=lnt id=hl-0-73><a class=lnlinks href=#hl-0-73>73</a>
</span><span class=lnt id=hl-0-74><a class=lnlinks href=#hl-0-74>74</a>
</span><span class=lnt id=hl-0-75><a class=lnlinks href=#hl-0-75>75</a>
</span><span class=lnt id=hl-0-76><a class=lnlinks href=#hl-0-76>76</a>
</span><span class=lnt id=hl-0-77><a class=lnlinks href=#hl-0-77>77</a>
</span><span class=lnt id=hl-0-78><a class=lnlinks href=#hl-0-78>78</a>
</span><span class=lnt id=hl-0-79><a class=lnlinks href=#hl-0-79>79</a>
</span><span class=lnt id=hl-0-80><a class=lnlinks href=#hl-0-80>80</a>
</span><span class=lnt id=hl-0-81><a class=lnlinks href=#hl-0-81>81</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=n>BOOL</span> <span class=nf>CheckFileTrust</span><span class=p>(</span> <span class=n>LPCWSTR</span> <span class=n>lpFileName</span> <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>BOOL</span> <span class=n>bRet</span> <span class=o>=</span> <span class=n>FALSE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>WINTRUST_DATA</span> <span class=n>wd</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>0</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>WINTRUST_FILE_INFO</span> <span class=n>wfi</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>0</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>WINTRUST_CATALOG_INFO</span> <span class=n>wci</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>0</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>CATALOG_INFO</span> <span class=n>ci</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>0</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HCATADMIN</span> <span class=n>hCatAdmin</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=p>(</span> <span class=o>!</span><span class=n>CryptCATAdminAcquireContext</span><span class=p>(</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>hCatAdmin</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=mi>0</span> <span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=n>FALSE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HANDLE</span> <span class=n>hFile</span> <span class=o>=</span> <span class=n>CreateFileW</span><span class=p>(</span> <span class=n>lpFileName</span><span class=p>,</span> <span class=n>GENERIC_READ</span><span class=p>,</span> <span class=n>FILE_SHARE_READ</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>NULL</span><span class=p>,</span> <span class=n>OPEN_EXISTING</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>NULL</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=p>(</span> <span class=n>INVALID_HANDLE_VALUE</span> <span class=o>==</span> <span class=n>hFile</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>CryptCATAdminReleaseContext</span><span class=p>(</span> <span class=n>hCatAdmin</span><span class=p>,</span> <span class=mi>0</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=n>FALSE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>DWORD</span> <span class=n>dwCnt</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>BYTE</span> <span class=n>byHash</span><span class=p>[</span><span class=mi>100</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>CryptCATAdminCalcHashFromFileHandle</span><span class=p>(</span> <span class=n>hFile</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>dwCnt</span><span class=p>,</span> <span class=n>byHash</span><span class=p>,</span> <span class=mi>0</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>CloseHandle</span><span class=p>(</span> <span class=n>hFile</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>LPWSTR</span> <span class=n>pszMemberTag</span> <span class=o>=</span> <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>new</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=n>WCHAR</span><span class=p>[</span><span class=n>dwCnt</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=p>(</span> <span class=n>DWORD</span> <span class=n>dw</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>dw</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=n>dwCnt</span><span class=p>;</span> <span class=o>++</span><span class=n>dw</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>wsprintfW</span><span class=p>(</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>pszMemberTag</span><span class=p>[</span><span class=n>dw</span> <span class=o>*</span> <span class=mi>2</span><span class=p>],</span> <span class=sa>L</span><span class=s>&#34;%02X&#34;</span><span class=p>,</span> <span class=n>byHash</span><span class=p>[</span><span class=n>dw</span><span class=p>]</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HCATINFO</span> <span class=n>hCatInfo</span> <span class=o>=</span> <span class=n>CryptCATAdminEnumCatalogFromHash</span><span class=p>(</span> <span class=n>hCatAdmin</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>byHash</span><span class=p>,</span> <span class=n>dwCnt</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>NULL</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=p>(</span> <span class=nb>NULL</span> <span class=o>==</span> <span class=n>hCatInfo</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>wfi</span><span class=p>.</span><span class=n>cbStruct</span>       <span class=o>=</span> <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>sizeof</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span><span class=p>(</span> <span class=n>WINTRUST_FILE_INFO</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wfi</span><span class=p>.</span><span class=n>pcwszFilePath</span>  <span class=o>=</span> <span class=n>lpFileName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wfi</span><span class=p>.</span><span class=n>hFile</span>          <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wfi</span><span class=p>.</span><span class=n>pgKnownSubject</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>cbStruct</span>            <span class=o>=</span> <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>sizeof</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span><span class=p>(</span> <span class=n>WINTRUST_DATA</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>dwUnionChoice</span>       <span class=o>=</span> <span class=n>WTD_CHOICE_FILE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>pFile</span>               <span class=o>=</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>wfi</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>dwUIChoice</span>          <span class=o>=</span> <span class=n>WTD_UI_NONE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>fdwRevocationChecks</span> <span class=o>=</span> <span class=n>WTD_REVOKE_NONE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>dwStateAction</span>       <span class=o>=</span> <span class=n>WTD_STATEACTION_IGNORE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>dwProvFlags</span>         <span class=o>=</span> <span class=n>WTD_SAFER_FLAG</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>hWVTStateData</span>       <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>pwszURLReference</span>    <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>CryptCATCatalogInfoFromContext</span><span class=p>(</span> <span class=n>hCatInfo</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>ci</span><span class=p>,</span> <span class=mi>0</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wci</span><span class=p>.</span><span class=n>cbStruct</span>             <span class=o>=</span> <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>sizeof</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span><span class=p>(</span> <span class=n>WINTRUST_CATALOG_INFO</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wci</span><span class=p>.</span><span class=n>pcwszCatalogFilePath</span> <span class=o>=</span> <span class=n>ci</span><span class=p>.</span><span class=n>wszCatalogFile</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wci</span><span class=p>.</span><span class=n>pcwszMemberFilePath</span>  <span class=o>=</span> <span class=n>lpFileName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wci</span><span class=p>.</span><span class=n>pcwszMemberTag</span>       <span class=o>=</span> <span class=n>pszMemberTag</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>cbStruct</span>            <span class=o>=</span> <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>sizeof</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span><span class=p>(</span> <span class=n>WINTRUST_DATA</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>dwUnionChoice</span>       <span class=o>=</span> <span class=n>WTD_CHOICE_CATALOG</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>pCatalog</span>            <span class=o>=</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>wci</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>dwUIChoice</span>          <span class=o>=</span> <span class=n>WTD_UI_NONE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>fdwRevocationChecks</span> <span class=o>=</span> <span class=n>WTD_STATEACTION_VERIFY</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>dwProvFlags</span>         <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>hWVTStateData</span>       <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>wd</span><span class=p>.</span><span class=n>pwszURLReference</span>    <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>GUID</span> <span class=n>action</span> <span class=o>=</span> <span class=n>WINTRUST_ACTION_GENERIC_VERIFY_V2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>HRESULT</span> <span class=n>hr</span>  <span class=o>=</span> <span class=n>WinVerifyTrust</span><span class=p>(</span> <span class=nb>NULL</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>action</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>amp</span><span class=p>;</span><span class=n>wd</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>bRet</span>        <span class=o>=</span> <span class=n>SUCCEEDED</span><span class=p>(</span> <span class=n>hr</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=p>(</span> <span class=nb>NULL</span> <span class=o>!=</span> <span class=n>hCatInfo</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>CryptCATAdminReleaseCatalogContext</span><span class=p>(</span> <span class=n>hCatAdmin</span><span class=p>,</span> <span class=n>hCatInfo</span><span class=p>,</span> <span class=mi>0</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>CryptCATAdminReleaseContext</span><span class=p>(</span> <span class=n>hCatAdmin</span><span class=p>,</span> <span class=mi>0</span> <span class=p>);</span> <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>green</span><span class=o>&gt;</span><span class=c1>// 2007.4.10感谢童志明君指出一处内存泄漏&lt;/FONT&gt;
</span></span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>delete</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span><span class=p>[]</span> <span class=n>pszMemberTag</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>FONT</span> <span class=n>color</span><span class=o>=</span><span class=n>blue</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>FONT</span><span class=o>&gt;</span> <span class=n>bRet</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>这段代码是在一个老外的论坛上不经意搜索到的，一个貌似德国人（因为他的注释不是英文写的，德国亦仅猜测尔，西班牙、葡萄牙、法兰西、俄罗斯亦都有可能）写的Delphi代码，其中使用了WinTrust.dll中的导出函数。使用VS2005的朋友们可以包含WinTrust.h、SoftPub.h和Mscat.h，并添加导入库WinTrust.lib；使用VC6的朋友们可以参考MSDN上的函数及结构体声明，并用函数指针进行调用。</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/verify-microsoft-digital-signature/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/master-of-my-emotions-another-article/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="我要做自己情绪的主人-又一篇"><meta itemprop=description content="我要做自己情绪的主人！潮起潮落、冬去春来、月圆月缺、花飞花谢，自然界万物都在循环往复的变化之中，我也不例外，情绪会时好时坏。每天清晨醒来时，我可能不再有旧日的情怀。昨日的欢乐变成今日的哀愁，今日的悲伤又转为明日的喜悦。我的心像车轮般不停地旋转：由乐而悲，由悲而喜，由喜而忧。这就好比花儿的变化，今日绽放时的喜悦终将变成明天凋谢时的绝望。但是我要牢牢记住：正如今天枯败的花儿蕴藏着明天新生的种子，今天的悲伤也预示着明日的欢乐。我要做自己情绪的主人！我怎样才能控制自己的情绪，使我的每一天卓有成效？我只知道这样一个事实：无论我为他人带来的是风雨、忧郁、黑暗和悲观，还是欢乐、喜悦、光明和笑声，他们都会以同样而报之。花草树木，随着气候的变化而生长，而我要为自己创造天气，学会用自己的心灵弥补气候的不足。我必须得心平气和，否则迎来的又将是失败的一天。我要做自己情绪的主人！我怎样才能控制自己的情绪，让我的每一天充满幸福和欢乐？我要学会这个千古秘诀：弱者任思绪控制行为，强者让行为控制思绪。每天醒来当我被悲伤、自怜、失败的情绪包围时，我就这样与之对抗：沮丧时，我引亢高歌；悲伤时，我开怀大笑；病痛时，我加倍工作；恐惧时，我勇往直前；自卑时，我换上新装；不安时，我提高嗓音；穷困潦倒时，我想象未来的富有；力不从心时，我回想过去的成功；自轻自贱时，我想想自己的目标。我要做自己情绪的主人！从今往后，我必须不断对抗那些企图摧垮我的力量。失望与悲伤一眼就可识破，而那些不易觉察、面带微笑、招手而来的敌人，却随时可能将我摧毁。对它们，我永远不能放松警惕：自高自大时，我要追寻失败的记忆；洋洋得意时，我要想想竞争的对手；沾沾自喜时，不要忘了那忍辱的时刻；自以为是时，看看自己能否让风止步；骄傲自满时，要想到自己怯懦的时候；不可一世时，抬起头来，仰望天上群星。我要做自己情绪的主人！有了这项本领，我就能体察别人的情绪变化。我会宽容怒气冲冲的人，因为他尚未懂得控制自己的情绪；我能忍受他人的指责与辱骂，因为知道明天他会重新变得随和。我不再只凭一面之交来判断他人，也不再因一时的怨恨与人绝交。今天不肯花一分钱购买金蓬马车的人，明天也许会用全部家当换取树苗。知道了这个秘密，我对人可以宽容大度，对事能够冷静客观。我要做自己情绪的主人！我从此领悟了人类情绪变化的奥秘。对于自己千变万化的个性，我不再听之任之，我知道，只有积极主动地控制情绪，才能掌握自己的命运。我成为自己情绪的主人，我由此而变得伟大。我要做自己情绪的主人！"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/master-of-my-emotions-another-article/ itemprop=url class=post-title-link>我要做自己情绪的主人-又一篇</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月20日 13:53:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-20 13:53:00 +0800 +0800">2007年09月20日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/capricethink/ itemprop=url rel=index><span itemprop=name>CapriceThink</span>
</a></span></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/master-of-my-emotions-another-article/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>我要做自己情绪的主人！<br><br>潮起潮落、冬去春来、月圆月缺、花飞花谢，自然界万物都在循环往复的变化之中，我也不例外，情绪会时好时坏。每天清晨醒来时，我可能不再有旧日的情怀。昨日的欢乐变成今日的哀愁，今日的悲伤又转为明日的喜悦。我的心像车轮般不停地旋转：由乐而悲，由悲而喜，由喜而忧。这就好比花儿的变化，今日绽放时的喜悦终将变成明天凋谢时的绝望。但是我要牢牢记住：正如今天枯败的花儿蕴藏着明天新生的种子，今天的悲伤也预示着明日的欢乐。<br><br>我要做自己情绪的主人！<br><br>我怎样才能控制自己的情绪，使我的每一天卓有成效？我只知道这样一个事实：无论我为他人带来的是风雨、忧郁、黑暗和悲观，还是欢乐、喜悦、光明和笑声，他们都会以同样而报之。花草树木，随着气候的变化而生长，而我要为自己创造天气，学会用自己的心灵弥补气候的不足。我必须得心平气和，否则迎来的又将是失败的一天。<br><br>我要做自己情绪的主人！<br><br>我怎样才能控制自己的情绪，让我的每一天充满幸福和欢乐？我要学会这个千古秘诀：弱者任思绪控制行为，强者让行为控制思绪。每天醒来当我被悲伤、自怜、失败的情绪包围时，我就这样与之对抗：沮丧时，我引亢高歌；悲伤时，我开怀大笑；病痛时，我加倍工作；恐惧时，我勇往直前；自卑时，我换上新装；不安时，我提高嗓音；穷困潦倒时，我想象未来的富有；力不从心时，我回想过去的成功；自轻自贱时，我想想自己的目标。<br><br>我要做自己情绪的主人！<br><br>从今往后，我必须不断对抗那些企图摧垮我的力量。失望与悲伤一眼就可识破，而那些不易觉察、面带微笑、招手而来的敌人，却随时可能将我摧毁。对它们，我永远不能放松警惕：自高自大时，我要追寻失败的记忆；洋洋得意时，我要想想竞争的对手；沾沾自喜时，不要忘了那忍辱的时刻；自以为是时，看看自己能否让风止步；骄傲自满时，要想到自己怯懦的时候；不可一世时，抬起头来，仰望天上群星。<br><br>我要做自己情绪的主人！<br><br>有了这项本领，我就能体察别人的情绪变化。我会宽容怒气冲冲的人，因为他尚未懂得控制自己的情绪；我能忍受他人的指责与辱骂，因为知道明天他会重新变得随和。我不再只凭一面之交来判断他人，也不再因一时的怨恨与人绝交。今天不肯花一分钱购买金蓬马车的人，明天也许会用全部家当换取树苗。知道了这个秘密，我对人可以宽容大度，对事能够冷静客观。<br><br>我要做自己情绪的主人！<br><br>我从此领悟了人类情绪变化的奥秘。对于自己千变万化的个性，我不再听之任之，我知道，只有积极主动地控制情绪，才能掌握自己的命运。我成为自己情绪的主人，我由此而变得伟大。<br><br>我要做自己情绪的主人！</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/master-of-my-emotions-another-article/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/today-i-will-be-master-of-my-emotions/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="今天，我要做自己情绪的主人 Today I will be master of my emotions."><meta itemprop=description content="年初的时候，几乎天天跟人吵架，因为什么呢？因为自己的狗脾气，那会甚至都不管自己到底对不对，反正就是吵。坦诚的说，后来都有点因此而沾沾自喜，觉得那是自己NB，自己是个有个性的人。事到如今，真是忍不住要笑一笑自己了，呵呵，用下面文章里的一句话来说就是：弱 者任情绪控制行为，强者让行为控制情绪。我是弱者，所以让情绪控制了自己的行为，还引以为荣。呵呵，你说可笑不？可笑。把这篇文章收藏在这里，供自己今后 再次翻阅。我想，只要在今后狗脾气再犯的时候，能来这里看看，确实能认真的读一下下面的文字，那我一定可以从弱者变成一个可以控制情绪的人的。"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/today-i-will-be-master-of-my-emotions/ itemprop=url class=post-title-link>今天，我要做自己情绪的主人 Today I will be master of my emotions.</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年09月20日 13:52:00 CST" itemprop="dateCreated datePublished" datetime="2007-09-20 13:52:00 +0800 +0800">2007年09月20日
</time></span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/today-i-will-be-master-of-my-emotions/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>年初的时候，几乎天天跟人吵架，因为什么呢？因为自己的狗脾气，那会甚至都不管自己到底对不对，反正就是吵。坦诚的说，后来都有点因此而沾沾自喜，觉得那是自己NB，自己是个有个性的人。事到如今，真是忍不住要笑一笑自己了，呵呵，用下面文章里的一句话来说就是：<strong>弱 者任情绪控制行为，强者让行为控制情绪。</strong>我是弱者，所以让情绪控制了自己的行为，还引以为荣。呵呵，你说可笑不？可笑。把这篇文章收藏在这里，供自己今后 再次翻阅。我想，只要在今后狗脾气再犯的时候，能来这里看看，确实能认真的读一下下面的文字，那我一定可以从弱者变成一个可以控制情绪的人的。</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/today-i-will-be-master-of-my-emotions/#more rel=contents>阅读全文 &#187;</a></div><div class=post-eof></div></footer></article></div><nav class=pagination><a class="extend prev" rel=prev href=/page/46/><i class="fa fa-angle-left"></i>
</a><a class=page-number href=/page/43/>43</a>
<a class=page-number href=/page/44/>44</a>
<a class=page-number href=/page/45/>45</a>
<a class=page-number href=/page/46/>46</a>
<span class="page-number current">47</span>
<a class=page-number href=/page/48/>48</a>
<a class=page-number href=/page/49/>49</a>
<a class=page-number href=/page/50/>50</a>
<a class=page-number href=/page/51/>51</a>
<a class="extend next" rel=next href=/page/48/><i class="fa fa-angle-right"></i></a></nav></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2026
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.157.0 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":true,"isPage":false,"path":"blogs.qipai360.cn","permalink":"https://blogs.qipai360.cn/","title":"Rise的自留地","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1772265585" defer></script></body></html>