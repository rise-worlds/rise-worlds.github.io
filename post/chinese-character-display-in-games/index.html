<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.152.2"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="游戏中汉字显示的实现与技巧[ZZ]"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Rise,ZhangTuohui,技术,C++,Unity3D,Lua,NodeJS,C#,JavaScript,游戏开发,机器学习,深度学习,AI,编程,编程语言,编程技术,编程开发,游戏引擎,游戏设计,游戏制作,游戏开发者,游戏开发者博客,游戏开发者网站,游戏开发者工具,游戏开发者教程,游戏开发者学习,游戏开发者交流,游戏开发者分享,游戏开发者经验,游戏开发者心得,游戏开发者技巧,游戏开发者方法,游戏开发者思路,游戏开发者理念,游戏开发者文化,游戏开发者精神,游戏开发者信仰"><meta property="og:type" content="article"><meta property="og:title" content="游戏中汉字显示的实现与技巧[ZZ]"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/chinese-character-display-in-games/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2008-09-22 14:42:00 +0800 +0800"><meta property="article:modified_time" content="2008-09-22 14:42:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1761990626"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>游戏中汉字显示的实现与技巧[ZZ] - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>678</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>678</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>34</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>117</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2418817></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5198></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2025-11-01 14:55:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/chinese-character-display-in-games/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="游戏中汉字显示的实现与技巧[ZZ]"><meta itemprop=description content=" 作者：炎龙工作室 千里马肝<?xml:namespace prefix = o />"></span><header class=post-header><h1 class=post-title itemprop="name headline">游戏中汉字显示的实现与技巧[ZZ]</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2008年09月22日 14:42:00 CST" itemprop="dateCreated datePublished" datetime="2008-09-22 14:42:00 +0800 +0800">2008年09月22日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/gamedev/ itemprop=url rel=index><span itemprop=name>dev/GameDev</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>9942</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>20分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/chinese-character-display-in-games/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><div style="border-right:#000 1pt solid;padding-right:11pt;border-top:none;padding-left:11pt;background:#eec;padding-bottom:0;border-left:#000 1pt solid;padding-top:0;border-bottom:none;mso-element:para-border-div;mso-border-left-alt:solid black .75pt;mso-border-right-alt:solid black .75pt"><p class=MsoNormal style="border-right:none;padding-right:0;border-top:none;padding-left:0;background:#eec;padding-bottom:0;border-left:none;padding-top:0;border-bottom:none;mso-border-left-alt:solid black .75pt;mso-border-right-alt:solid black .75pt;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-padding-alt:0 11pt 0 11pt"><span style=font-size:9pt;font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>作者：</span><span lang=EN-US style=font-size:9pt><a href=http://www.tlovexyj.com/><span lang=EN-US style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin><span lang=EN-US>炎龙工作室</span></span></a> <a href=mailto:tlovexyj@21cn.com><span lang=EN-US style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin><span lang=EN-US>千里马肝</span></span></a><o:p></o:p></span></p><a id=more></a><p class=MsoNormal style="border-right:none;padding-right:0;border-top:none;padding-left:0;background:#eec;padding-bottom:0;border-left:none;padding-top:0;border-bottom:none;mso-border-left-alt:solid black .75pt;mso-border-right-alt:solid black .75pt;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-padding-alt:0 11pt 0 11pt"><span style=font-size:9pt;font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>版本：</span><span lang=EN-US style=font-size:9pt>v1.0<o:p></o:p></span></p><p class=MsoNormal style="border-right:none;padding-right:0;border-top:none;padding-left:0;background:#eec;padding-bottom:0;border-left:none;padding-top:0;border-bottom:none;mso-border-left-alt:solid black .75pt;mso-border-right-alt:solid black .75pt;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-padding-alt:0 11pt 0 11pt"><span style=font-size:9pt;font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>最后更新日期：</span><span lang=EN-US style=font-size:9pt>2002-3-30<o:p></o:p></span></p></div><h3><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:major-latin>绪言</span></h3><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>在游戏中，因为我们是中国人麻，通常都需要显示汉字，比方说交待剧情。而对于文字的显示，英文的显示要较其简单得多，因为只有</span><span lang=EN-US>26</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>个字母，就算再加一些标点、符号什么的，用一张位图，就可以足以显示所有的单词了，而相关实现技巧，也比较轻松。</span><span lang=EN-US><a href=http://www.cnblogs.com/images/cnblogs_com/flying_bat/WindowsLiveWriter/ZZ_CEB8/clip_image002_4.gif><img style=border-top-width:0;border-left-width:0;border-bottom-width:0;border-right-width:0 height=38 alt=clip_image002 src=http://www.cnblogs.com/images/cnblogs_com/flying_bat/WindowsLiveWriter/ZZ_CEB8/clip_image002_thumb_1.gif width=244 border=0 v:shapes=_x0000_i1025></a></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>而中文的显示方法，要复杂得许多。记得原来在</span><span lang=EN-US>DOS</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>下，汉字的显示都是读的</span><span lang=EN-US>UCDOS</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>的点阵字库，而点阵字库的读取方法，在</span><span lang=EN-US>UCDOS SDK</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>中都有源代码可以参考。但是自从</span><span lang=EN-US>Windows</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>操作系统开始，我们开始了解到一种更好的字库，它就是</span><span lang=EN-US>TTF</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>。</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>注：以下我所指的开发环境，除非明确说明，默认的平台是</span><span lang=EN-US>VC6.0+DirectX8.1</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>，使用</span><span lang=EN-US>D3D</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>来加速</span><span lang=EN-US>2D</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>。然后使用的</span><span lang=EN-US>STL</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>是用的</span><span lang=EN-US>SGI</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>实现的那一套</span><span lang=EN-US>STL</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>。</span></p><h3><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:major-latin>点阵字库</span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast><o:p></o:p></span></h3><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>包括现在，有很多游戏都还是使用的点阵字库。因为操作起来比较方便，加上这方面的经验已经积累了好几年了。通常如果只是一种字体就可以满足需要的话，它会是一个比较好、快的解决办法。但是它有<span lang=EN-US>3</span>个缺点<span lang=EN-US>:<o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l5 level1 lfo1;tab-stops:list 42pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>1.<span style="font:7pt times new roman">&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>如果放大显示，不做处理的话，显示出来的汉字，是很难看的。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l5 level1 lfo1;tab-stops:list 42pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>2.<span style="font:7pt times new roman">&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>像是<span lang=EN-US>UCDOS</span>所提供的点阵字库，只有<span lang=EN-US>24</span>点阵的有几种字体，如：宋体、黑体、揩体…，而<span lang=EN-US>16</span>点阵的好象就只有宋体一种。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l5 level1 lfo1;tab-stops:list 42pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>3.<span style="font:7pt times new roman">&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>点阵字库，通常是有版权的，尤其是第三方制作的汉字库（如：方正）。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoBodyTextIndent>在这样的情况下，当我们写好这样的一个显示函数，就算是解决了如：放大、快速显示等问题的话，可供选择的字体还是太过于局限了。所以，在字体的要求比较强的情况下，点阵字库并不是一个好的解决方法，他不够灵活。尽管我们对于它的操作是如此得熟练，可以写出优美的代码来展示我们的编程技巧。</p><h3><span lang=EN-US>TTF</span></h3><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>TTF</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>是<span lang=EN-US>True Type Font</span>的简称。在<span lang=EN-US>Windows\Fonts</span>目录下面，我们可以看到许多后缀为<span lang=EN-US>ttf</span>的文件，它就是接下来我们接下来所要谈到的。</span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-fareast-language:zh-tw><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>TTF</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>是一种矢量字库。我们经常可以听到矢量这个词，像是<span lang=EN-US>FLASH</span>中的矢量图形，在<span lang=EN-US>100*100</span>分辨率下制作的<span lang=EN-US>flash</span>，就算它放大为全屏，显示出的画面也不会出现马赛克。所谓矢量，其实说白了就是用点和线来描述图形，这样，在图形需要放大的时候，只要把所有这个图形的点和线放大相应的倍数就可以了。而且，在网站上有很多的<span lang=EN-US>TTF</span>字库可以下载，或者你可以去买一些专门的字库光盘。然后在你发行你精心制作的游戏时，可以顺便捎上这些后缀为<span lang=EN-US>.ttf</span>的文件就行了。包括<span lang=EN-US>Quake</span>这样的惊世之作，也都是用的<span lang=EN-US>TTF</span>字库。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>这样，我们就可以解决点阵汉字的一些问题。通过<span lang=EN-US>TTF</span>，我们在字体的质量和字库的数量上获得了暂时性的胜利。<span lang=EN-US><o:p></o:p></span></span></p><h3><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:major-latin>字库的读取和显示</span></h3><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>先前谈到点阵字库，只需要很简单的一些操作，就可以显示出想要的汉字。下面我给出一个读取<span lang=EN-US>hzk16</span>的函数，它需要一个<span lang=EN-US>Surface</span>以供显示用：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US>#include &lt;io.h></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US>#include &lt;stdio.h></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US>#include &lt;conio.h></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US>// </span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>读取</span><span lang=EN-US>16x16</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US>void DispHZ16(int x, int y, BYTE *Str, LPDIRECTDRAWSURFACE surf)</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US>{</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>const int Mask[] = { 0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01 };</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>FILE *HzkFp;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>WORD i, j, k=0, m;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>WORD HzNum;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>WORD QuHao;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>WORD WeiHao;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>long offset;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>BYTE dotBuffer[32];</span><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>HzkFp = fopen("HZK16", "rb");</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>HzNum = strlen((const char *)Str)/2;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>DDSURFACEDESC<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ddsd;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>LPWORD<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lpSurface;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>HRESULT<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ddrval;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;</span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>ddsd.dwSize = sizeof(ddsd);</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>while((ddrval=surf->Lock(NULL, &amp;ddsd, 0, NULL))==DDERR_WASSTILLDRAWING);</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>if(ddrval == DD_OK)</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>lpSurface = (LPWORD)ddsd.lpSurface;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>for(i = 0; i&lt;HzNum; i++)</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>{</span><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>QuHao = Str[i*2]-160;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>WeiHao = Str[i*2+1]-160;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>offset = ((QuHao - 1) * 94 + (WeiHao-1))*32;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>fseek(HzkFp, offset, SEEK_SET);</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>fread(dotBuffer, 32, 1, HzkFp);</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>for(j=0;j&lt;16;j++)</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>for(k=0;k&lt;2;k++)</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>for(m=0;m&lt;8;m++)</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>if(dotBuffer[j*2+k] & Mask[m])</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>{</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:6>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>lpSurface[ddsd.lPitch*(y+j+1) + x+k*8+m] = 0x000000;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>}</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>x+=16;</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>}</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>surf->Unlock(NULL);</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=mso-fareast-font-family:pmingliu><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=EN-US>fclose(HzkFp);</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US>}</span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>其实原理很简单：</span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l0 level1 lfo4;tab-stops:list 42pt"><span lang=EN-US style=mso-fareast-font-family:calibri;mso-fareast-theme-font:minor-latin;mso-bidi-font-family:calibri;mso-bidi-theme-font:minor-latin><span style=mso-list:ignore>1.<span style="font:7pt times new roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>打开字库</span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l0 level1 lfo4;tab-stops:list 42pt"><span lang=EN-US style=mso-fareast-font-family:calibri;mso-fareast-theme-font:minor-latin;mso-bidi-font-family:calibri;mso-bidi-theme-font:minor-latin><span style=mso-list:ignore>2.<span style="font:7pt times new roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>计算字符串长度（这个函数只支持中文），并且</span><span lang=EN-US>Lock Surface</span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l0 level1 lfo4;tab-stops:list 42pt"><span lang=EN-US style=mso-fareast-font-family:calibri;mso-fareast-theme-font:minor-latin;mso-bidi-font-family:calibri;mso-bidi-theme-font:minor-latin><span style=mso-list:ignore>3.<span style="font:7pt times new roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>依次计算出每个汉字所对应的区码和位码（汉字的第</span><span lang=EN-US>1</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>个字节是区码，第</span><span lang=EN-US>2</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>个字节就是位码），然后通过公式计算出这个汉字在字库中的偏移量：</span><span lang=EN-US><br>offset = ((QuHao - 1) * 94 + (WeiHao-1))*32;</span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l0 level1 lfo4;tab-stops:list 42pt"><span lang=EN-US style=mso-fareast-font-family:calibri;mso-fareast-theme-font:minor-latin;mso-bidi-font-family:calibri;mso-bidi-theme-font:minor-latin><span style=mso-list:ignore>4.<span style="font:7pt times new roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>读出一个</span><span lang=EN-US>32</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>个字节的点阵</span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l0 level1 lfo4;tab-stops:list 42pt"><span lang=EN-US style=mso-fareast-font-family:calibri;mso-fareast-theme-font:minor-latin;mso-bidi-font-family:calibri;mso-bidi-theme-font:minor-latin><span style=mso-list:ignore>5.<span style="font:7pt times new roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>绘制到</span><span lang=EN-US>Surface</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>上</span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>以上只是</span><span lang=EN-US>16</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>＊</span><span lang=EN-US>16</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>点阵字库的显示方法，</span><span lang=EN-US>24</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>＊</span><span lang=EN-US>24</span><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:minor-latin>的读取方法与之类似，大家可以参照相关资料来书写出自己的代码。</span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>如何显示<span lang=EN-US>TTF</span>字库呢，有很多种手段，下面我按从简单到复杂的的顺序依次介绍<span lang=EN-US>:<o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l2 level1 lfo2;tab-stops:list 42pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>1.<span style="font:7pt times new roman">&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>使用<span lang=EN-US>Windows API</span>，也就是大家所熟悉的<span lang=EN-US>TextOut</span>。通过它，还需要一个<span lang=EN-US>HDC</span>（设备句柄），我们就可以随意地在屏幕任何地方显示出文字了。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l2 level1 lfo2;tab-stops:list 42pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>2.<span style="font:7pt times new roman">&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>在<span lang=EN-US><a href=http://www.freetype.org/><span style=font-family:calibri,sans-serif;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin>http://www.freetype.org</span></a></span>，有一个<span lang=EN-US>FreeType</span>的免费库，而且是<span lang=EN-US>OpenSource</span>的。它目前有<span lang=EN-US>2</span>个版本：<span lang=EN-US>1.0</span>和<span lang=EN-US>2.0</span>。其区别在于，<span lang=EN-US>1.0</span>只能读取<span lang=EN-US>TTF</span>格式的，而<span lang=EN-US>2.0</span>支持更多的文件格式，在使用它之前请详细阅读所要遵循的<span lang=EN-US>Licence</span>，以下是摘自<span lang=EN-US>FreeType2.0</span>对字库的支持列表：<span lang=EN-US><o:p></o:p></span></span></p><ul type=disc><ul type=circle><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>TrueType fonts (and collections) <o:p></o:p></span><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>Type 1 fonts <o:p></o:p></span><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>CID-keyed Type 1 fonts <o:p></o:p></span><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>CFF fonts <o:p></o:p></span><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>OpenType fonts (both TrueType and CFF variants) <o:p></o:p></span><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>SFNT-based bitmap fonts <o:p></o:p></span><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>X11 PCF fonts <o:p></o:p></span><li class=MsoNormal style="text-justify:inter-ideograph;text-align:justify;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;mso-pagination:none;mso-list:l4 level2 lfo3;tab-stops:list 72pt"><span lang=EN-US style=font-size:10pt;font-family:verdana,sans-serif>Windows FNT fonts <o:p></o:p></span></li></ul></ul><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 42pt;text-indent:-21pt;text-align:justify;mso-pagination:none;mso-list:l2 level1 lfo2;tab-stops:list 42pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>3.<span style="font:7pt times new roman">&nbsp;&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>自己研究<span lang=EN-US>TTF</span>的格式，然后自己来操作。<span lang=EN-US><br></span>晕<span lang=EN-US><br>....... </span>╮╮<span lang=EN-US><br></span>　 　<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp; </span>\</span>█<span lang=EN-US>/</span>倒！<span lang=EN-US><br></span>　　　<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp; </span></span>●<span lang=EN-US><br></span>虽然我们想要把每一件事情都做好，但是也不是每一件事情都要亲历亲为。如果你非要这样，也行<span lang=EN-US>^____^</span>，但是过不了多久，你就会陷入泥沼，到时候你会发现自己的热情正在慢慢被磨灭，什么叫做抓狂，相信你很快就会知道<span lang=EN-US>^_^</span>。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=margin-left:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=margin-left:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>在有多种选择可以取舍的情况下，我们需要考虑一下，对比一下各种解决方法的优劣。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=margin-left:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>在<span lang=EN-US>DirectDraw</span>时代，我们都不自觉地喜欢上了<span lang=EN-US>GetDC</span>，因为……多方便啊。可是现在已经到了<span lang=EN-US>DirectX8.1</span>时代了（我要使劲地摇那些还沉醉于<span lang=EN-US>DirectX7</span>中，为如何在使用<span lang=EN-US>alpha</span>时提升那可怜的<span lang=EN-US>1</span>、<span lang=EN-US>2</span>个<span lang=EN-US>fps</span>的朋友们：醒醒，该起床了！），<span lang=EN-US>HDC</span>已经被<span lang=EN-US>M$</span>列为禁用品。怎么办呢？是的，你可能已经想到了，我们还一直保存着窗口的<span lang=EN-US>hWnd</span>呢，可以通过它来得到<span lang=EN-US>hdc</span>，从而调用那些需要<span lang=EN-US>hdc</span>的<span lang=EN-US>API</span>，可是，这样做是更为愚蠢的，这样对你是没有一点好处的，不信，你就试试吧。有一句话，请牢记：要想你的游戏有更快的速度的话，请不要再去碰<span lang=EN-US>HDC</span>了。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>我们非常清楚<span lang=EN-US>hdc</span>是一个超慢的解决办法，它无法在我们的高速游戏中满<span lang=EN-US>60</span>分及格。下面来看看<span lang=EN-US>FreeType</span>，它更像是一个<span lang=EN-US>Service</span>。它的解决方法是，先通过一系列的初始化和设置，告诉<span lang=EN-US>FreeType</span>字体的名字和大小等，然后它会动态地申请一个<span lang=EN-US>Graphic</span>，再把我们要显示的字画到这个<span lang=EN-US>Graphic</span>上，你还可以把它保存为<span lang=EN-US>tga</span>格式。不过我们最终所想要的不是这个，所以可能我们还需要从这个<span lang=EN-US>Graphic</span>上逐点读取或者用<span lang=EN-US>CopyRect</span>，然后再画到我们的画面上。其实它已经是很方便的了，可是需要你去学习如何配置和使用它，这是很花时间的一件事情，而且它最大的优点是可以跨平台，我们需要它吗？如果有一个更为简单的办法，像是如果<span lang=EN-US>Textout</span>不是那么慢的话，就好了……<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>在这里，顺便谈一下另<span lang=EN-US>2</span>个字体显示类：<span lang=EN-US>ID3DXFont</span>和<span lang=EN-US>CD3DFONT</span>。可能早就有人会说怎么在上面的列表中没有它们？原因我会在下面慢慢地说明：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>ID3DXFont</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>，它存在于<span lang=EN-US>D3DX</span>库中，一个现成的字体类，不过对于它的处理方法……我实在不敢恭维，就引用一位大师所说的话来表达我的看法吧<span lang=EN-US>:<b> </b></span><b>在内部实现中，<span lang=EN-US> ID3DXFont::DrawText()</span>函数确实做了我上面讨论的工作，先建立一张<span lang=EN-US>GDI</span>兼容的位图，把文本绘制到位图上，而后把位图拷贝到纹理贴图上去，最后把纹理渲染到屏幕上。这样你就聚齐了所有的龟速的原始<span lang=EN-US>GDI</span>函数，还包括了一大堆的额外开销 — 最终，这个函数比原来<span lang=EN-US>GDI</span>的<span lang=EN-US>DrawTextEx()</span>函数要慢上超过六倍……<span lang=EN-US><o:p></o:p></span></b></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CD3DFONT</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>，是由<span lang=EN-US>M$</span>在<span lang=EN-US>D3D</span>的框架代码中提供。不过它只能显示英文，有很多朋友通过自己定制和修改这个类，来实现自己的中文显示。不过效果都不是很好。其实原理，跟<span lang=EN-US>ID3DXFont</span>的方法差不多，不过处理方法要聪明了一点。<span lang=EN-US><o:p></o:p></span></span></p><h3><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:major-latin>分析与思考</span></h3><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>那么我们应该怎么办呢？通常我们会幻想，如果可以像处理英文那样，把所有的汉字都保存在一张位图里，该有多好。这样，显示的速度就不是问题了，直接可以<span lang=EN-US>CopyRect</span>上去。可是，这样可能吗？首先，必须每一种字体都要生成这样的一个巨型位图。而且据说在<span lang=EN-US>GB2312</span>中，一共有<span lang=EN-US>6000</span>多个汉字，就算是用<span lang=EN-US>16*16</span>，<span lang=EN-US>oh my god</span>，这个位图该有多大啊（据说会有<span lang=EN-US>2.5M^__^</span>）！！！而且在<span lang=EN-US>DirectX8.1</span>中，对于<span lang=EN-US>Texture</span>（显示的最小单位，就好象是原来<span lang=EN-US>DirectSurface</span>的概念一样。说过多少遍了，不要再用<span lang=EN-US>DirectX8</span>以前的东西了。不要试着去回忆那些美好的过去，我很明白，要你一下子放弃原来多年所获得的成就，是一件很痛苦的事情，但是包袱太重，是会影响进步的。就像是我们的国家……扯远了），不同的显卡，支持的最大容量也是不同的。比方说早期的<span lang=EN-US>Voodoo</span>，只支持<span lang=EN-US>256*256</span>大小的<span lang=EN-US>Texture</span>。而在我的显卡（<span lang=EN-US>Geforce2 MX 200</span>）上测试，支持最大<span lang=EN-US>2048*2048</span>大小的<span lang=EN-US>Texture</span>。对于这样的硬件不确定性，我们只能取其最小值，也就是<span lang=EN-US>256*256</span>。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>汉字虽然很多，但是常用的汉字，其实也就只有那么几百个。像这样的字：鬯、鞴，你一辈子会看到多少次呢？如果可以做一个类似于<span lang=EN-US>Cache</span>的东西，保存着常用的那些个汉字，在需要显示的的时候，先在<span lang=EN-US>Cache</span>中查找，如果有的话，就马上画上去；如果没有，就从字库中提取到<span lang=EN-US>Cache</span>中。这样的话，在使用<span lang=EN-US>Texture</span>来保存汉字的位图信息的同时，对于每个汉字，我们还要定义一个结构，然后用一个东西把它串起来，综合它们<span lang=EN-US>2</span>个，也就实现了我们所要的<span lang=EN-US>Cache</span>了。刚开始，我所定义的结构是这样的：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>struct Char{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>char hz[3];<span style=mso-spacerun:yes>&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>保存汉字<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>int frequency;// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>使用频率<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>RECT rect;<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>这个字对应位图的区域<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>Bool isUsing; // </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>是否使用<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>对于汉字和英文，我在这里大概地讲一下原理：汉字是由<span lang=EN-US>2</span>个字节保存，而英文只需要<span lang=EN-US>1</span>个。而判断一个字是否是汉字，只需判断第<span lang=EN-US>1</span>个<span lang=EN-US>byte</span>是否<span lang=EN-US>>128</span>（在原来的<span lang=EN-US>GB2312</span>中，汉字的<span lang=EN-US>2</span>个字节都是<span lang=EN-US>>128</span>的。而新的<span lang=EN-US>GBK</span>字库，汉字的第<span lang=EN-US>2</span>个字节不一定<span lang=EN-US>>128</span>，我想这是扩大了字库容量的原因。我的意思是说，如果给一个字符串你，随机给其中一个位置，然后我问你这个位置是什么？你的回答只能是：<span lang=EN-US>1 </span>英文<span lang=EN-US> 2 </span>汉字的首字节<span lang=EN-US> 3 </span>汉字的尾字节。而这个问题的解法，为了稳妥起见，你必须从字符串的开始判断起）。也就是说在<span lang=EN-US>char[3]</span>中，如果保存的是汉字，则<span lang=EN-US>char[0]</span>保存汉字第<span lang=EN-US>1</span>个字节，<span lang=EN-US>char[1]</span>保存汉字第<span lang=EN-US>2</span>个字节，第<span lang=EN-US>3</span>个存放<span lang=EN-US>’\0’</span>；如果是英文的话，则只用到<span lang=EN-US>char[0]</span>，其它的全部为<span lang=EN-US>’\0’</span>。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>接下来，对于使用<span lang=EN-US>char[3]</span>来保存汉字，是否真的很合适呢？因为如果把它当作一个字符串来看的话，在查找时就需要使用<span lang=EN-US> strcmp </span>来比较字符串了，这样一定是会影响速度的。如果不把它看作字符串（字符串的最后一个字节需要以<span lang=EN-US>’\0’</span>结尾），只用<span lang=EN-US>char[2]</span>的话，我们可以只是简单地调用宏<span lang=EN-US>MAKEWORD</span>，把<span lang=EN-US>2</span>个<span lang=EN-US>byte</span>压成<span lang=EN-US>1</span>个<span lang=EN-US>WORD</span>。当把文字作为一个<span lang=EN-US>WORD</span>来看的时候，这样查找比较时可以用<span lang=EN-US>WORD</span>内建的<span lang=EN-US>==</span>操作，这样要比调用<span lang=EN-US>strcmp</span>函数要快得多。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int frequency</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>用来标志每个<span lang=EN-US>WORD</span>的使用频率。设想，如果一个字已经存在于<span lang=EN-US>Cache</span>中，以后每对它调用一次，就让<span lang=EN-US>frequency++</span>。这样做还有一个用意是，是否可以在一个合适的时候，以<span lang=EN-US>frequency</span>为参照来对这整个<span lang=EN-US>Cache</span>排个序，把常用的字放在前面。那么在显示时，可以先在<span lang=EN-US>Cache</span>中查找所要显示的字是否已经存在于<span lang=EN-US>Cache</span>中，如果有则直接显示，没有的话才需要采取某种手段将字加入到<span lang=EN-US>Cache</span>中。一些常用的字（像：我、的、着、了、过……），使得显示的速度将会大大提高。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>其实上面说了半天的<span lang=EN-US>Cache</span>，它具体是什么呢？其实就是指的最小绘制单位，在<span lang=EN-US>DirectX7</span>里是<span lang=EN-US>Surface</span>，而在<span lang=EN-US>DirectX8</span>中就是<span lang=EN-US>Texture</span>。使用它来存放显示过的汉字，这样，就不用每次都从字库中读取或是调用如<span lang=EN-US>TextOut</span>这类<span lang=EN-US>GDI</span>超慢的函数了。因为每次在绘制一个文字之前，都会先在这个<span lang=EN-US>Cache</span>中找，有的话就直接画上去，没有才会调用<span lang=EN-US>TextOut</span>操作。而这样做的原因，我们先设想一下：游戏一般会控制为<span lang=EN-US>30fps</span>或是<span lang=EN-US>60fps</span>的速度不停地刷新，如果在<span lang=EN-US>GameLoop</span>中有任何的代码是<b>龟速级</b>的话，这样就会导致<span lang=EN-US>fps</span>的最大数的降低，也就意味着在保证<span lang=EN-US>30fps</span>或<span lang=EN-US>60fps</span>的同时，能绘制到屏幕上的物体的数量减少了。这就是我们为什么要使用<span lang=EN-US>Texture</span>来作为<span lang=EN-US>Cache</span>的实现的原因。再一个，文字在屏幕上显示时一般会保持一段时间，这个时间可能是<span lang=EN-US>1</span>秒<span lang=EN-US>-3</span>秒，我们的游戏也就会相应地更新<span lang=EN-US>60fps</span>或<span lang=EN-US>180fps</span>，这是因为人们需要阅读它们。或者是一些如标题这样的文字，它们总是不会更新的，或是更新得很慢。我们完全可以在第一时间，比方说我们的画面有<span lang=EN-US>60fps</span>，在第<span lang=EN-US>1</span>个<span lang=EN-US>fps</span>时，我们得知要显示文字<span lang=EN-US>”</span>唐<span lang=EN-US>”</span>，然后先在<span lang=EN-US>Cache</span>中找，结果很糟：没有找到！这时马上用<span lang=EN-US>TextOut</span>写到<span lang=EN-US>Texture</span>上（现在还是属于第<span lang=EN-US>1</span>个<span lang=EN-US>fps</span>的时间范围内），而接下来的<span lang=EN-US>59</span>个<span lang=EN-US>fps</span>（甚至更多），都不用再调<span lang=EN-US>TextOut</span>了，而是直接从我们的<span lang=EN-US>Cache</span>：<span lang=EN-US>Texture</span>上<span lang=EN-US>Copy</span>到屏幕上，速度得到了保障。谈到<span lang=EN-US>GDI</span>的函数，为了实现设备无关性，它们的速度都很慢。其实它们也不像说得那么慢，如果不是每一帧都要调用它们，也算是蛮快的<span lang=EN-US>^_^</span>。那么这个<span lang=EN-US>RECT rect</span>，就代表着这个文字所对应在<span lang=EN-US>Texture</span>上的区域位置。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>使用什么东西来把这<span lang=EN-US>n</span>个<span lang=EN-US>Char</span>串起来呢，一般会想到的是链表，原因无非有<span lang=EN-US>2</span>个：<span lang=EN-US>1 </span>随时有新的字加进来，而内存是不连续的<span lang=EN-US> 2 </span>它几乎没有容量的限制（除非是内存用完了）。不过链表的访问速度是很慢的，如果使用像数组这样的东西就好了。仔细想想，在这里，我们用来存储的<span lang=EN-US>Cache</span>，最大也就是<span lang=EN-US>256*256</span>（理由上面说了），所以大小应该会是固定的。我们只需要在数组中的给每一个汉字加上一个标志，说明这个位置的使用情况。那么就使用数组吧，这样的话，访问的速度要更快一些，直接首地址<span lang=EN-US>+</span>偏移量就够了，不必像链表，在查找时需要逐<span lang=EN-US>node</span>访问。当然，我绝不会想到用<span lang=EN-US>new<span style=mso-spacerun:yes>&nbsp; </span>Char</span>来申请这个数组。因为这样做实在没有必要，请不要过于迷信自己的能力，在<span lang=EN-US>STL</span>中已经有<span lang=EN-US>vector</span>了，为什么还要自己写呢？<span lang=EN-US>^_^</span>最后的一个<span lang=EN-US>bool</span>成员变量<span lang=EN-US>isUsing</span>，也就是上面所说，用来标志使用情况的。<span lang=EN-US><o:p></o:p></span></span></p><h3><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:major-latin>实际的操作</span></h3><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>上面考虑了那么多，我认为都是实际操作之前所应该有的。先谈谈如何显示吧，因为在<span lang=EN-US>DirectX8.1</span>中已经将<span lang=EN-US>DirectDraw</span>和<span lang=EN-US>Direct3D</span>融合为<span lang=EN-US>DirectGraphics</span>了。所以无法像原来那样了…………哦，实在有太多东西要讲了，我还是推荐几篇文章给你吧<span lang=EN-US>^_^</span>：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><a href=http://vip.6to23.com/mays/develop/directx/200201/Geczy3Din2D.htm><span style=font-family:calibri,sans-serif;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin>http://vip.6to23.com/mays/develop/directx/200201/Geczy3Din2D.htm</span></a><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><a href=http://vip.6to23.com/mays/develop/directx/200201/GESurface.htm><span style=font-family:calibri,sans-serif;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin>http://vip.6to23.com/mays/develop/directx/200201/GESurface.htm</span></a><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><a href=http://vip.6to23.com/mays/develop/directx/200112/2DGtoDX8.htm><span style=font-family:calibri,sans-serif;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin>http://vip.6to23.com/mays/develop/directx/200112/2DGtoDX8.htm</span></a><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><a href=http://vip.6to23.com/mays/develop/directx/200201/DX8adv2D.htm><span style=font-family:calibri,sans-serif;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin>http://vip.6to23.com/mays/develop/directx/200201/DX8adv2D.htm</span></a><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>接下来，我会假设你已经具备了在<span lang=EN-US>DirectX8.1</span>中绘图的基本概念了，所以在你继续往下阅读之前，请务必先仔细阅读以上推荐的文章。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>前面提到，需要一个<span lang=EN-US>vector</span>来对应<span lang=EN-US>Texture</span>上各个位置文字的信息，上面已经创建了一个结构<span lang=EN-US>Char</span>，则这个<span lang=EN-US>vector</span>的定义为：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>vector &lt;Char> _vBuf;<span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>记录缓冲中现有的文字情况<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>首先，由于可以利用硬件的放大缩小机能，所以字体的大小精度要求不是很高，只需要支持<span lang=EN-US>16*16</span>和<span lang=EN-US>24*24</span>大小的字体就可以了。我们需要一个这样的初始化函数：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>bool CFont:: <o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>/*-------------------------------------------------------------<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>LPDIRECT3DDEVICE8 pd3dDevice<span style=mso-spacerun:yes>&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span>D3DDevice</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>设备<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>char szFontName[]<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>字体名<span lang=EN-US>(</span>如<span lang=EN-US>: </span>宋体<span lang=EN-US>)<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int nSize<span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>字体大小<span lang=EN-US>, </span>只支持<span lang=EN-US>16</span>和<span lang=EN-US>24<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int nLevel<span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>纹理的大小级别<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>-------------------------------------------------------------*/<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>Init( LPDIRECT3DDEVICE8 pd3dDevice, char szFontName[], int nSize, int nLevel )</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>在<span lang=EN-US>DirectX8.1</span>中，由<span lang=EN-US>SetTexture(…)</span>所贴的图的大小，也就是<span lang=EN-US>Texture</span>的大小，是有大小限制的，长和宽都必须是<span lang=EN-US>2^n</span>，而且位图越大，所花费的显存越大，这样留给其他显示用的显存就少了。所以，必须根据需求的不同，来自定<span lang=EN-US>Texture(</span>也就是<span lang=EN-US>Cache)</span>的大小。因为汉字点阵大小的原因，所以从实用角度而言（比方说只是显示<span lang=EN-US>fps</span>或是短小的标题），开辟一个<span lang=EN-US>64*64</span>大小的<span lang=EN-US>Texture</span>，才能满足最低情况下的需要（这时如果选择<span lang=EN-US>16</span>点阵的话可以存放<span lang=EN-US>16</span>个汉字，<span lang=EN-US>24</span>点阵可以存放<span lang=EN-US>7</span>个，依次类推……）。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>根据设置，创建<span lang=EN-US>Texture</span>：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_TextureSize = 32 &lt;&lt; nLevel;<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>纹理大小<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_TextSize<span style=mso-tab-count:1>&nbsp; </span>= nSize;<span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>文字大小<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_TextureSize = 32 &lt;&lt; nLevel;<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>纹理大小<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_RowNum = _TextureSize / _TextSize;<span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>计算一行可以容纳多少个文字<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_Max = _RowNum * _RowNum;<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>计算缓冲最大值<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>创建字体，还是需要使用<span lang=EN-US>Win32 API</span>。也就是先创建一个<span lang=EN-US>HDC</span>：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_hDc = CreateCompatibleDC(NULL);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>然后创建一个<span lang=EN-US>BITMAP</span>和一个<span lang=EN-US>FONT</span>，将它们与<span lang=EN-US>HDC</span>关联起来。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LOGFONT LogFont;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>ZeroMemory( &amp;LogFont, sizeof(LogFont) );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfHeight<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= -_TextSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfWidth<span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfEscapement<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfOrientation<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfWeight<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= FW_BOLD;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfItalic<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= FALSE;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfUnderline<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= FALSE;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfStrikeOut<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= FALSE;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfCharSet<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= DEFAULT_CHARSET;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfOutPrecision<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= OUT_DEFAULT_PRECIS; <o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfClipPrecision<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp; </span>= CLIP_DEFAULT_PRECIS; <o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfQuality<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= DEFAULT_QUALITY;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>LogFont.lfPitchAndFamily<span style=mso-tab-count:1> </span>= DEFAULT_PITCH;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>lstrcpy( LogFont.lfFaceName, szFontName );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_hFont = CreateFontIndirect( &amp;LogFont );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>if ( NULL == _hFont )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteDC( _hDc );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return false;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（只需要创建一个字体大小的<span lang=EN-US>BITMAP</span>即可）<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>BITMAPINFO bmi;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>ZeroMemory(&amp;bmi.bmiHeader, sizeof(BITMAPINFOHEADER));<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>bmi.bmiHeader.biSize<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp; </span>= sizeof(BITMAPINFOHEADER);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>bmi.bmiHeader.biWidth<span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>= _TextSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>bmi.bmiHeader.biHeight<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= -_TextSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>bmi.bmiHeader.biPlanes<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 1;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>bmi.bmiHeader.biBitCount<span style=mso-tab-count:1> </span>= 32;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>bmi.bmiHeader.biCompression = BI_RGB;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（这里需要定义一个指针指向位图的数据：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>DWORD *<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_pBits;<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>位图的数据指针）<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_hBmp = CreateDIBSection( _hDc, &amp;bmi, DIB_RGB_COLORS,<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(void **) &_pBits, NULL, 0 );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>if ( NULL == _hBmp || NULL == _pBits )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteObject( _hFont );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteDC( _hDc );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return false;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>将<span lang=EN-US>hBmp</span>和<span lang=EN-US>hFont</span>加入到<span lang=EN-US>hDc<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>SelectObject( _hDc, _hBmp );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>SelectObject( _hDc, _hFont );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>接着设置背景色和文字色：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>SetTextColor( _hDc, RGB(255,255,255) );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>SetBkColor( _hDc, 0 );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>设置文字为上对齐：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>SetTextAlign( _hDc, TA_TOP );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>创建<span lang=EN-US>Texture</span>所需要的顶点缓冲：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>if ( FAILED( _pd3dDevice->CreateVertexBuffer( _Max * 6 * sizeof(FONT2DVERTEX),<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>D3DUSAGE_WRITEONLY | D3DUSAGE_DYNAMIC, 0,<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>D3DPOOL_DEFAULT, &_pVB ) ) )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteObject( _hFont );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteObject( _hBmp );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteDC( _hDc );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return false;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>创建<span lang=EN-US>Texture<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>if ( FAILED( _pd3dDevice->CreateTexture( _TextureSize, _TextureSize, 1, 0, <o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>D3DFMT_A4R4G4B4, D3DPOOL_MANAGED, &_pTexture ) ) )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>DeleteObject( _hFont );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteObject( _hBmp );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DeleteDC( _hDc );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SAFE_RELEASE(_pVB);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp;</span><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return false;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>设置渲染设备的渲染属性：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetRenderState( D3DRS_ALPHABLENDENABLE,<span style=mso-spacerun:yes>&nbsp;&nbsp; </span>TRUE );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetRenderState( D3DRS_SRCBLEND,<span style=mso-spacerun:yes>&nbsp; </span>D3DBLEND_SRCALPHA );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetRenderState( D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetRenderState( D3DRS_ALPHATESTENABLE,<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp; </span>TRUE );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetRenderState( D3DRS_ALPHAREF,<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x08 );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetRenderState( D3DRS_ALPHAFUNC,<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>D3DCMP_GREATEREQUAL );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetTextureStageState( 0, D3DTSS_ALPHAOP,<span style=mso-tab-count:1>&nbsp;&nbsp; </span>D3DTOP_MODULATE );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetTexture( 0, _pTexture );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetVertexShader( D3DFVF_FONT2DVERTEX );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_pd3dDevice->SetStreamSource( 0, _pVB, sizeof(FONT2DVERTEX) );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>设置缓冲的最大容量<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>_vBuf.resize( _Max );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>这样，初始化完成了。接下来是如何把一个汉字写到<span lang=EN-US>Texture</span>中，以及如何进行管理。定义函数：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>得到文字在纹理中的位置<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>void CFont::<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>/*-------------------------------------------------------------<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>char c1<span style=mso-spacerun:yes>&nbsp;&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>文字的第<span lang=EN-US>1</span>个字节<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>char c2<span style=mso-spacerun:yes>&nbsp;&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>文字的第<span lang=EN-US>2</span>个字节<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int & tX<span style=mso-spacerun:yes>&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>写入纹理中的坐标<span lang=EN-US>x<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int & tY<span style=mso-spacerun:yes>&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>写入纹理中的坐标<span lang=EN-US>y<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>-------------------------------------------------------------*/<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>Char2Texture( char c1, char c2, int & tX, int & tY )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>WORD w = MAKEWORD(c1, c2);<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>把此字变为<span lang=EN-US>WORD<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>vector&lt;Char>::iterator it = find( _vBuf.begin(), _vBuf.end(), w );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>if ( it == _vBuf.end() )<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>如果没找到<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>it = find( _vBuf.begin(), _vBuf.end(), 0 ); // </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>查找空闲位置<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if ( it == _vBuf.end() )<span style=mso-tab-count:1> </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>缓冲已满<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for(; it!=_vBuf.begin(); it-- )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>it->hz = 0;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>//<span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Log.Output( "</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>字体缓冲已满<span lang=EN-US>, </span>清空<span lang=EN-US>!" );<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>计算当前空闲的<span lang=EN-US>Char</span>在缓冲中是第几个<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int at = it-_vBuf.begin();<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>得到空闲位置的坐标<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tX = (at % _RowNum) * _TextSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tY = (at / _RowNum) * _TextSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>设置这个<span lang=EN-US>Char</span>为使用中<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(*it).hz = w;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RECT rect = {0, 0, _TextSize, _TextSize};<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>char sz[3] = {c1, c2, '\0'};<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>填充背景为黑色<span lang=EN-US>(</span>透明色<span lang=EN-US>)<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FillRect( _hDc, &amp;rect, (HBRUSH)GetStockObject(BLACK_BRUSH) );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>往<span lang=EN-US>hBitmap</span>上写字<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::TextOut( _hDc, 0, 0, sz, c1 & 0x80 ? 2 : 1 );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>锁定表面<span lang=EN-US>, </span>把汉字写入纹理<span lang=EN-US>, </span>白色的是字<span lang=EN-US>(</span>可见<span lang=EN-US>), </span>黑色为背景<span lang=EN-US>(</span>透明<span lang=EN-US>)<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>D3DLOCKED_RECT d3dlr;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_pTexture->LockRect(0, &amp;d3dlr, NULL, D3DLOCK_NOSYSLOCK);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BYTE * pDstRow = (BYTE*)( (WORD *)d3dlr.pBits + tY * _TextureSize + tX );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for (DWORD y=0; y&lt;_TextSize; y++)<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WORD * pDst16 = (WORD*)pDstRow;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for (DWORD x=0; x&lt;_TextSize; x++)<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BYTE bAlpha = (BYTE)((_pBits[_TextSize * y + x] & 0xff) >> 4);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (bAlpha > 0)<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pDst16++ = (bAlpha &lt;&lt; 12) | 0x0fff;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pDst16++ = 0x0000;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pDstRow += d3dlr.Pitch;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_pTexture->UnlockRect( NULL );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>else<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>计算当前空闲的<span lang=EN-US>Char</span>在缓冲中是第几个<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int at = it-_vBuf.begin();<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>得到这个字的坐标<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tX = (at % _RowNum) * _TextSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tY = (at / _RowNum) * _TextSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>以上代码中的注释已经很清楚了，相信无须我多言。这里唯一需要声明的是：原来所定义的<span lang=EN-US>Char</span>结构是这样的<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>struct Char{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>char hz[3];<span style=mso-spacerun:yes>&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>保存汉字<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>int frequency;// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>使用频率<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>RECT rect;<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>这个字对应位图的区域<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-spacerun:yes>&nbsp; </span>Bool isUsing; // </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>是否使用<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>后来因为将<span lang=EN-US>char hz[3]</span>合成为<span lang=EN-US>WORD</span>，所以改为<span lang=EN-US>WORD hz</span>。然后对于<span lang=EN-US>int frequency</span>，这个词频应该如何表现，我一直没有想到很好的方法。<span lang=EN-US>frequency</span>应该在何时<span lang=EN-US>++</span>呢？是在每次被使用的时候吗？但是这样的话，上面说过，游戏是以<span lang=EN-US>60fps</span>的速度在刷新，如果停上<span lang=EN-US>1</span>分钟的话，变量很快就会溢出了。就算是使用像是<span lang=EN-US>DWORD</span>或<span lang=EN-US>__int64</span>这样的巨型变量保存，也是不安全的。除非能在某个合适的时候将<span lang=EN-US>frequency</span>清零，但是这个“时候”是什么时候呢？或者设置一个最大值，如<span lang=EN-US>65535</span>，但是这样也基本上没什么用途，很快，所有在<span lang=EN-US>vector</span>中的<span lang=EN-US>Char</span>中的<span lang=EN-US>frequency</span>都会<span lang=EN-US>++</span>成<span lang=EN-US>65535</span>的。回忆一下最初，是因为想把常用字放到<span lang=EN-US>vector</span>的前面，以便每次<span lang=EN-US>find</span>操作可以最快返回结果的。而经过我的测试，即使不做这样的优化操作，速度也是很快的，毕竟<span lang=EN-US>Cache</span>不是很大，加上<span lang=EN-US>vector</span>是连续内存空间。所以可以放弃使用<span lang=EN-US>int frequency</span>。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>然后对于<span lang=EN-US>RECT rect</span>，因为没有了<span lang=EN-US>int frequency</span>，意味着一旦将汉字写入到<span lang=EN-US>Texture</span>，其位置就不会变动了。所以，很容易根据<span lang=EN-US>find</span>函数操作后的<span lang=EN-US>iterator</span>，直接计算出这个汉字所在<span lang=EN-US>Texture</span>的位置。这样，<span lang=EN-US>RECT rect</span>也不再必须。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>而<span lang=EN-US>bool isUsing</span>，它本身就是个鸡肋，要也可以，这样结构更加清晰。不过，直接通过观察<span lang=EN-US>WORD hz</span>为<span lang=EN-US>0</span>或非<span lang=EN-US>0</span>，即可实现<span lang=EN-US>isUsing</span>的作用了。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>为什么要对结构<span lang=EN-US>Char</span>这么精雕细琢呢？<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l3 level1 lfo5;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>1.<span style="font:7pt times new roman">&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>既然没有必要的东西，就应该删除<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l3 level1 lfo5;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>2.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>Char</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>结构的大小越大，<span lang=EN-US>vector</span>所要求的内存越大<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l3 level1 lfo5;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>3.<span style="font:7pt times new roman">&nbsp; </span></span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>小的结构，<span lang=EN-US>find</span>可以更快地查找出所结果<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>为什么<span lang=EN-US>find</span>会正常工作呢？这里我要大概地讲一下<span lang=EN-US>find</span>是如何查找出所需的位置的：它只是简单地使用<span lang=EN-US>while</span>从<span lang=EN-US>vector</span>的<span lang=EN-US>begin</span>一直遍历到<span lang=EN-US>end</span>，逐个判断，直到找到为止。<span lang=EN-US>find</span>要求必须实现自己的<span lang=EN-US>operator ==()</span>，进一步跟踪到<span lang=EN-US>find</span>的源码中，发现也是这样。于是前面的结构<span lang=EN-US>Char</span>变成了现在这样：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>struct Char{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WORD<span style=mso-tab-count:1>&nbsp;&nbsp; </span>hz;<span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>文字<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Char() : hz(0) {}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>用作查找文字<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inline bool operator == ( WORD h ) const<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return hz==h ? true : false;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>};<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>是不是很简单？<span lang=EN-US>^___^<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>终于到了显示的函数了：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>得到文字在纹理中的位置<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>bool CFont::<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>/*-------------------------------------------------------------<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>char szText[]<span style=mso-spacerun:yes>&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>显示的字符串<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int x<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>屏幕坐标<span lang=EN-US>x<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int y<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>屏幕坐标<span lang=EN-US>y<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>D3DCOLOR<span style=mso-tab-count:1>&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>颜色及<span lang=EN-US>alpha</span>值<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>int nLen<span style=mso-tab-count:1>&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>字符串长度<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>float fScale<span style=mso-spacerun:yes>&nbsp;&nbsp; </span>---<span style=mso-spacerun:yes>&nbsp; </span></span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>放大比例<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>-------------------------------------------------------------*/<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>TextOut( char szText[], int x, int y, D3DCOLOR color, int nLen, float fScale )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>Assert( szText!=NULL );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>float sx = x, sy = y,<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp; </span>offset=0, w=0, h=0, tx1=0, ty1=0, tx2=0, ty2=0;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>w = h = (float)_TextSize * fScale;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>char ch[3] = {0,0,0};<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>FONT2DVERTEX * pVertices = NULL;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>UINT wNumTriangles = 0;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>_pVB->Lock(0, 0, (BYTE**)&amp;pVertices, D3DLOCK_DISCARD);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>if ( -1 == nLen ||<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>默认值<span lang=EN-US>-1<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;</span>nLen > lstrlen( szText ) ) // </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>如果<span lang=EN-US>nLen</span>大于字符串实际长度<span lang=EN-US>, </span>则<span lang=EN-US>nLen=</span>实际长度<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>nLen = lstrlen( szText );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>for (int n=0; n&lt;nLen; n++ )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ch[0] = szText[n];<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if ( ch[0]=='\n' )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sy+=h;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sx=x;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>continue;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if ( ch[0] & 0x80 )<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>n++;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ch[1] = szText[n];<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>offset = w;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ch[1] = '\0';<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>offset = w / 2 ;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int a, b;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Char2Texture( ch[0], ch[1], a, b );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span><o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>计算纹理左上角<span lang=EN-US> 0.0-1.0<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tx1 = (float)(a) / _TextureSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>ty1 = (float)(b) / _TextureSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>计算纹理右上角<span lang=EN-US> 0.0-1.0<o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tx2 = tx1 + (float)_TextSize / _TextureSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>ty2 = ty1 + (float)_TextSize / _TextureSize;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>填充顶点缓冲区<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pVertices++ = FONT2DVERTEX(sx,<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp; </span>sy + h, 0.9f, color, tx1, ty2);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pVertices++ = FONT2DVERTEX(sx,<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp; </span>sy,<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp; </span>0.9f, color, tx1, ty1);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pVertices++ = FONT2DVERTEX(sx + w, sy + h, 0.9f, color, tx2, ty2);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pVertices++ = FONT2DVERTEX(sx + w, sy,<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0.9f, color, tx2, ty1);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pVertices++ = FONT2DVERTEX(sx + w, sy + h,<span style=mso-tab-count:1>&nbsp;&nbsp; </span>0.9f, color, tx2, ty2);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*pVertices++ = FONT2DVERTEX(sx,<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp; </span>sy,<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp; </span>0.9f, color, tx1, ty1);<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp; </span>wNumTriangles+=2;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sx+=offset;<span style=mso-tab-count:1>&nbsp;&nbsp; </span>// </span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>坐标<span lang=EN-US>x</span>增量<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>}<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>_pVB->Unlock();<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>_pd3dDevice->DrawPrimitive( D3DPT_TRIANGLELIST, 0, wNumTriangles );<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><span style=mso-tab-count:1>&nbsp;&nbsp; </span>return true;<o:p></o:p></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>}<o:p></o:p></span></p><h3><span style=font-family:宋体;mso-ascii-font-family:calibri;mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:calibri;mso-hansi-theme-font:major-latin>结束语</span></h3><p class=MsoNormal style=text-indent:21pt><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>记得有一句名言：<span lang=EN-US> Keep it simple and stupid.</span>在实现功能的同时，保持代码简单、清晰是非常重要的一件事。相信在往后的日子里，在不论是别人阅读或是你自己回顾的时候，你都会发现一如既往地遵守这个守则，是多么得重要！<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>相信通过上面我那无数的废话，加上代码中还算足够的注释，聪明的你一定能够明白这其中的原理了吧。如果以上的内容还不足以让你完全搞清楚的话，你可以登录我的主页：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22.1pt;text-align:center;mso-char-indent-count:2 align=center><b><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast><a href=http://www.tlovexyj.com/><span lang=EN-US><span lang=EN-US>炎龙工作室</span></span></a><o:p></o:p></span></b></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>上面不仅包括了上面所写的程序代码，还有一个用来演示效果的一个很简单的<span lang=EN-US>demo</span>。<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>说明，以上所实现的<span lang=EN-US>CFont</span>是包含在我的游戏引擎中的一个部件，而目前已经实现的部件包括有：<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>1.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CGameFrame</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（游戏框架类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span></span>封装了窗口及<span lang=EN-US>D3D</span>设备的建立，需要派生出自己的子类<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>2.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CAudio</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>和<span lang=EN-US>CSound</span>（声音类）<span lang=EN-US> -----<span style=mso-spacerun:yes>&nbsp; </span></span>支持<span lang=EN-US>wav/mid/mp3</span>的播放<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>3.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CDirectInput</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（控制类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span></span>键盘、鼠标操作<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>4.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CDirectShow</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（视频类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span></span>支持<span lang=EN-US>avi/mpg/mov</span>等的播放<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>5.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CSpriteX</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（精灵类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span></span>方便游戏中对精灵的控制<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>6.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CFont</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（字体类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span></span>中英文字体的显示<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>7.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>CTimer</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（时间类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span></span>高精度时间的控制<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>8.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>FPS</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（<span lang=EN-US>fps </span>类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span>fps</span>的计算<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style="text-justify:inter-ideograph;margin:0 0 0 39pt;text-indent:-18pt;text-align:justify;mso-pagination:none;mso-list:l1 level1 lfo6;tab-stops:list 39pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:ignore>9.<span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>LOG</span><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>（日志类）<span lang=EN-US><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-----<span style=mso-spacerun:yes>&nbsp; </span></span>游戏中的错误反应以及状态记录<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal style=text-indent:22pt;mso-char-indent-count:2><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>最重要的是，这个<span lang=EN-US>Game Engine</span>完全是开放源代码的。关于更新的情况、版本说明以及源码下载，请随时关注我的主页！<span lang=EN-US><o:p></o:p></span></span></p><p class=MsoNormal><span style=font-family:宋体;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast>接下来，我将会继续完善这个<span lang=EN-US>Engine</span>，可能加入的有：高效粒子系统、斜<span lang=EN-US>45</span>度角地图……</span></p></div><footer class=post-footer><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
游戏中汉字显示的实现与技巧[ZZ]</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/chinese-character-display-in-games/ title=游戏中汉字显示的实现与技巧[ZZ]>https://blogs.qipai360.cn/post/chinese-character-display-in-games/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/command-pattern-member-function-implementation/ rel=next title=关于成员函数的Command模式的简单实现><i class="fa fa-chevron-left"></i> 关于成员函数的Command模式的简单实现</a></div><div class="post-nav-prev post-nav-item"><a href=/post/fa-ru-xue-programmer-version/ rel=prev title=《发如雪》之程序员版>《发如雪》之程序员版
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.152.2 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"chinese-character-display-in-games","permalink":"https://blogs.qipai360.cn/post/chinese-character-display-in-games/","title":"游戏中汉字显示的实现与技巧[ZZ]","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1761990624" defer></script></body></html>