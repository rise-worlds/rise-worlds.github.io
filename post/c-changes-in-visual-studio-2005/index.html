<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.157.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Visual Studio 2005中C++的变化"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Rise,ZhangTuohui,技术,C++,Unity3D,Lua,NodeJS,C#,JavaScript,游戏开发,机器学习,深度学习,AI,编程,编程语言,编程技术,编程开发,游戏引擎,游戏设计,游戏制作,游戏开发者,游戏开发者博客,游戏开发者网站,游戏开发者工具,游戏开发者教程,游戏开发者学习,游戏开发者交流,游戏开发者分享,游戏开发者经验,游戏开发者心得,游戏开发者技巧,游戏开发者方法,游戏开发者思路,游戏开发者理念,游戏开发者文化,游戏开发者精神,游戏开发者信仰"><meta property="og:type" content="article"><meta property="og:title" content="Visual Studio 2005中C++的变化"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/c-changes-in-visual-studio-2005/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2004-11-02 15:18:00 +0800 +0800"><meta property="article:modified_time" content="2004-11-09 16:59:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1772265588"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>Visual Studio 2005中C++的变化 - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>679</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>679</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>35</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>118</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2423147></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5207></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2026-02-28 15:59:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/c-changes-in-visual-studio-2005/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Visual Studio 2005中C++的变化"><meta itemprop=description content='下一代visual studio版本（以前whidbey,现在是visual studio 2005）提供更加丰富的改进的库文件和没有很多幕后精简和加速的压力，它的大量配合的工具和新的功能将使开发者的开发过程变得简单有趣，对我而言，这些与visual studio 2005对C++的处理相比就显得有些苍白，这里我主要谈谈在下一代visual studio中C++的变化.跟下划线拜拜在visual studio.NET中引入了对C++扩展名的处理，扩展名是以两个下划线开始的关键字，比如__gc和__property.自从上个版本发布以来，我已经写了大量的双下划线特征的代码，我坦白也不喜欢这样，我了解具体的原因是：带两个下划线的关键字作为特殊的扩展名使它们不会跟标准编译器相混淆，你可以全面的管理扩展名可以用其他的编译器来编译，它忽视__关键字。这是一种解决方法：微软发现了一种方法不改变编程语言的改变，但是会出现下面一些结果：·开发者发现语法不自然·不能被完全的采用如例，适当的C++处理方法：public __gc class Foo{// hundreds of lines of code__property String* get_Text();// hundreds of lines of code__property void set_Text(String*);// hundreds of lines of code};&#160; 　　有良好习惯的程序员把get和put放在每个扩展名的右面，把潜在的变量放在旁边，但是编程语言没要求你这样做。它提供无环境支持定界结构让你明白作为一个单元是正确的，所以它是不自然的跟其它visual studio .NET语言不一样。但是你如何去处理这个问题那，唯一的方式完成C++转换成CLR反之就要改变C++.假如你想那样做，你可以有足够的自由得到自然一流的语言会给你最好的，你可以取消大量的带双划线的关键字。 生存时间和范围　　我喜欢确定的解析，实际上我也喜欢碎片收集，我还能举出更多的，它们有自己的作用而且我也需要它们，假如我只在内存中构造一个对象，我希望在我自己清除它前不被清除，　　所以内存管理是很复杂的。但是，如果你的对象包含一个非管理的源文件如数据库链接，一个开放文件，或者类似我要取得一个控制。我想知道它要尽快的离开，用这种模式去处理，但是它不是直接的，简单的亲密支持是最好的办法。　　下面是在原始的C++中，你去完成这些事情：
<TABLE width="90%" bgcolor="#ffffff" border="0">

<TBODY>

<TR>

    <TD>//this is a code fragment<br/>{<br/>try<br/>{<br/>Foo* f=new Foo(/* params */);<br/>//all kinds of code, some of which might throw exceptions<br/>delete f;<br/>}<br/><br/>catch (/* something */)<br/>{<br/>delete f;<br/>//whatever else, or rethrow;<br/>}<br/>} 

    </TD>

</TR>

</TBODY>

</TABLE><br/>　　如果你在堆栈建立对象，生命期是简单的<br/><br/>

<TABLE width="90%" bgcolor="#ffffff" border="0">

<TBODY>

<TR>

    <TD>//this is a code fragment<br/>{<br/>　Foo f;<br/>　//all kinds of code, some of which might throw exceptions<br/>} 

    </TD>

</TR>

</TBODY>

</TABLE><br/>　　当f超过范围，不论是否是意外它将被清除这是自然的。<br/><br/>　　当对象在管理堆里时，你不能把它删除，它将被碎片收集清除，如果你想清除管理着源文件的对象，你可以调用dispose()函数，虽然C#为它提供了的有效的结构，但是它仍然不象堆栈那样简单。<br/><br/>　　在新一代的语言(以前是C++/CLI),你在哪里建立对象不依赖于你建立对象的种类，你可以堆栈中管理对象，它有确定的解析，但它越界时将被清除，如果你愿意你可以在管理堆里建立对象。<br/><br/>　　这种变化带来其它的结果，其中最深远的是你可以把不同的对象放在摸板中或者可以把它看成其它类的成员变量，你可以得到完整的C++生存时间周期，而不是仅仅是把它分配到相应的堆，然后等碎片收集来处理它。<br/><br/>　　解析和定稿<br/><br/>　　当你为其它语言写了碎片收集对象是，你是否为它写了解析函数？当你使用C++,你可以在堆栈构造对象，解析函数将运行当它越界时，什么事情会发生当其他C#或VB程序调用这个对象，运行时仅从简单的方式去处理，它是用dispose()来解析，任何一个C++/CLI对象都有一个可以任意调用的解析函数。<br/><br/>　　假如你在C#或VB中有dispose()的类，你可能已经写了一个定论，C++/CLI也有简便的语法为定论，就象Foo的解析是~Foo,Foo的定论是!Foo(~是比特的not,!是逻辑的not,它们都是提醒是和构造函数对立的),<br/><br/>　　Finalizer将运行当在管理堆中建立而不被调用，确信它所包含的非管理源文件被清除，即使其他调用函数忘了去解析。<br/><br/>　　指针和句柄<br/><br/>　　在C++扩展名管理中，C++的主要限制没有变化，同样的符号和语法用做完全的事情，*的含义依赖于你的代码中的其他位置的信息，你可以试试下面的代码：<br/><br/>

<TABLE width="90%" bgcolor="#ffffff" border="0">

<TBODY>

<TR>

    <TD>Foo* pf = new Foo();</TD>

</TR>

</TBODY>

</TABLE><br/>　　Foo对象将在哪里建立？那块内存是否被清除？我能象下面那样对指针做算法吗：<br/><br/>　　pf++;<br/><br/>　　答案依赖于Foo是否用__gc关键字声明，假如它是碎片收集对象，它只能在管理堆不是在本堆和堆栈中建立，另一方面，如果没有用__gc声明，将在本堆中分配内存给它，你必须记得去清除它。<br/><br/>　　如果编译器有自由去改变语言，就象在C++/CLI上发生的，可以忽视什么地方生存的什么类型的类，可以用不同的语法表明它在哪里生存：<br/><br/>

<TABLE width="90%" bgcolor="#ffffff" border="0">

<TBODY>

<TR>

    <TD>Foo^ hf = gcnew Foo();</TD>

</TR>

</TBODY>

</TABLE><br/>　　这被叫做句柄，许多C++团队好象都是用^符号来标明的，你可以用*和-&amp;gt;来解除句柄的引用，你可以从实例的声明而不是回过头从类的声明中得到生命期的声明。例如：<br/><br/>

<TABLE width="90%" bgcolor="#ffffff" border="0">

<TBODY>

<TR>

    <TD>ref class R<br/>{<br/>　private:<br/>　　int m_a;<br/>　public:<br/>　　R(int a): m_a(a) {}<br/>}; 

    </TD>

</TR>

</TBODY>

</TABLE><br/>　　你可能会认为ref是C++/CLI新的关键字，但它不是，“ref class“是关键字，你可以有变量是ref而不会引起混乱，其他的关键字还有”value class“,”interface class“,”enum class“，几乎过去所有的C++程序都会有value这个变量，我很高兴value没有变成关键字。<br/><br/>　　Ref class 是一个管理类，一个被设计成生存管理队中和被碎片收集管理的类，象我前面所示的你可以在堆栈中声明一个实例，编译器会帮你找到它，加上不可见的智能指针。<br/><br/>　　特性<br/><br/>　　有很多C++特性的改变，因为我是用C++比较笨拙的特性开始的例子，所以我现在关闭比较相近的C++<br/><br/>

<TABLE width="90%" bgcolor="#ffffff" border="0">

<TBODY>

<TR>

    <TD>ref class R<br/>{<br/>　private:<br/>　　int m_Size;<br/>　public:<br/>　　property int Size<br/>　　{<br/>　　　int get() { return m_Size; }<br/>　　void set(int val){m_Size = val;}<br/>　}<br/>};<br/>R r;<br/>r.Size = 42; 

    </TD>

</TR>

</TBODY>

</TABLE><br/>　　property是一个关键字吗？有点象，它是一个位置关键字，所以你可以有property的变量和函数，而不会引起混乱，它只会在类定义中有特殊的含义，现在在C++/CLI中有单独的单元提供特性定义，我很喜欢这样，相信你也是。<br/><SCRIPT>zmbbs=1;</SCRIPT>

'></span><header class=post-header><h1 class=post-title itemprop="name headline">Visual Studio 2005中C++的变化</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2004年11月02日 15:18:00 CST" itemprop="dateCreated datePublished" datetime="2004-11-02 15:18:00 +0800 +0800">2004年11月02日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新于>更新于：
</span><time title="修改时间：2004年11月09日 16:59:00 CST" itemprop="dateModified dateLastmod" datetime="2004-11-09 16:59:00 +0800 +0800">2004年11月09日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/win32dev/ itemprop=url rel=index><span itemprop=name>dev/Win32Dev</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>2861</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>6分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/c-changes-in-visual-studio-2005/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p style="font-size:10pt;font-family:Comic Sans MS">下一代visual studio版本（以前whidbey,现在是visual studio 2005）提供更加丰富的改进的库文件和没有很多幕后精简和加速的压力，它的大量配合的工具和新的功能将使开发者的开发过程变得简单有趣，对我而言，这些与visual studio 2005对C++的处理相比就显得有些苍白，这里我主要谈谈在下一代visual studio中C++的变化.<br><br>跟下划线拜拜<br><br>在visual studio.NET中引入了对C++扩展名的处理，扩展名是以两个下划线开始的关键字，比如__gc和__property.自从上个版本发布以来，我已经写了大量的双下划线特征的代码，我坦白也不喜欢这样，我了解具体的原因是：带两个下划线的关键字作为特殊的扩展名使它们不会跟标准编译器相混淆，你可以全面的管理扩展名可以用其他的编译器来编译，它忽视__关键字。<br><br>这是一种解决方法：微软发现了一种方法不改变编程语言的改变，但是会出现下面一些结果：<br><br>·开发者发现语法不自然<br>·不能被完全的采用<br><br>如例，适当的C++处理方法：<br>public __gc class Foo<br>{<br>// hundreds of lines of code<br>__property String* get_Text();<br>// hundreds of lines of code<br>__property void set_Text(String*);<br>// hundreds of lines of code<br>};&#160;<br><br>　　有良好习惯的程序员把get和put放在每个扩展名的右面，把潜在的变量放在旁边，但是编程语言没要求你这样做。它提供无环境支持定界结构让你明白作为一个单元是正确的，所以它是不自然的跟其它visual studio .NET语言不一样。但是你如何去处理这个问题那，唯一的方式完成C++转换成CLR反之就要改变C++.假如你想那样做，你可以有足够的自由得到自然一流的语言会给你最好的，你可以取消大量的带双划线的关键字。<br><strong>生存时间和范围<br></strong><br>　　我喜欢确定的解析，实际上我也喜欢碎片收集，我还能举出更多的，它们有自己的作用而且我也需要它们，假如我只在内存中构造一个对象，我希望在我自己清除它前不被清除，<br><br>　　所以内存管理是很复杂的。但是，如果你的对象包含一个非管理的源文件如数据库链接，一个开放文件，或者类似我要取得一个控制。我想知道它要尽快的离开，用这种模式去处理，但是它不是直接的，简单的亲密支持是最好的办法。<br><br>　　下面是在原始的C++中，你去完成这些事情：<br><br><pre><code>&lt;TABLE width=&quot;90%&quot; bgcolor=&quot;#ffffff&quot; border=&quot;0&quot;&gt;

&lt;TBODY&gt;

&lt;TR&gt;

    &lt;TD&gt;//this is a code fragment&lt;br/&gt;{&lt;br/&gt;try&lt;br/&gt;{&lt;br/&gt;Foo* f=new Foo(/* params */);&lt;br/&gt;//all kinds of code, some of which might throw exceptions&lt;br/&gt;delete f;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;catch (/* something */)&lt;br/&gt;{&lt;br/&gt;delete f;&lt;br/&gt;//whatever else, or rethrow;&lt;br/&gt;}&lt;br/&gt;} 

    &lt;/TD&gt;

&lt;/TR&gt;

&lt;/TBODY&gt;

&lt;/TABLE&gt;&lt;br/&gt;　　如果你在堆栈建立对象，生命期是简单的&lt;br/&gt;&lt;br/&gt;

&lt;TABLE width=&quot;90%&quot; bgcolor=&quot;#ffffff&quot; border=&quot;0&quot;&gt;

&lt;TBODY&gt;

&lt;TR&gt;

    &lt;TD&gt;//this is a code fragment&lt;br/&gt;{&lt;br/&gt;　Foo f;&lt;br/&gt;　//all kinds of code, some of which might throw exceptions&lt;br/&gt;} 

    &lt;/TD&gt;

&lt;/TR&gt;

&lt;/TBODY&gt;

&lt;/TABLE&gt;&lt;br/&gt;　　当f超过范围，不论是否是意外它将被清除这是自然的。&lt;br/&gt;&lt;br/&gt;　　当对象在管理堆里时，你不能把它删除，它将被碎片收集清除，如果你想清除管理着源文件的对象，你可以调用dispose()函数，虽然C#为它提供了的有效的结构，但是它仍然不象堆栈那样简单。&lt;br/&gt;&lt;br/&gt;　　在新一代的语言(以前是C++/CLI),你在哪里建立对象不依赖于你建立对象的种类，你可以堆栈中管理对象，它有确定的解析，但它越界时将被清除，如果你愿意你可以在管理堆里建立对象。&lt;br/&gt;&lt;br/&gt;　　这种变化带来其它的结果，其中最深远的是你可以把不同的对象放在摸板中或者可以把它看成其它类的成员变量，你可以得到完整的C++生存时间周期，而不是仅仅是把它分配到相应的堆，然后等碎片收集来处理它。&lt;br/&gt;&lt;br/&gt;　　解析和定稿&lt;br/&gt;&lt;br/&gt;　　当你为其它语言写了碎片收集对象是，你是否为它写了解析函数？当你使用C++,你可以在堆栈构造对象，解析函数将运行当它越界时，什么事情会发生当其他C#或VB程序调用这个对象，运行时仅从简单的方式去处理，它是用dispose()来解析，任何一个C++/CLI对象都有一个可以任意调用的解析函数。&lt;br/&gt;&lt;br/&gt;　　假如你在C#或VB中有dispose()的类，你可能已经写了一个定论，C++/CLI也有简便的语法为定论，就象Foo的解析是~Foo,Foo的定论是!Foo(~是比特的not,!是逻辑的not,它们都是提醒是和构造函数对立的),&lt;br/&gt;&lt;br/&gt;　　Finalizer将运行当在管理堆中建立而不被调用，确信它所包含的非管理源文件被清除，即使其他调用函数忘了去解析。&lt;br/&gt;&lt;br/&gt;　　指针和句柄&lt;br/&gt;&lt;br/&gt;　　在C++扩展名管理中，C++的主要限制没有变化，同样的符号和语法用做完全的事情，*的含义依赖于你的代码中的其他位置的信息，你可以试试下面的代码：&lt;br/&gt;&lt;br/&gt;

&lt;TABLE width=&quot;90%&quot; bgcolor=&quot;#ffffff&quot; border=&quot;0&quot;&gt;

&lt;TBODY&gt;

&lt;TR&gt;

    &lt;TD&gt;Foo* pf = new Foo();&lt;/TD&gt;

&lt;/TR&gt;

&lt;/TBODY&gt;

&lt;/TABLE&gt;&lt;br/&gt;　　Foo对象将在哪里建立？那块内存是否被清除？我能象下面那样对指针做算法吗：&lt;br/&gt;&lt;br/&gt;　　pf++;&lt;br/&gt;&lt;br/&gt;　　答案依赖于Foo是否用__gc关键字声明，假如它是碎片收集对象，它只能在管理堆不是在本堆和堆栈中建立，另一方面，如果没有用__gc声明，将在本堆中分配内存给它，你必须记得去清除它。&lt;br/&gt;&lt;br/&gt;　　如果编译器有自由去改变语言，就象在C++/CLI上发生的，可以忽视什么地方生存的什么类型的类，可以用不同的语法表明它在哪里生存：&lt;br/&gt;&lt;br/&gt;

&lt;TABLE width=&quot;90%&quot; bgcolor=&quot;#ffffff&quot; border=&quot;0&quot;&gt;

&lt;TBODY&gt;

&lt;TR&gt;

    &lt;TD&gt;Foo^ hf = gcnew Foo();&lt;/TD&gt;

&lt;/TR&gt;

&lt;/TBODY&gt;

&lt;/TABLE&gt;&lt;br/&gt;　　这被叫做句柄，许多C++团队好象都是用^符号来标明的，你可以用*和-&amp;gt;来解除句柄的引用，你可以从实例的声明而不是回过头从类的声明中得到生命期的声明。例如：&lt;br/&gt;&lt;br/&gt;

&lt;TABLE width=&quot;90%&quot; bgcolor=&quot;#ffffff&quot; border=&quot;0&quot;&gt;

&lt;TBODY&gt;

&lt;TR&gt;

    &lt;TD&gt;ref class R&lt;br/&gt;{&lt;br/&gt;　private:&lt;br/&gt;　　int m_a;&lt;br/&gt;　public:&lt;br/&gt;　　R(int a): m_a(a) {}&lt;br/&gt;}; 

    &lt;/TD&gt;

&lt;/TR&gt;

&lt;/TBODY&gt;

&lt;/TABLE&gt;&lt;br/&gt;　　你可能会认为ref是C++/CLI新的关键字，但它不是，“ref class“是关键字，你可以有变量是ref而不会引起混乱，其他的关键字还有”value class“,”interface class“,”enum class“，几乎过去所有的C++程序都会有value这个变量，我很高兴value没有变成关键字。&lt;br/&gt;&lt;br/&gt;　　Ref class 是一个管理类，一个被设计成生存管理队中和被碎片收集管理的类，象我前面所示的你可以在堆栈中声明一个实例，编译器会帮你找到它，加上不可见的智能指针。&lt;br/&gt;&lt;br/&gt;　　特性&lt;br/&gt;&lt;br/&gt;　　有很多C++特性的改变，因为我是用C++比较笨拙的特性开始的例子，所以我现在关闭比较相近的C++&lt;br/&gt;&lt;br/&gt;

&lt;TABLE width=&quot;90%&quot; bgcolor=&quot;#ffffff&quot; border=&quot;0&quot;&gt;

&lt;TBODY&gt;

&lt;TR&gt;

    &lt;TD&gt;ref class R&lt;br/&gt;{&lt;br/&gt;　private:&lt;br/&gt;　　int m_Size;&lt;br/&gt;　public:&lt;br/&gt;　　property int Size&lt;br/&gt;　　{&lt;br/&gt;　　　int get() { return m_Size; }&lt;br/&gt;　　void set(int val){m_Size = val;}&lt;br/&gt;　}&lt;br/&gt;};&lt;br/&gt;R r;&lt;br/&gt;r.Size = 42; 

    &lt;/TD&gt;

&lt;/TR&gt;

&lt;/TBODY&gt;

&lt;/TABLE&gt;&lt;br/&gt;　　property是一个关键字吗？有点象，它是一个位置关键字，所以你可以有property的变量和函数，而不会引起混乱，它只会在类定义中有特殊的含义，现在在C++/CLI中有单独的单元提供特性定义，我很喜欢这样，相信你也是。&lt;br/&gt;&lt;SCRIPT&gt;zmbbs=1;&lt;/SCRIPT&gt;
</code></pre></p><a id=more></a></div><footer class=post-footer><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Visual Studio 2005中C++的变化</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/c-changes-in-visual-studio-2005/ title="Visual Studio 2005中C++的变化">https://blogs.qipai360.cn/post/c-changes-in-visual-studio-2005/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/sixty-eight-classic-stories/ rel=next title=六十八个经典故事><i class="fa fa-chevron-left"></i> 六十八个经典故事</a></div><div class="post-nav-prev post-nav-item"><a href=/post/inclusion-and-trust-best-motivation/ rel=prev title=包容与信任是最好的激励>包容与信任是最好的激励
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2026
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.157.0 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"c-changes-in-visual-studio-2005","permalink":"https://blogs.qipai360.cn/post/c-changes-in-visual-studio-2005/","title":"Visual Studio 2005中C++的变化","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1772265585" defer></script></body></html>