<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.157.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="AVP主动防御之隐藏进程"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Rise,ZhangTuohui,技术,C++,Unity3D,Lua,NodeJS,C#,JavaScript,游戏开发,机器学习,深度学习,AI,编程,编程语言,编程技术,编程开发,游戏引擎,游戏设计,游戏制作,游戏开发者,游戏开发者博客,游戏开发者网站,游戏开发者工具,游戏开发者教程,游戏开发者学习,游戏开发者交流,游戏开发者分享,游戏开发者经验,游戏开发者心得,游戏开发者技巧,游戏开发者方法,游戏开发者思路,游戏开发者理念,游戏开发者文化,游戏开发者精神,游戏开发者信仰"><meta property="og:type" content="article"><meta property="og:title" content="AVP主动防御之隐藏进程"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/avp-active-defense-hidden-process/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2007-11-29 09:06:00 +0800 +0800"><meta property="article:modified_time" content="2007-11-29 09:06:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1772265588"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>AVP主动防御之隐藏进程 - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>679</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>679</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>35</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>118</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2423147></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5207></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2026-02-28 15:59:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/avp-active-defense-hidden-process/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="AVP主动防御之隐藏进程"><meta itemprop=description content="卡巴主动防御中检测隐藏进程的方法：
    Hook掉系统的SwapContext,这种方法是在2003年被提出的;这个函数被KiSwapThread调用,负责线程调度;下面这部分代码就是卡巴Detour SwapContext的汇编代码的分析(后面附上对应的c代码)："></span><header class=post-header><h1 class=post-title itemprop="name headline">AVP主动防御之隐藏进程</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年11月29日 09:06:00 CST" itemprop="dateCreated datePublished" datetime="2007-11-29 09:06:00 +0800 +0800">2007年11月29日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/safe/ itemprop=url rel=index><span itemprop=name>dev/Safe</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>1907</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>4分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/avp-active-defense-hidden-process/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>卡巴主动防御中检测隐藏进程的方法：<br></p><p>    Hook掉系统的SwapContext,这种方法是在2003年被提出的;这个函数被KiSwapThread调用,负责线程调度;下面这部分代码就是卡巴Detour SwapContext的汇编代码的分析(后面附上对应的c代码)：<br></p><a id=more></a><br><p>(PS:突破这种方式来隐藏进程的方法也在随后就出来了,自己实现线程调度,详见:<a href=http://hi-tech.nsys.by/33/>
<a href=http://hi-tech.nsys.by/33/ title=http://hi-tech.nsys.by/33/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://hi-tech.nsys.by/33/
</a></a>)<br></p><br><p>一：KlifSetSwapContextHook<br></p><br><p>.text:0002DE60 KlifSetSwapContextHook proc near      <br></p><p>.text:0002DE60<br></p><p>.text:0002DE60 var_5C          = dword ptr -5Ch<br></p><p>.text:0002DE60 var_58          = dword ptr -58h<br></p><p>.text:0002DE60 var_54          = dword ptr -54h<br></p><p>.text:0002DE60 var_50          = dword ptr -50h<br></p><p>.text:0002DE60 var_48          = dword ptr -48h<br></p><p>.text:0002DE60 var_38          = dword ptr -38h<br></p><p>.text:0002DE60 var_34          = dword ptr -34h<br></p><p>.text:0002DE60 var_30          = word ptr -30h<br></p><p>.text:0002DE60 var_24          = dword ptr -24h<br></p><p>.text:0002DE60 var_20          = dword ptr -20h<br></p><p>.text:0002DE60 var_1C          = dword ptr -1Ch<br></p><p>.text:0002DE60 var_18          = dword ptr -18h<br></p><p>.text:0002DE60 var_10          = dword ptr -10h<br></p><p>.text:0002DE60 var_4           = dword ptr -4<br></p><p>.text:0002DE60<br></p><p>.text:0002DE60                 push    ebp<br></p><p>.text:0002DE61                 mov     ebp, esp<br></p><p>.text:0002DE63                 push    0FFFFFFFFh<br></p><p>.text:0002DE65                 push    offset dword_13158<br></p><p>.text:0002DE6A                 push    offset sub_2E46C<br></p><p>.text:0002DE6F                 mov     eax, large fs:0<br></p><p>.text:0002DE75                 push    eax<br></p><p>.text:0002DE76                 mov     large fs:0, esp<br></p><p>.text:0002DE7D                 sub     esp, 4Ch<br></p><p>.text:0002DE80                 push    ebx<br></p><p>.text:0002DE81                 push    esi<br></p><p>.text:0002DE82                 push    edi<br></p><p>.text:0002DE83                 mov     [ebp+var_18], esp<br></p><p>.text:0002DE86                 mov     ecx, g_NtoskrnlAddr<br></p><p>.text:0002DE8C                 cmp     word ptr [ecx], 5A4Dh ; Ms dos stub - MZ<br></p><p>.text:0002DE91                 jnz     Routine_Error<br></p><p>.text:0002DE97                 mov     eax, [ecx+3Ch]  ; e_lfanew<br></p><p>.text:0002DE9A                 add     eax, ecx<br></p><p>.text:0002DE9C                 cmp     dword ptr [eax], 4550h ; PE<br></p><p>.text:0002DEA2                 jnz     Routine_Error<br></p><p>.text:0002DEA8                 xor     edx, edx<br></p><p>.text:0002DEAA                 mov     dx, [eax+14h]      ; SizeOfOptionalHeader<br></p><p>.text:0002DEAE                 lea     eax, [edx+eax+18h] ; 指向第一Section(.text)<br></p><p>.text:0002DEB2                 mov     esi, [eax+0Ch]<br></p><p>.text:0002DEB5                 add     esi, ecx           ;.text区的内存地址<br></p><p>.text:0002DEB7                 mov     eax, [eax+10h]     ;.text区的内存大小<br></p><p>.text:0002DEBA                 xor     ebx, ebx<br></p><p>.text:0002DEBC                 mov     [ebp+var_20], ebx<br></p><p>.text:0002DEBF                 mov     [ebp+var_4], ebx<br></p><p>.text:0002DEC2                 mov     ecx, ds:NtBuildNumber<br></p><p>.text:0002DEC8                 mov     cx, [ecx]<br></p><p>.text:0002DECB                 cmp     cx, 2600        ; 1575 - 2195 Win2K<br></p><p>.text:0002DECB                                         ; 2202 - 2600 WinXP<br></p><p>.text:0002DECB                                         ; 3501 - 3790 Win2003<br></p><p>.text:0002DED0                 jle     Is2kORxp<br></p><p>.text:0002DED6                 mov     [ebp+var_1C], 5<br></p><p>.text:0002DEDD                 cmp     cx, 3790<br></p><p>.text:0002DEE2                 jl      short Is2003Release<br></p><p>.text:0002DEE4                 mov     ecx, offset g_2003CharCode ; 2003的特征码<br></p><p>.text:0002DEE9                 mov     [ebp+var_58], ecx<br></p><p>.text:0002DEEC                 mov     edx, 9<br></p><p>.text:0002DEF1                 mov     [ebp+var_54], edx<br></p><p>.text:0002DEF4                 xor     edi, edi<br></p><p>.text:0002DEF6                 jmp     short Is2003<br></p><p>.text:0002DEF8<br></p><p>.text:0002DEF8 Is2003Release:<br></p><p>.text:0002DEF8                 cmp     cx, 3604<br></p><p>.text:0002DEFD                 jle     short Is2003Beta3<br></p><p>.text:0002DEFF                 mov     ecx, offset g_ReleaseCharCode ; 2003Beat3-Release的特征码<br></p><p>.text:0002DF04                 mov     [ebp+var_58], ecx<br></p><p>.text:0002DF07                 mov     edx, 8<br></p><p>.text:0002DF0C                 mov     [ebp+var_54], edx<br></p><p>.text:0002DF0F                 mov     edi, 0Ah<br></p><p>.text:0002DF14                 jmp     short Is2003<br></p><p>.text:0002DF16<br></p><p>.text:0002DF16 Is2003Beta3:<br></p><p>.text:0002DF16                 mov     ecx, offset g_Bete3CharCode ; 2003的Beta-Beta3特征码<br></p><p>.text:0002DF1B                 mov     [ebp+var_58], ecx<br></p><p>.text:0002DF1E                 mov     edx, 7<br></p><p>.text:0002DF23                 mov     [ebp+var_54], edx<br></p><p>.text:0002DF26                 mov     edi, 9<br></p><p>.text:0002DF2B<br></p><p>.text:0002DF2B Is2003:<br></p><p>.text:0002DF2B                 mov     [ebp+var_50], edi<br></p><p>.text:0002DF2E                 push    edx<br></p><p>.text:0002DF2F                 push    ecx<br></p><p>.text:0002DF30                 push    eax<br></p><p>.text:0002DF31                 push    esi<br></p><p>.text:0002DF32                 call    KilfGetAddrByCharCode ; arg_c 特征码的长度<br></p><p>.text:0002DF32                                               ; arg_8 特征码的地址<br></p><p>.text:0002DF32                                               ; arg_4 搜索的最大范围<br></p><p>.text:0002DF32                                               ; arg_0 搜索的起始地址<br></p><p>.text:0002DF37                 mov     [ebp+var_24], eax<br></p><p>.text:0002DF3A                 cmp     eax, 0FFFFFFFFh<br></p><p>.text:0002DF3D                 jz      Search_Failed<br></p><p>.text:0002DF43                 add     eax, edi<br></p><p>.text:0002DF45                 add     esi, eax<br></p><p>.text:0002DF47                 cmp     dword ptr [esi], 0FF1043FFh<br></p><p>.text:0002DF4D                 jnz     short Search_Failed<br></p><p>.text:0002DF4F                 mov     ebx, esi<br></p><p>.text:0002DF51                 mov     [ebp+var_20], ebx<br></p><p>.text:0002DF54                 mov     [ebp+var_4], 0FFFFFFFFh<br></p><p>.text:0002DF5B                 jmp     SetSwapContextHook<br></p><p>.text:0002DF60<br></p><p>.text:0002DF60 Is2kORxp:<br></p><p>.text:0002DF60                 push    5<br></p><p>.text:0002DF62                 push    offset g_2kCharCode ; 2k的特征码<br></p><p>.text:0002DF67                 push    eax<br></p><p>.text:0002DF68                 push    esi<br></p><p>.text:0002DF69                 call    KilfGetAddrByCharCode ; arg_c 特征码的长度<br></p><p>.text:0002DF69                                               ; arg_8 特征码的地址<br></p><p>.text:0002DF69                                               ; arg_4 搜索的最大范围<br></p><p>.text:0002DF69                                               ; arg_0 搜索的起始地址<br></p><p>.text:0002DF6E                 mov     [ebp+var_24], eax<br></p><p>.text:0002DF71                 cmp     eax, 0FFFFFFFFh<br></p><p>.text:0002DF74                 jz      short Search_Failed<br></p><p>.text:0002DF76                 mov     edx, ds:NtBuildNumber<br></p><p>.text:0002DF7C                 cmp     word ptr [edx], 2195<br></p><p>.text:0002DF81                 jle     short Is2k<br></p><p>.text:0002DF83<br></p><p>.text:0002DF83 Isxp:<br></p><p>.text:0002DF83                 add     esi, eax<br></p><p>.text:0002DF85                 mov     [ebp+var_5C], esi<br></p><p>.text:0002DF88                 mov     [ebp+var_1C], 7<br></p><p>.text:0002DF8F                 push    4<br></p><p>.text:0002DF91                 push    offset g_XpCharCode ; xp的特征码<br></p><p>.text:0002DF96                 push    100h<br></p><p>.text:0002DF9B                 push    esi<br></p><p>.text:0002DF9C                 call    KilfGetAddrByCharCode ; arg_c 特征码的长度<br></p><p>.text:0002DF9C                                               ; arg_8 特征码的地址<br></p><p>.text:0002DF9C                                               ; arg_4 搜索的最大范围<br></p><p>.text:0002DF9C                                               ; arg_0 搜索的起始地址<br></p><p>.text:0002DFA1                 mov     [ebp+var_24], eax<br></p><p>.text:0002DFA4                 cmp     eax, 0FFFFFFFFh<br></p><p>.text:0002DFA7                 jz      short Search_Failed<br></p><p>.text:0002DFA9                 lea     ebx, [esi+eax+2]<br></p><p>.text:0002DFAD                 mov     [ebp+var_20], ebx<br></p><p>.text:0002DFB0                 mov     [ebp+var_4], 0FFFFFFFFh<br></p><p>.text:0002DFB7                 jmp     short SetSwapContextHook<br></p><p>.text:0002DFB9<br></p><p>.text:0002DFB9 Is2k:<br></p><p>.text:0002DFB9                 lea     ebx, [eax+esi]<br></p><p>.text:0002DFBC                 mov     [ebp+var_20], ebx<br></p><p>.text:0002DFBF                 mov     [ebp+var_1C], 5<br></p><p>.text:0002DFC6<br></p><p>.text:0002DFC6 Search_Failed:<br></p><p>.text:0002DFC6                 mov     [ebp+var_4], 0FFFFFFFFh<br></p><p>.text:0002DFCD                 jmp     short SetSwapContextHook<br></p><p>.text:0002DFCF<br></p><p>.text:0002DFCF SEH_Routine:    <br></p><p>.text:0002DFCF                 mov     eax, 1<br></p><p>.text:0002DFD4                 retn<br></p><p>.text:0002DFD5<br></p><p>.text:0002DFD5 SEH_Routine2:      <br></p><p>.text:0002DFD5                 mov     esp, [ebp-18h]<br></p><p>.text:0002DFD8                 mov     dword ptr [ebp-4], 0FFFFFFFFh<br></p><p>.text:0002DFDF                 mov     ebx, [ebp-20h]<br></p><p>.text:0002DFE2<br></p><p>.text:0002DFE2 SetSwapContextHook:<br></p><p>.text:0002DFE2                 test    ebx, ebx<br></p><p>.text:0002DFE4                 jz      Routine_Error<br></p><p>.text:0002DFEA                 mov     eax, 90909090h<br></p><p>.text:0002DFEF                 mov     [ebp+var_38], eax<br></p><p>.text:0002DFF2                 mov     [ebp+var_34], eax<br></p><p>.text:0002DFF5                 mov     [ebp+var_30], ax<br></p><p>.text:0002DFF9                 mov     byte ptr [ebp+var_38], 0E9h ; JMP<br></p><p>.text:0002DFFD                 mov     ecx, offset KlifSwapContext<br></p><p>.text:0002E002                 sub     ecx, ebx        ; EBX是SwapContext+offset的地址<br></p><p>.text:0002E004                 sub     ecx, 5<br></p><p>.text:0002E007                 mov     [ebp+var_38+1], ecx<br></p><p>.text:0002E00A<br></p><p>.text:0002E00A Klif_Store_SC_Addr:                     ; 保存原来的指令<br></p><p>.text:0002E00A                 mov     ecx, [ebp+var_1C]<br></p><p>.text:0002E00D                 lea     edx, [ecx+ebx]<br></p><p>.text:0002E010                 mov     g_SwapContextAddr, edx<br></p><p>.text:0002E016                 mov     esi, ebx<br></p><p>.text:0002E018                 mov     edi, offset g_SwapContextOpcode<br></p><p>.text:0002E01D                 mov     eax, ecx<br></p><p>.text:0002E01F                 shr     ecx, 2<br></p><p>.text:0002E022                 rep movsd<br></p><p>.text:0002E024                 mov     ecx, eax<br></p><p>.text:0002E026                 and     ecx, 3<br></p><p>.text:0002E029                 rep movsb<br></p><p>.text:0002E02B                 lea     ecx, [ebp+var_48]<br></p><p>.text:0002E02E                 push    ecx<br></p><p>.text:0002E02F                 push    1<br></p><p>.text:0002E031                 push    ebx<br></p><p>.text:0002E032                 call    KlifSetInterruptStauts<br></p><p>.text:0002E037                 test    al, al<br></p><p>.text:0002E039                 jz      short Routine_Error<br></p><p>.text:0002E03B                 mov     ecx, offset g_kernelLock<br></p><p>.text:0002E040                 call    KlifClearInterruptAndLock<br></p><p>.text:0002E045<br></p><p>.text:0002E045 Klif_Set_SC_Hook:                         ; detour开始<br></p><p>.text:0002E045                 mov     ecx, [ebp+var_1C] ; 覆盖的Opcodes Num<br></p><p>.text:0002E048                 lea     esi, [ebp+var_38] ; Jmp Klif+0x????<br></p><p>.text:0002E04B                 mov     edi, ebx<br></p><p>.text:0002E04D                 mov     edx, ecx<br></p><p>.text:0002E04F                 shr     ecx, 2<br></p><p>.text:0002E052                 rep movsd<br></p><p>.text:0002E054                 mov     ecx, edx<br></p><p>.text:0002E056                 and     ecx, 3<br></p><p>.text:0002E059                 rep movsb<br></p><p>.text:0002E05B                 mov     edx, eax<br></p><p>.text:0002E05D                 mov     ecx, offset g_kernelLock<br></p><p>.text:0002E062                 call    KlifUnLock<br></p><p>.text:0002E067                 lea     eax, [ebp+var_48]<br></p><p>.text:0002E06A                 push    eax<br></p><p>.text:0002E06B                 mov     ecx, [ebp+var_48]<br></p><p>.text:0002E06E                 push    ecx<br></p><p>.text:0002E06F                 push    ebx<br></p><p>.text:0002E070                 call    KlifSetInterruptStauts<br></p><p>.text:0002E075                 mov     al, 1<br></p><p>.text:0002E077                 mov     ecx, [ebp+var_10]<br></p><p>.text:0002E07A                 mov     large fs:0, ecx<br></p><p>.text:0002E081                 pop     edi<br></p><p>.text:0002E082                 pop     esi<br></p><p>.text:0002E083                 pop     ebx<br></p><p>.text:0002E084                 mov     esp, ebp<br></p><p>.text:0002E086                 pop     ebp<br></p><p>.text:0002E087                 retn<br></p><p>.text:0002E088 Routine_Error:                         <br></p><p>.text:0002E088                 xor     al, al<br></p><p>.text:0002E08A                 mov     ecx, [ebp+var_10]<br></p><p>.text:0002E08D                 mov     large fs:0, ecx<br></p><p>.text:0002E094                 pop     edi<br></p><p>.text:0002E095                 pop     esi<br></p><p>.text:0002E096                 pop     ebx<br></p><p>.text:0002E097                 mov     esp, ebp<br></p><p>.text:0002E099                 pop     ebp<br></p><p>.text:0002E09A                 retn<br></p><p>.text:0002E09A KlifSetSwapContextHook endp<br></p><br><br><p>二：KlifSwapContext<br></p><br><p>.text:0002DE10 KlifSwapContext:                      <br></p><p>.text:0002DE10                 pushf<br></p><p>.text:0002DE11                 pusha<br></p><p>.text:0002DE12                 mov     ebp, esp<br></p><p>.text:0002DE14                 sub     esp, 10h<br></p><p>.text:0002DE17                 add     esi, dword_2FC90<br></p><p>.text:0002DE1D                 add     edi, dword_2FC90<br></p><p>.text:0002DE23                 mov     eax, [esi]      ; Address of next thread<br></p><p>.text:0002DE25                 mov     [ebp-8], eax<br></p><p>.text:0002DE28                 mov     eax, [edi]      ; Address of previous thread<br></p><p>.text:0002DE2A                 mov     [ebp-0Ch], eax<br></p><p>.text:0002DE2D                 mov     ecx, offset g_kernelLock<br></p><p>.text:0002DE32                 call    KlifClearInterruptAndLock<br></p><p>.text:0002DE37                 mov     [ebp-4], eax<br></p><p>.text:0002DE3A                 mov     eax, [ebp-8]<br></p><p>.text:0002DE3D                 push    eax             ; Address of next thread<br></p><p>.text:0002DE3E                 call    KlifSwapContextMain ;//MAIN!!!<br></p><p>.text:0002DE43                 mov     edx, [ebp-4]<br></p><p>.text:0002DE46                 mov     ecx, offset g_kernelLock<br></p><p>.text:0002DE4B                 call    KlifUnLock<br></p><p>.text:0002DE50                 add     esp, 10h<br></p><p>.text:0002DE53                 popa<br></p><p>.text:0002DE54                 popf<br></p><p>.text:0002DE55                 jmp     g_OldSwapContext<br></p><p>.text:0002DE5B                 align 10h<br></p><br><br><p>三：KlifSetSwapContextHook 对应C代码<br></p><br><p>PVOID g_NtoskrnlAddr;<br></p><p>char  g_2003CharCode[8]    = {0xFF, 0x43, 0x10, 0xFF, 0x33, 0x83, 0x7B, 0x08};<br></p><p>char  g_ReleaseCharCode[8] = {0x80, 0x7E, 0x5D, 0x00, 0x74, 0x04, 0xF3, 0x90};<br></p><p>char  g_Bete3CharCode[8]   = {0xF7, 0x46, 0x24, 0x01, 0x00, 0x00, 0x00, 0x00};<br></p><p>char  g_2kCharCode[8]      = {0x26, 0xC6, 0x46, 0x2D, 0x02, 0x00, 0x00, 0x00};<br></p><p>char  g_xpCharCode[4]      = {0x8B, 0x0B, 0x83, 0xBB};<br></p><p>int   g_SwapContextOpcode[4] = {0x90909090, 0x90909090, 0x9090FF25, g_SwapContextAddr};<br></p><p>int   g_SwapContextAddr;<br></p><p>char  g_kernelLock;</p><p>BOOL KlifSetSwapContextHook()<br><p>{<br></p><p> METUEX ProtectMutex;        //这个不大准确<br></p><p> int    nOffset          = 0;//特征码距Ntoskrnl的偏移移<br></p><p> int    nReplaceNum      = 0;//要替换SwapContext几个字节<br></p><p> char*  pSwapContextAddr = 0;//要替换的地址<br></p><p> <br></p><p> int   nCompareNum  = 0;<br></p><p> char* pCompareCode = 0;<br></p><p> <br></p><p> PIMAGE_DOS_HEADER     pImageDos =  (PIMAGE_DOS_HEADER)g_NtoskrnlAddr;<br></p><p> PIMAGE_NT_HEADERS     pImageNt  =  (PIMAGE_NT_HEADERS)(g_NtoskrnlAddr+pImageDos->e_lfanew);<br></p><p> PIMAGE_SECTION_HEADER pImageSec =  (PIMAGE_SECTION_HEADER )((char*)pImageNt+pImageNt->FileHeader.SizeOfOptionalHeader);<br></p><p> <br></p><p> char* pSearchAddr = (char*)g_NtoskrnlAddr + pImageSec->VirtualAddress;<br></p><p> int   nSearchArea = pImageSection->SizeOfRawData;<br></p><p> <br></p><p> if (<em>(WORD</em>)g_NtoskrnlAddr               == 0x5A4D &&<br></p><p>     <em>(WORD</em>)((char*)g_NtoskrnlAddr+0x3C) == 0x4550)<br></p><p> {<br></p><p>  return FALSE;<br></p><p> }<br></p><p> <br></p><p> //Windows 2003<br></p><p> if (*NtBuildNumber > 2600)<br></p><p> {<br></p><p>  nReplaceNum = 5;</p></p><p>&nbsp;&nbsp;int nOrgOffset = 0;<br><p>  if (*NtBuildNumber >= 3790)<br></p><p>  {<br></p><p>   nCompareNum = 9;<br></p><p>   pCompareCode = g_2003CharCode;<br></p><p>   <br></p><p>  }else<br></p><p>  {<br></p><p>   if (*NtBuildNumber > 3604)<br></p><p>   {<br></p><p>    nOrgOffset   = 10;<br></p><p>    nCompareNum  = 8;<br></p><p>    pCompareCode = g_ReleaseCharCode;<br></p><p>   }else<br></p><p>   {<br></p><p>    nOrgOffset   = 9;<br></p><p>    nCompareNum  = 7;<br></p><p>    pCompareCode = g_Bete3CharCode;<br></p><p>     <br></p><p>   }<br></p><p>  }<br></p><p>  <br></p><p>  nOffset = KilfGetAddrByCharCode(nCompareNum, <br></p><p>                                  pCompareCode,<br></p><p>                                  nSearchArea,<br></p><p>                                  pSearchAddr);<br></p><p>  if (nOffset == -1)<br></p><p>  {<br></p><p>   return FALSE;<br></p><p>  }<br></p><p>  <br></p><p>  pSwapContextAddr = pSearchAddr + nOffset + nOrgOffset;<br></p><p>  <br></p><p>  if (<em>((int</em>)pSwapContextAddr) != 0xFF1043FF)<br></p><p>  {<br></p><p>   return FALSE;<br></p><p>  }<br></p><p>  <br></p><p> }else<br></p><p> {<br></p><p>  //Win2K<br></p><p>  nOffset = KilfGetAddrByCharCode(5,<br></p><p>                                  g_2kCharCode,<br></p><p>                                  nSearchArea,<br></p><p>                                  pSearchAddr);<br></p><p>  if (nOffset == -1)<br></p><p>  {<br></p><p>   return FALSE;<br></p><p>  }<br></p><p>  <br></p><p>  //WinXP<br></p><p>  if (*NtBuildNumber > 2395)<br></p><p>  {<br></p><p>   nOffset = KilfGetAddrByCharCode(4,<br></p><p>                                   g_xpCharCode,<br></p><p>                                   nSearchArea,<br></p><p>                                   pSearchAddr);   <br></p><p>   if (nOffset == -1)<br></p><p>   {<br></p><p>    return FALSE;<br></p><p>   }<br></p><p>   nReplaceNum      = 7;<br></p><p>   pSwapContextAddr = pSearchAddr + nOffset + 2;</p></p><p>&nbsp;&nbsp;}else<br><p>  {<br></p><p>   nReplaceNum      = 5;<br></p><p>   pSwapContextAddr = pSearchAddr + nOffset;<br></p><p>  }<br></p><p> }</p></p><p>&nbsp;if (!pSwapContextAddr)<br><p> {<br></p><p>  return FALSE;<br></p><p> }</p></p><p>&nbsp;char NewSwapContext[9] = {0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90};</p><p>&nbsp;NewSwapContext[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 0xE9;<br><p> <em>((int</em>)&amp;NewSwapContext[1]) = (int)KlifSwapContext - (int)pSwapContextAddr - 5;</p></p><p><br><p> //保存原来的指令<br></p><p> g_SwapContextAddr = pSwapContextAddr + nReplaceNum;//跳回来的地址</p></p><p>&nbsp;for(int i = nReplaceNum; i>0; i--)<br><p> {<br></p><p>  g_SwapContextOpcode[i] = pSwapContextAddr[i];<br></p><p> }<br></p><p> </p></p><p>&nbsp;if (!KlifSetInterruptStauts(pSwapContextAddr, 1, &amp;ProtectMutex))<br><p> {<br></p><p>  return FALSE;<br></p><p> }<br></p><br><p> KlifClearInterruptAndLock(g_kernelLock);<br></p><br><p> //覆盖原来指令<br></p><p> for(i = nReplaceNum; i>0; i&ndash;)<br></p><p> {<br></p><p>  pSwapContextAddr[i] = NewSwapContext[i];<br></p><p> }<br></p><p> KlifUnLock(g_kernelLock);</p></p><p>&nbsp;KlifSetInterruptStauts(pSwapContextAddr, ProtectMutex, &amp;ProtectMutex);</p><p>&nbsp;return TRUE;<br><p>}<br></p><br><p>阐述中存在错误,望指教,谢谢！转载请注明地址 :)<br></p></p><br><br><p>转载于：<font face=Verdana>
<a href=http://blog.vckbase.com/windowssky title=http://blog.vckbase.com/windowssky rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://blog.vckbase.com/windowssky</a></font></p></div><footer class=post-footer><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
AVP主动防御之隐藏进程</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/avp-active-defense-hidden-process/ title=AVP主动防御之隐藏进程>https://blogs.qipai360.cn/post/avp-active-defense-hidden-process/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/timing-in-drive/ rel=next title=驱动中定时><i class="fa fa-chevron-left"></i> 驱动中定时</a></div><div class="post-nav-prev post-nav-item"><a href=/post/boiled-tcpmp/ rel=prev title="水煮TCPMP (转)">水煮TCPMP (转)
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2026
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.157.0 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"avp-active-defense-hidden-process","permalink":"https://blogs.qipai360.cn/post/avp-active-defense-hidden-process/","title":"AVP主动防御之隐藏进程","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1772265585" defer></script></body></html>