<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.152.2"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="DXUT框架剖析（4）"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="direct3d,graphics"><meta property="og:type" content="article"><meta property="og:title" content="DXUT框架剖析（4）"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/dxut-framework-analysis-4/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2008-05-17 11:40:00 +0800 +0800"><meta property="article:modified_time" content="2008-05-17 11:45:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1761990627"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>DXUT框架剖析（4） - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>678</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><ul><li><ul><li></li></ul></li><li><a href=#lpdxutcallbackisd3d9deviceacceptable>LPDXUTCALLBACKISD3D9DEVICEACCEPTABLE</a><ul><li></li></ul></li><li><a href=#idirect3d9checkdeviceformat>IDirect3D9::CheckDeviceFormat</a><ul><li></li></ul></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>678</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>34</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>117</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2418817></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5198></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2025-11-01 14:55:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/dxut-framework-analysis-4/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="DXUT框架剖析（4）"><meta itemprop=description content="创建一个设备
通常可以用标准的Direct3D方法CreateDevice()创建一个Direct3D设备，这个方法需要一个有效的显示适配器、设备类型（硬件抽象层设备或参考设备）、窗口句柄、运行标志（软件/硬件顶点运算模式和其他驱动标志）和提交参数。更重要的是，结构体D3DPRESENT_PARAMETERS有许多成员指定了后台缓冲区的设置、多重采样设置、交换效果、窗口模式、深度缓冲区设置、刷新频率、提交间隔和提交标志等。"></span><header class=post-header><h1 class=post-title itemprop="name headline">DXUT框架剖析（4）</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2008年05月17日 11:40:00 CST" itemprop="dateCreated datePublished" datetime="2008-05-17 11:40:00 +0800 +0800">2008年05月17日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新于>更新于：
</span><time title="修改时间：2008年05月17日 11:45:00 CST" itemprop="dateModified dateLastmod" datetime="2008-05-17 11:45:00 +0800 +0800">2008年05月17日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/gamedev/ itemprop=url rel=index><span itemprop=name>dev/GameDev</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>3143</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>7分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/dxut-framework-analysis-4/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p><strong>创建一个设备</strong></p><p>通常可以用标准的Direct3D方法CreateDevice()创建一个Direct3D设备，这个方法需要一个有效的显示适配器、设备类型（硬件抽象层设备或参考设备）、窗口句柄、运行标志（软件/硬件顶点运算模式和其他驱动标志）和提交参数。更重要的是，结构体D3DPRESENT_PARAMETERS有许多成员指定了后台缓冲区的设置、多重采样设置、交换效果、窗口模式、深度缓冲区设置、刷新频率、提交间隔和提交标志等。</p><a id=more></a><p>为所有的参数选择合适的设置是比较繁琐的，DXUT框架使用函数DXUTCreateDevice()简化了Direct3D设备的创建，该函数的声明如下：</p><p>Creates a Direct3D 9 or Direct3D 10 device.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>HRESULT</span> <span class=nf>DXUTCreateDevice</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=n>bWindowed</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>INT</span> <span class=n>nSuggestedWidth</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>INT</span> <span class=n>nSuggestedHeight</span>
</span></span><span class=line><span class=cl><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><h6 id=parameters>Parameters
<a class=header-anchor href=#parameters></a></h6><p><em>bWindowed</em></p><p>[in] If TRUE, the application will start in windowed mode; if FALSE, the application will start in full-screen mode. The default value is TRUE.</p><p><em>nSuggestedWidth</em></p><p>[in] The requested initial width of the application&rsquo;s back buffer. The actual width may be adjusted to fit device and operating system constraints. The default value is 0.</p><p><em>nSuggestedHeight</em></p><p>[in] The requested initial height of the application&rsquo;s back buffer. The actual height may be adjusted to fit device and operating system constraints. The default value is 0. If both nSuggestedWidth and nSuggestedHeight are zero, the dimension of the client area of the window is used.</p><h6 id=return-values>Return Values
<a class=header-anchor href=#return-values></a></h6><p>If the function succeeds, the return value is S_OK. If the function fails, the return value can be one of the error codes in DXUTERR.</p><h6 id=remarks>Remarks
<a class=header-anchor href=#remarks></a></h6><p>This function creates a new Direct3D 9 or Direct3D 10 device for the application. DXUT will pick the best device for the application based upon what is availble on the system and which Direct3D API version(s) the application supports. The API version(s) that the application supports is detrimined by which device callbacks are set. This logic can be overridden by calling DXUTSetD3DVersionSupport. If both Direct3D 9 and Direct3D 10 are availble on the system and both are supported by the application, then DXUT will favor Direct3D 10.</p><p>Alternately, the application can use the DXUTCreateDeviceFromSettings or handle device creation and pass the desired device to DXUT by using the DXUTSetD3D9Device or DXUTSetD3D10Device function. If neither <strong>DXUTCreateDevice</strong>, <strong>DXUTCreateDeviceFromSettings</strong>, nor <strong>DXUTSetD3D9Device</strong> or <strong>DXUTSetD3D10Device</strong> have been called before calling DXUTMainLoop, DXUT will automatically call <strong>DXUTCreateDevice</strong> using the default parameter values.</p><p>The application can call this method after a device has already been created to change the current device.</p><p>If a device is successfully found, the LPDXUTCALLBACKMODIFYDEVICESETTINGS callback will be called to allow the application to examine or change the device settings before the device is created. This allows an application to modify the device creation settings as it sees fit.</p><p>通过这个简单的调用，DXUT框架创建了一个使用默认设置的Direct3D设备，它可以在大多数情况下使用，默认的设备创建设置如下表所示：</p><p><strong>Direct3D创建标志</strong><br><strong>描述</strong><br><strong>DXUTCreateDevice的默认值</strong></p><p>函数CheckDeviceFormat()的参数AdapterFormat<br>适配器表面格式<br>当前桌面显示模式，如果桌面显示模式不足32位，则使用D3DFMT_X8R8G8B8</p><p>IDirect3D9::CreateDevice()的参数Adapter<br>显示适配器编号<br>D3DADAPTER_DEFAULT</p><p>D3DPRESENT_PARAMETERS.BackBufferCount<br>后台缓冲区数目<br>2，表示有两个后台缓冲区，可实现3倍缓冲。</p><p>D3DPRESENT_PARAMETERS.BackBufferFormat<br>后台缓冲区格式<br>桌面显示模式，如果桌面显示模式不足32位，则使用D3DFMT_X8R8G8B8</p><p>D3DPRESENT_PARAMETERS.AutoDepthStencilFormat<br>设备将自动创建的深度模板表面的深度格式<br>如果后台缓冲区格式小于等于16位，则使用D3DFMT_D16，否则使用D3DFMT_D32。</p><p>IDirect3D9::CreateDevice()函数的参数DeviceType<br>设备类型<br>若D3DDEVTYPE_HAL可行，则使用之，否则使用D3DDEVTYPE_REF，若二者均不可行，则创建失败。</p><p>D3DPRESENT_PARAMETERS.MultiSampleQuality<br>多重采样数量<br>MultiSampleQuality = 0表示禁用多重采样</p><p>D3DPRESENT_PARAMETERS.Flags<br>提交参数标志<br>D3DPRESENTFLAG_DISCARD_DEPTHSTENCIL</p><p>D3DPRESENT_PARAMETERS.PresentationInterval<br>提交间隔<br>窗口模式下为D3DPRESENT_INTERVAL_IMMEDIATE，全屏模式下为D3DPRESENT_INTERVAL_DEFAULT。</p><p>D3DPRESENT_PARAMETERS.FullScreen_RefreshRateInHz<br>显示适配器刷新屏幕的频率<br>0，表示当前桌面设置的刷新频率。</p><p>D3DPRESENT_PARAMETERS.BackBufferWidth和BackBufferHeight<br>显示器分辨率<br>在窗口模式下为640 x 480，全屏模式下为桌面分辨率。</p><p>D3DPRESENT_PARAMETERS.SwapEffect<br>交换效果<br>D3DSWAPEFFECT_DISCARD</p><p>IDirect3D9::CreateDevice()的参数BehaviorFlags<br>顶点运算标志<br>如果硬件支持，就使用D3DCREATE_HARDWARE_VERTEXPROCESSING，否则使用D3DCREATE_SOFTWARE_VERTEXPROCESSING。</p><p>D3DPRESENT_PARAMETERS.Windowed<br>窗口模式或全屏模式<br>TRUE，表示窗口模式</p><p>IDirect3D9::CreateDevice()的参数hFocusWindow<br>创建窗口的句柄<br>DXUTSetWindow函数的参数hWndFocus</p><p>D3DPRESENT_PARAMETERS.hDeviceWindow<br>设备窗口的句柄<br>DXUTSetWindow的参数hWndDeviceFullScreen或hWndDeviceWindowed</p><p>D3DPRESENT_PARAMETERS.EnableAutoDepthStencil<br>深度模板缓冲区创建标志<br>TRUE，表示自动创建深度模板缓冲区</p><p><strong>选择最好的设备设置</strong></p><p>在应用程序中，可以使用DXUTSetCallbackD3D9DeviceAcceptable设置回调函数IsDeviceAcceptable()帮助DXUT框架为应用程序选择最好的设备，该函数的声明如下：</p><p>Sets the Direct3D 9 device acceptable callback function.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>VOID</span> <span class=nf>DXUTSetCallbackD3D9DeviceAcceptable</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>LPDXUTCALLBACKISD3D9DEVICEACCEPTABLE</span> <span class=n>pCallback</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kt>void</span><span class=o>*</span> <span class=n>pUserContext</span>
</span></span><span class=line><span class=cl><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><h6 id=parameters-1>Parameters
<a class=header-anchor href=#parameters-1></a></h6><p><em>pCallback</em></p><p>[in] Pointer to a LPDXUTCALLBACKISD3D9DEVICEACCEPTABLE callback function. If the callback function is supplied, it will be called after the Direct3D 9 device .</p><p><em>pUserContext</em></p><p>[in] Pointer to a user-defined value which is passed to the callback function. Typically used by an application to pass a pointer to a data structure that provides context information for the callback function. The default value is NULL</p><h6 id=return-values-1>Return Values
<a class=header-anchor href=#return-values-1></a></h6><p>No return value.</p><h6 id=remarks-1>Remarks
<a class=header-anchor href=#remarks-1></a></h6><p>This function only needs to be called if the application supports rendering with Direct3D 9 device.</p><p>The <strong>LPDXUTCALLBACKISD3D9DEVICEACCEPTABLE</strong> callback function is the appropriate location for the application to.</p><h3 id=lpdxutcallbackisd3d9deviceacceptable>LPDXUTCALLBACKISD3D9DEVICEACCEPTABLE
<a class=header-anchor href=#lpdxutcallbackisd3d9deviceacceptable></a></h3><p>Application-defined callback function, called by DXUT to build an enumerated list of all possible Direct3D 9 devices. DXUT then selects the best device for creation among this list. This callback function allows the application to prevent unwanted devices from being added to the list.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>bool</span> <span class=nf>LPDXUTCALLBACKISD3D9DEVICEACCEPTABLE</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>D3DCAPS9</span><span class=o>*</span> <span class=n>pCaps</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>D3DFORMAT</span> <span class=n>AdapterFormat</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>D3DFORMAT</span> <span class=n>BackBufferFormat</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=n>bWindowed</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kt>void</span><span class=o>*</span> <span class=n>pUserContext</span>
</span></span><span class=line><span class=cl><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><h6 id=parameters-2>Parameters
<a class=header-anchor href=#parameters-2></a></h6><p><em>pCaps</em></p><p>[in] Pointer to the D3DCAPS9 capabilities of the Direct3D 9 device</p><p><em>AdapterFormat</em></p><p>[in] Format of the Direct3D 9 adapter</p><p><em>BackBufferFormat</em></p><p>[in] Format of the Direct3D 9 backbuffer</p><p><em>bWindowed</em></p><p>[in] Indicates windowed mode. TRUE if the application runs windowed; FALSE if the application runs full-screen.</p><p><em>pUserContext</em></p><p>[in] Pointer to a user-defined value which is passed to the callback function. Typically used by an application to pass a pointer to a data structure that provides context information for the callback function. The default value is NULL</p><h6 id=return-values-2>Return Values
<a class=header-anchor href=#return-values-2></a></h6><p>Program the application to return TRUE if the device settings are acceptable. If not, the application should return FALSE.</p><h6 id=remarks-2>Remarks
<a class=header-anchor href=#remarks-2></a></h6><p>This function&rsquo;s parameters describe a set of unique valid device settings that could be used to create a device. The application can examine and reject this set if desired.</p><p>All possible unique valid combinations of the following device settings are sent to this callback function:</p><ul><li>pCaps</li><li>AdapterFormat</li><li>BackBufferFormat</li><li>bWindowed</li></ul><p>After the application rejects the unwanted device settings combinations, DXUT picks the best of the remaining combinations and uses that best combination to create the device. Before creating the device, DXUT calls LPDXUTCALLBACKMODIFYDEVICESETTINGS to allow the application to change any of the device creation settings.</p><p>应用程序可以使用这个回调函数拒绝任何硬件不支持或不想要的组合。例如，应用程序可以使用下列代码拒绝16位后台缓冲区格式以及所有至少不支持像素渲染2.0版本的设备：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>bool</span> <span class=n>CALLBACK</span> <span class=nf>IsD3D9DeviceAcceptable</span><span class=p>(</span><span class=n>D3DCAPS9</span><span class=o>*</span> <span class=n>pCaps</span><span class=p>,</span> <span class=n>D3DFORMAT</span> <span class=n>AdapterFormat</span><span class=p>,</span> <span class=n>D3DFORMAT</span> <span class=n>BackBufferFormat</span><span class=p>,</span> 
</span></span><span class=line><span class=cl> <span class=kt>bool</span> <span class=n>bWindowed</span><span class=p>,</span> <span class=kt>void</span><span class=o>*</span> <span class=n>pUserContext</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>pCaps</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>PixelShaderVersion</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=nf>D3DPS_VERSION</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>BackBufferFormat</span> <span class=o>==</span> <span class=n>D3DFMT_X1R5G5B5</span> <span class=o>||</span> <span class=n>BackBufferFormat</span> <span class=o>==</span> <span class=n>D3DFMT_R5G6B5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>在回调函数IsD3D9DeviceAcceptable()被每种设置的组合调用之后，框架把这些可以接受的组合分级，并从中选出最优的使用。较高级别的组合包括：</p><p>（1）D3DDEVTYPE_HAL，为了得到硬件加速。</p><p>（2）如果该应用程序运行在全屏模式下，该框架会选择桌面格式所对应的适配器格式，这样从窗口到全屏模式的转换就快多了。例外的是，如果桌面显示模式不足32位，该框架会选择D3DFMT_X8R8G8B8。</p><p>（3）适配器格式所对应的后台缓冲区格式。</p><p>示例程序中，选择设备设置的核心代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>//--------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1>// Rejects any D3D9 devices that aren&#39;t acceptable to the app by returning false.
</span></span></span><span class=line><span class=cl><span class=c1>//--------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>bool</span> <span class=n>CALLBACK</span> <span class=nf>IsD3D9DeviceAcceptable</span><span class=p>(</span><span class=n>D3DCAPS9</span><span class=o>*</span> <span class=n>pCaps</span><span class=p>,</span> <span class=n>D3DFORMAT</span> <span class=n>AdapterFormat</span><span class=p>,</span> <span class=n>D3DFORMAT</span> <span class=n>BackBufferFormat</span><span class=p>,</span> 
</span></span><span class=line><span class=cl> <span class=kt>bool</span> <span class=n>bWindowed</span><span class=p>,</span> <span class=kt>void</span><span class=o>*</span> <span class=n>pUserContext</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Typically want to skip back buffer formats that don&#39;t support alpha blending
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>IDirect3D9</span><span class=o>*</span> <span class=n>pD3D</span> <span class=o>=</span> <span class=nf>DXUTGetD3D9Object</span><span class=p>();</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>    HRESULT CheckDeviceFormat(
</span></span></span><span class=line><span class=cl><span class=cm>    UINT Adapter,
</span></span></span><span class=line><span class=cl><span class=cm>    D3DDEVTYPE DeviceType,
</span></span></span><span class=line><span class=cl><span class=cm>    D3DFORMAT AdapterFormat,
</span></span></span><span class=line><span class=cl><span class=cm>    DWORD Usage,
</span></span></span><span class=line><span class=cl><span class=cm>    D3DRESOURCETYPE RType,
</span></span></span><span class=line><span class=cl><span class=cm>    D3DFORMAT CheckFormat
</span></span></span><span class=line><span class=cl><span class=cm>    );
</span></span></span><span class=line><span class=cl><span class=cm>    /*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nf>FAILED</span><span class=p>(</span><span class=n>pD3D</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=nf>CheckDeviceFormat</span><span class=p>(</span><span class=n>pCaps</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>AdapterOrdinal</span><span class=p>,</span> <span class=n>pCaps</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>DeviceType</span><span class=p>,</span> <span class=n>AdapterFormat</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=n>D3DUSAGE_QUERY_POSTPIXELSHADER_BLENDING</span><span class=p>,</span> <span class=n>D3DRTYPE_TEXTURE</span><span class=p>,</span> <span class=n>BackBufferFormat</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 id=idirect3d9checkdeviceformat>IDirect3D9::CheckDeviceFormat
<a class=header-anchor href=#idirect3d9checkdeviceformat></a></h3><p>Determines whether a surface format is available as a specified resource type and can be used as a texture, depth-stencil buffer, or render target, or any combination of the three, on a device representing this adapter.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6>6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7>7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>HRESULT</span> <span class=nf>CheckDeviceFormat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>UINT</span> <span class=n>Adapter</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>D3DDEVTYPE</span> <span class=n>DeviceType</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>D3DFORMAT</span> <span class=n>AdapterFormat</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>DWORD</span> <span class=n>Usage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>D3DRESOURCETYPE</span> <span class=n>RType</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>D3DFORMAT</span> <span class=n>CheckFormat</span>
</span></span><span class=line><span class=cl><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><h6 id=parameters-3>Parameters
<a class=header-anchor href=#parameters-3></a></h6><p><em>Adapter</em></p><p>[in] Ordinal number denoting the display adapter to query. D3DADAPTER_DEFAULT is always the primary display adapter. This method returns D3DERR_INVALIDCALL when this value equals or exceeds the number of display adapters in the system.</p><p><em>DeviceType</em></p><p>[in] Member of the D3DDEVTYPE enumerated type, identifying the device type.</p><p><em>AdapterFormat</em></p><p>[in] Member of the D3DFORMAT enumerated type, identifying the format of the display mode into which the adapter will be placed.</p><p><em>Usage</em></p><p>[in] Requested usage options for the surface. Usage options are any combination of D3DUSAGE and D3DUSAGE_QUERY constants (only a subset of the <strong>D3DUSAGE</strong> constants are valid for IDirect3D9::CheckDeviceFormat; see the table on the <strong>D3DUSAGE</strong> page).</p><p><em>RType</em></p><p>[in] Resource type requested for use with the queried format. Member of D3DRESOURCETYPE.</p><p><em>CheckFormat</em></p><p>[in] Format of the surfaces which may be used, as defined by Usage. Member of <strong>D3DFORMAT</strong>.</p><h6 id=return-values-3>Return Values
<a class=header-anchor href=#return-values-3></a></h6><p>If the format is compatible with the specified device for the requested usage, this method returns D3D_OK.</p><p>D3DERR_INVALIDCALL is returned if Adapter equals or exceeds the number of display adapters in the system, or if DeviceType is unsupported.</p><p>D3DERR_NOTAVAILABLE is returned if the format is not acceptable to the device for this usage.</p><h6 id=remarks-3>Remarks
<a class=header-anchor href=#remarks-3></a></h6><p>Here are some examples using <strong>IDirect3D9::CheckDeviceFormat</strong> to check for hardware support of:</p><ul><li>An off-screen plain surface format - Specify Usage = 0 and RType = D3DRTYPE_SURFACE.</li><li>A depth-stencil format - The following snippet tests for the passed in depth-stencil format:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>BOOL</span> <span class=nf>IsDepthFormatExisting</span><span class=p>(</span> <span class=n>D3DFORMAT</span> <span class=n>DepthFormat</span><span class=p>,</span> <span class=n>D3DFORMAT</span> <span class=n>AdapterFormat</span> <span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>HRESULT</span> <span class=n>hr</span> <span class=o>=</span> <span class=n>pD3D</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=nf>CheckDeviceFormat</span><span class=p>(</span> <span class=n>D3DADAPTER_DEFAULT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>D3DDEVTYPE_HAL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>AdapterFormat</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>D3DUSAGE_DEPTHSTENCIL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>D3DRTYPE_SURFACE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>DepthFormat</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nf>SUCCEEDED</span><span class=p>(</span> <span class=n>hr</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><pre><code>See Selecting a Device (Direct3D 9) for more detail on the enumeration process.
</code></pre><ul><li>Can this texture be rendered in a particular format - Given the current display mode, this example shows how to verify that the texture format is compatible with the specific back-buffer format:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl>    <span class=n>BOOL</span> <span class=nf>IsTextureFormatOk</span><span class=p>(</span> <span class=n>D3DFORMAT</span> <span class=n>TextureFormat</span><span class=p>,</span> <span class=n>D3DFORMAT</span> <span class=n>AdapterFormat</span> <span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>HRESULT</span> <span class=n>hr</span> <span class=o>=</span> <span class=n>pD3D</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=nf>CheckDeviceFormat</span><span class=p>(</span> <span class=n>D3DADAPTER_DEFAULT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>D3DDEVTYPE_HAL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>AdapterFormat</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>D3DRTYPE_TEXTURE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=n>TextureFormat</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nf>SUCCEEDED</span><span class=p>(</span> <span class=n>hr</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><ul><li>Alpha blending in a pixel shader - Set Usage to <strong>D3DUSAGE_QUERY_POSTPIXELSHADER_BLENDING</strong>. Expect this to fail for all floating-point render targets.</li><li>Autogeneration of mipmaps - Set Usage to <strong>D3DUSAGE_AUTOGENMIPMAP</strong>. If the mipmap automatic generation fails, the application will get a non-mipmapped texture. Calling this method is considered a hint, so this method can return D3DOK_NOAUTOGEN (a valid success code) if the only thing that fails is the mipmap generation. For more information about mipmap generation, see Automatic Generation of Mipmaps (Direct3D 9).</li></ul><p>D3DUSAGE_QUERY_POSTPIXELSHADER_BLENDING<br>Query the resource to verify support for post pixel shader blending support. If IDirect3D9::CheckDeviceFormat fails with D3DUSAGE_QUERY_POSTPIXELSHADER_BLENDING, post pixel blending operations are not supported. These include alpha test, pixel fog, render-target blending, color write enable, and dithering.</p></div><footer class=post-footer><div class=post-tags><a href=/tags/direct3d/>direct3d
</a><a href=/tags/graphics/>graphics</a></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
DXUT框架剖析（4）</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/dxut-framework-analysis-4/ title=DXUT框架剖析（4）>https://blogs.qipai360.cn/post/dxut-framework-analysis-4/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/dxut-framework-analysis-5/ rel=next title=DXUT框架剖析（5）><i class="fa fa-chevron-left"></i> DXUT框架剖析（5）</a></div><div class="post-nav-prev post-nav-item"><a href=/post/dxut-framework-analysis-3/ rel=prev title=DXUT框架剖析（3）>DXUT框架剖析（3）
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.152.2 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"dxut-framework-analysis-4","permalink":"https://blogs.qipai360.cn/post/dxut-framework-analysis-4/","title":"DXUT框架剖析（4）","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1761990624" defer></script><script type=text/javascript src="/js/clipboard.min.js?=1761990627" defer></script></body></html>