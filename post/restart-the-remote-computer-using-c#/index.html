<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.157.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="利用C＃重启远程计算机"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Rise,ZhangTuohui,技术,C++,Unity3D,Lua,NodeJS,C#,JavaScript,游戏开发,机器学习,深度学习,AI,编程,编程语言,编程技术,编程开发,游戏引擎,游戏设计,游戏制作,游戏开发者,游戏开发者博客,游戏开发者网站,游戏开发者工具,游戏开发者教程,游戏开发者学习,游戏开发者交流,游戏开发者分享,游戏开发者经验,游戏开发者心得,游戏开发者技巧,游戏开发者方法,游戏开发者思路,游戏开发者理念,游戏开发者文化,游戏开发者精神,游戏开发者信仰"><meta property="og:type" content="article"><meta property="og:title" content="利用C＃重启远程计算机"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/restart-the-remote-computer-using-c%23/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2004-10-06 16:07:00 +0800 +0800"><meta property="article:modified_time" content="2004-10-10 17:44:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1772265589"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>利用C＃重启远程计算机 - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>679</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><ul><li><a href=#一-c重启远程计算机的一些理论知识>一． C＃重启远程计算机的一些理论知识：</a></li><li><a href=#二程序设计和运行的环境设置>二．程序设计和运行的环境设置：</a></li><li><a href=#三实现重启远程计算机所使用到在net-framework-sdk用以操作wmi名称空间和类>三．实现重启远程计算机所使用到在<code>.Net FrameWork SDK</code>用以操作WMI名称空间和类：</a></li><li><a href=#四c重启远程计算机的重要步骤和实现方法>四．C＃重启远程计算机的重要步骤和实现方法：</a></li><li><a href=#五c实现重启远程计算机的源程序代码bootcs和执行界面>五．C＃实现重启远程计算机的源程序代码（boot.cs）和执行界面：</a></li><li><a href=#六总结>六．总结：</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>679</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>35</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>118</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2423147></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5207></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2026-02-28 15:59:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/restart-the-remote-computer-using-c%23/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="利用C＃重启远程计算机"><meta itemprop=description content="如果叫你实现远程启动别人的计算机，你首先想到的可能是先做一个在远程计算机上面运行客户端程序，然后在本地计算机上面再做一个服务器端程序，通过这二个程序直接的通讯实现重启远程计算机。这当然是一个方法。但这未免有点麻烦。如果现在只告诉你远程计算机的管理者的登陆帐号，而并不允许你在远程的计算机上面运行一个所谓的客户端程序，让你通过程序来完成重启远程计算机。不知道你是否感觉有些困难了。其实按照上面的这些条件实现重启远程计算机，利用C＃可以比较方便的完成。下面就来介绍一下具体的实现方法。"></span><header class=post-header><h1 class=post-title itemprop="name headline">利用C＃重启远程计算机</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2004年10月06日 16:07:00 CST" itemprop="dateCreated datePublished" datetime="2004-10-06 16:07:00 +0800 +0800">2004年10月06日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新于>更新于：
</span><time title="修改时间：2004年10月10日 17:44:00 CST" itemprop="dateModified dateLastmod" datetime="2004-10-10 17:44:00 +0800 +0800">2004年10月10日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/donet/ itemprop=url rel=index><span itemprop=name>dev/doNet</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>2819</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>6分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/restart-the-remote-computer-using-c%23/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>如果叫你实现远程启动别人的计算机，你首先想到的可能是先做一个在远程计算机上面运行客户端程序，然后在本地计算机上面再做一个服务器端程序，通过这二个程序直接的通讯实现重启远程计算机。这当然是一个方法。但这未免有点麻烦。如果现在只告诉你远程计算机的管理者的登陆帐号，而并不允许你在远程的计算机上面运行一个所谓的客户端程序，让你通过程序来完成重启远程计算机。不知道你是否感觉有些困难了。其实按照上面的这些条件实现重启远程计算机，利用C＃可以比较方便的完成。下面就来介绍一下具体的实现方法。</p><a id=more></a><h3 id=一-c重启远程计算机的一些理论知识>一． C＃重启远程计算机的一些理论知识：
<a class=header-anchor href=#%e4%b8%80-c%e9%87%8d%e5%90%af%e8%bf%9c%e7%a8%8b%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%9a%84%e4%b8%80%e4%ba%9b%e7%90%86%e8%ae%ba%e7%9f%a5%e8%af%86></a></h3><p>C＃实现启动远程计算机的原理是"视窗管理规范"。就是所谓的"WMI"（Windows Management Instrumentation）。Windows 管理规范 (WMI) 支持通过 Internet 管理系统的结构。通过提供管理环境的一致观察，WMI 为用户提供通用访问管理信息。该管理的一致性使您能够管理整个系统，而不只是组件。从<code>Microsoft MSDN</code>上，您可以获得有关 WMI 软件开发工具包 (SDK) 的详细信息。
WMI（Windows 管理规范）支持有限的安全格式，允许用户在本地计算机或远程计算机上连接 WMI 之前要验证每个用户。这种安全性是操作系统已有的安全顶端的另一层。WMI 不覆盖或破坏由操作系统提供的任何现有的安全性。在默认情况下，管理员组的所有成员都可以完全控制它管理的计算机上的 WMI 服务。其他所有用户在其本地计算机上只有读取/写入/执行的权限。可以通过向被管理的计算机上的管理员组添加用户，或者在 WMI 中授权用户或组并设置权限级别来更改权限。访问基于 WMI 名称空间。在一般情况下，脚本程序的默认命名空间是"root\cimv2"。
在WMI中有着许多足以令我们感觉惊奇的功能。重启远程计算机只是一个很小的功能。在程序中使用WMI可以编写出许多远程管理类型的应用程序。由于在<code>.Net FrameWork SDK</code>中提供了可以直接操作WMI的名称空间，所以C＃就可以利用在这些名称空间中定义了的类来充分使用WMI控制给我们带来的各种方便。</p><h3 id=二程序设计和运行的环境设置>二．程序设计和运行的环境设置：
<a class=header-anchor href=#%e4%ba%8c%e7%a8%8b%e5%ba%8f%e8%ae%be%e8%ae%a1%e5%92%8c%e8%bf%90%e8%a1%8c%e7%9a%84%e7%8e%af%e5%a2%83%e8%ae%be%e7%bd%ae></a></h3><p>（1）windows 2000 Professional
（2）.Net FrameWork SDK
（3）远程计算机的管理者帐号
以上这些不仅是本地计算机配置，还是远程计算机的配置。</p><h3 id=三实现重启远程计算机所使用到在net-framework-sdk用以操作wmi名称空间和类>三．实现重启远程计算机所使用到在<code>.Net FrameWork SDK</code>用以操作WMI名称空间和类：
<a class=header-anchor href=#%e4%b8%89%e5%ae%9e%e7%8e%b0%e9%87%8d%e5%90%af%e8%bf%9c%e7%a8%8b%e8%ae%a1%e7%ae%97%e6%9c%ba%e6%89%80%e4%bd%bf%e7%94%a8%e5%88%b0%e5%9c%a8net-framework-sdk%e7%94%a8%e4%bb%a5%e6%93%8d%e4%bd%9cwmi%e5%90%8d%e7%a7%b0%e7%a9%ba%e9%97%b4%e5%92%8c%e7%b1%bb></a></h3><p>添加引用System.Management; 在<code>.Net FrameWork SDK</code>中用来操作WMI的名称空间主要是"System.Management"。要实现重启远程计算机所使用到的类主要有六个：</p><ul><li>&ldquo;ConnectionOptions"类主要定义远程计算机的管理员帐号；</li><li>&ldquo;ManagementScope"主要是以给定的管理员帐号连接给定计算机名或者IP地址的计算机；</li><li>&ldquo;ObjectQuery"类功能是定义对远程计算机要实现那些地远程操作；</li><li>&ldquo;ManagementObjectSearcher"类从已经完成远程连接的计算机中，得到有那些WMI操作；</li><li>&ldquo;ManagementObjectCollection"类存放得到WMI操作；</li><li>&ldquo;ManagementObject"类调用远程计算机可进行WMI操作。
在本文介绍的操作就是重启操作。</li></ul><h3 id=四c重启远程计算机的重要步骤和实现方法>四．C＃重启远程计算机的重要步骤和实现方法：
<a class=header-anchor href=#%e5%9b%9bc%e9%87%8d%e5%90%af%e8%bf%9c%e7%a8%8b%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%9a%84%e9%87%8d%e8%a6%81%e6%ad%a5%e9%aa%a4%e5%92%8c%e5%ae%9e%e7%8e%b0%e6%96%b9%e6%b3%95></a></h3><p>（1）连接远程计算机：
按照下列语句可以实现连接远程计算机：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=n>ConnectionOptions</span> <span class=n>options</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ConnectionOptions</span> <span class=p>(</span> <span class=p>)</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>options</span><span class=p>.</span><span class=n>Username</span> <span class=p>=</span><span class=s>&#34;管理者帐号用户名&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>options</span><span class=p>.</span><span class=n>Password</span> <span class=p>=</span> <span class=s>&#34;管理者帐号口令&#34;</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>ManagementScope</span> <span class=n>scope</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ManagementScope</span><span class=p>(</span> <span class=s>&#34;\\&#34;</span> <span class=p>+</span> <span class=s>&#34;远程计算机名或IP地址&#34;</span> <span class=p>+</span> <span class=s>&#34;\root\cimv2&#34;</span><span class=p>,</span> <span class=n>options</span> <span class=p>)</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//用给定管理者用户名和口令连接远程的计算机</span>
</span></span><span class=line><span class=cl><span class=n>scope</span><span class=p>.</span><span class=n>Connect</span> <span class=p>(</span> <span class=p>)</span> <span class=p>;</span> </span></span></code></pre></td></tr></table></div></div><p>（2）得到在远程计算机中可以进行WMI控制：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>ObjectQuery</span> <span class=n>oq</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>ObjectQuery</span> <span class=p>(</span> <span class=s>&#34;SELECT * FROM Win32_OperatingSystem&#34;</span> <span class=p>)</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>ManagementObjectSearcher</span> <span class=n>query1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ManagementObjectSearcher</span> <span class=p>(</span> <span class=n>scope</span> <span class=p>,</span> <span class=n>oq</span> <span class=p>)</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//得到WMI控制</span>
</span></span><span class=line><span class=cl><span class=n>ManagementObjectCollection</span> <span class=n>queryCollection1</span> <span class=p>=</span> <span class=n>query1</span><span class=p>.</span><span class=n>Get</span> <span class=p>(</span> <span class=p>)</span> <span class=p>;</span> </span></span></code></pre></td></tr></table></div></div><p>（3）调用WMI控制，实现重启远程计算机：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span> <span class=n>ManagementObject</span> <span class=n>mo</span> <span class=k>in</span> <span class=n>queryCollection1</span> <span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>string</span> <span class=p>[</span> <span class=p>]</span> <span class=n>ss</span><span class=p>=</span> <span class=p>{</span> <span class=s>&#34;&#34;</span> <span class=p>}</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//重启远程计算机</span>
</span></span><span class=line><span class=cl><span class=n>mo</span><span class=p>.</span><span class=n>InvokeMethod</span> <span class=p>(</span> <span class=s>&#34;Reboot&#34;</span> <span class=p>,</span> <span class=n>ss</span> <span class=p>)</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 id=五c实现重启远程计算机的源程序代码bootcs和执行界面>五．C＃实现重启远程计算机的源程序代码（boot.cs）和执行界面：
<a class=header-anchor href=#%e4%ba%94c%e5%ae%9e%e7%8e%b0%e9%87%8d%e5%90%af%e8%bf%9c%e7%a8%8b%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%9a%84%e6%ba%90%e7%a8%8b%e5%ba%8f%e4%bb%a3%e7%a0%81bootcs%e5%92%8c%e6%89%a7%e8%a1%8c%e7%95%8c%e9%9d%a2></a></h3><p>在了解了C＃实现重启远程计算机的这些重要步骤后，就可以从容的得到重启远程计算机的完整代码，具体如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>  1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>  2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>  3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>  4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>  5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6>  6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7>  7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8>  8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9>  9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10> 10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11> 11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12> 12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13> 13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14> 14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15> 15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16> 16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17> 17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18> 18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19> 19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20> 20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21> 21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22> 22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23> 23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24> 24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25> 25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26> 26</a>
</span><span class=lnt id=hl-3-27><a class=lnlinks href=#hl-3-27> 27</a>
</span><span class=lnt id=hl-3-28><a class=lnlinks href=#hl-3-28> 28</a>
</span><span class=lnt id=hl-3-29><a class=lnlinks href=#hl-3-29> 29</a>
</span><span class=lnt id=hl-3-30><a class=lnlinks href=#hl-3-30> 30</a>
</span><span class=lnt id=hl-3-31><a class=lnlinks href=#hl-3-31> 31</a>
</span><span class=lnt id=hl-3-32><a class=lnlinks href=#hl-3-32> 32</a>
</span><span class=lnt id=hl-3-33><a class=lnlinks href=#hl-3-33> 33</a>
</span><span class=lnt id=hl-3-34><a class=lnlinks href=#hl-3-34> 34</a>
</span><span class=lnt id=hl-3-35><a class=lnlinks href=#hl-3-35> 35</a>
</span><span class=lnt id=hl-3-36><a class=lnlinks href=#hl-3-36> 36</a>
</span><span class=lnt id=hl-3-37><a class=lnlinks href=#hl-3-37> 37</a>
</span><span class=lnt id=hl-3-38><a class=lnlinks href=#hl-3-38> 38</a>
</span><span class=lnt id=hl-3-39><a class=lnlinks href=#hl-3-39> 39</a>
</span><span class=lnt id=hl-3-40><a class=lnlinks href=#hl-3-40> 40</a>
</span><span class=lnt id=hl-3-41><a class=lnlinks href=#hl-3-41> 41</a>
</span><span class=lnt id=hl-3-42><a class=lnlinks href=#hl-3-42> 42</a>
</span><span class=lnt id=hl-3-43><a class=lnlinks href=#hl-3-43> 43</a>
</span><span class=lnt id=hl-3-44><a class=lnlinks href=#hl-3-44> 44</a>
</span><span class=lnt id=hl-3-45><a class=lnlinks href=#hl-3-45> 45</a>
</span><span class=lnt id=hl-3-46><a class=lnlinks href=#hl-3-46> 46</a>
</span><span class=lnt id=hl-3-47><a class=lnlinks href=#hl-3-47> 47</a>
</span><span class=lnt id=hl-3-48><a class=lnlinks href=#hl-3-48> 48</a>
</span><span class=lnt id=hl-3-49><a class=lnlinks href=#hl-3-49> 49</a>
</span><span class=lnt id=hl-3-50><a class=lnlinks href=#hl-3-50> 50</a>
</span><span class=lnt id=hl-3-51><a class=lnlinks href=#hl-3-51> 51</a>
</span><span class=lnt id=hl-3-52><a class=lnlinks href=#hl-3-52> 52</a>
</span><span class=lnt id=hl-3-53><a class=lnlinks href=#hl-3-53> 53</a>
</span><span class=lnt id=hl-3-54><a class=lnlinks href=#hl-3-54> 54</a>
</span><span class=lnt id=hl-3-55><a class=lnlinks href=#hl-3-55> 55</a>
</span><span class=lnt id=hl-3-56><a class=lnlinks href=#hl-3-56> 56</a>
</span><span class=lnt id=hl-3-57><a class=lnlinks href=#hl-3-57> 57</a>
</span><span class=lnt id=hl-3-58><a class=lnlinks href=#hl-3-58> 58</a>
</span><span class=lnt id=hl-3-59><a class=lnlinks href=#hl-3-59> 59</a>
</span><span class=lnt id=hl-3-60><a class=lnlinks href=#hl-3-60> 60</a>
</span><span class=lnt id=hl-3-61><a class=lnlinks href=#hl-3-61> 61</a>
</span><span class=lnt id=hl-3-62><a class=lnlinks href=#hl-3-62> 62</a>
</span><span class=lnt id=hl-3-63><a class=lnlinks href=#hl-3-63> 63</a>
</span><span class=lnt id=hl-3-64><a class=lnlinks href=#hl-3-64> 64</a>
</span><span class=lnt id=hl-3-65><a class=lnlinks href=#hl-3-65> 65</a>
</span><span class=lnt id=hl-3-66><a class=lnlinks href=#hl-3-66> 66</a>
</span><span class=lnt id=hl-3-67><a class=lnlinks href=#hl-3-67> 67</a>
</span><span class=lnt id=hl-3-68><a class=lnlinks href=#hl-3-68> 68</a>
</span><span class=lnt id=hl-3-69><a class=lnlinks href=#hl-3-69> 69</a>
</span><span class=lnt id=hl-3-70><a class=lnlinks href=#hl-3-70> 70</a>
</span><span class=lnt id=hl-3-71><a class=lnlinks href=#hl-3-71> 71</a>
</span><span class=lnt id=hl-3-72><a class=lnlinks href=#hl-3-72> 72</a>
</span><span class=lnt id=hl-3-73><a class=lnlinks href=#hl-3-73> 73</a>
</span><span class=lnt id=hl-3-74><a class=lnlinks href=#hl-3-74> 74</a>
</span><span class=lnt id=hl-3-75><a class=lnlinks href=#hl-3-75> 75</a>
</span><span class=lnt id=hl-3-76><a class=lnlinks href=#hl-3-76> 76</a>
</span><span class=lnt id=hl-3-77><a class=lnlinks href=#hl-3-77> 77</a>
</span><span class=lnt id=hl-3-78><a class=lnlinks href=#hl-3-78> 78</a>
</span><span class=lnt id=hl-3-79><a class=lnlinks href=#hl-3-79> 79</a>
</span><span class=lnt id=hl-3-80><a class=lnlinks href=#hl-3-80> 80</a>
</span><span class=lnt id=hl-3-81><a class=lnlinks href=#hl-3-81> 81</a>
</span><span class=lnt id=hl-3-82><a class=lnlinks href=#hl-3-82> 82</a>
</span><span class=lnt id=hl-3-83><a class=lnlinks href=#hl-3-83> 83</a>
</span><span class=lnt id=hl-3-84><a class=lnlinks href=#hl-3-84> 84</a>
</span><span class=lnt id=hl-3-85><a class=lnlinks href=#hl-3-85> 85</a>
</span><span class=lnt id=hl-3-86><a class=lnlinks href=#hl-3-86> 86</a>
</span><span class=lnt id=hl-3-87><a class=lnlinks href=#hl-3-87> 87</a>
</span><span class=lnt id=hl-3-88><a class=lnlinks href=#hl-3-88> 88</a>
</span><span class=lnt id=hl-3-89><a class=lnlinks href=#hl-3-89> 89</a>
</span><span class=lnt id=hl-3-90><a class=lnlinks href=#hl-3-90> 90</a>
</span><span class=lnt id=hl-3-91><a class=lnlinks href=#hl-3-91> 91</a>
</span><span class=lnt id=hl-3-92><a class=lnlinks href=#hl-3-92> 92</a>
</span><span class=lnt id=hl-3-93><a class=lnlinks href=#hl-3-93> 93</a>
</span><span class=lnt id=hl-3-94><a class=lnlinks href=#hl-3-94> 94</a>
</span><span class=lnt id=hl-3-95><a class=lnlinks href=#hl-3-95> 95</a>
</span><span class=lnt id=hl-3-96><a class=lnlinks href=#hl-3-96> 96</a>
</span><span class=lnt id=hl-3-97><a class=lnlinks href=#hl-3-97> 97</a>
</span><span class=lnt id=hl-3-98><a class=lnlinks href=#hl-3-98> 98</a>
</span><span class=lnt id=hl-3-99><a class=lnlinks href=#hl-3-99> 99</a>
</span><span class=lnt id=hl-3-100><a class=lnlinks href=#hl-3-100>100</a>
</span><span class=lnt id=hl-3-101><a class=lnlinks href=#hl-3-101>101</a>
</span><span class=lnt id=hl-3-102><a class=lnlinks href=#hl-3-102>102</a>
</span><span class=lnt id=hl-3-103><a class=lnlinks href=#hl-3-103>103</a>
</span><span class=lnt id=hl-3-104><a class=lnlinks href=#hl-3-104>104</a>
</span><span class=lnt id=hl-3-105><a class=lnlinks href=#hl-3-105>105</a>
</span><span class=lnt id=hl-3-106><a class=lnlinks href=#hl-3-106>106</a>
</span><span class=lnt id=hl-3-107><a class=lnlinks href=#hl-3-107>107</a>
</span><span class=lnt id=hl-3-108><a class=lnlinks href=#hl-3-108>108</a>
</span><span class=lnt id=hl-3-109><a class=lnlinks href=#hl-3-109>109</a>
</span><span class=lnt id=hl-3-110><a class=lnlinks href=#hl-3-110>110</a>
</span><span class=lnt id=hl-3-111><a class=lnlinks href=#hl-3-111>111</a>
</span><span class=lnt id=hl-3-112><a class=lnlinks href=#hl-3-112>112</a>
</span><span class=lnt id=hl-3-113><a class=lnlinks href=#hl-3-113>113</a>
</span><span class=lnt id=hl-3-114><a class=lnlinks href=#hl-3-114>114</a>
</span><span class=lnt id=hl-3-115><a class=lnlinks href=#hl-3-115>115</a>
</span><span class=lnt id=hl-3-116><a class=lnlinks href=#hl-3-116>116</a>
</span><span class=lnt id=hl-3-117><a class=lnlinks href=#hl-3-117>117</a>
</span><span class=lnt id=hl-3-118><a class=lnlinks href=#hl-3-118>118</a>
</span><span class=lnt id=hl-3-119><a class=lnlinks href=#hl-3-119>119</a>
</span><span class=lnt id=hl-3-120><a class=lnlinks href=#hl-3-120>120</a>
</span><span class=lnt id=hl-3-121><a class=lnlinks href=#hl-3-121>121</a>
</span><span class=lnt id=hl-3-122><a class=lnlinks href=#hl-3-122>122</a>
</span><span class=lnt id=hl-3-123><a class=lnlinks href=#hl-3-123>123</a>
</span><span class=lnt id=hl-3-124><a class=lnlinks href=#hl-3-124>124</a>
</span><span class=lnt id=hl-3-125><a class=lnlinks href=#hl-3-125>125</a>
</span><span class=lnt id=hl-3-126><a class=lnlinks href=#hl-3-126>126</a>
</span><span class=lnt id=hl-3-127><a class=lnlinks href=#hl-3-127>127</a>
</span><span class=lnt id=hl-3-128><a class=lnlinks href=#hl-3-128>128</a>
</span><span class=lnt id=hl-3-129><a class=lnlinks href=#hl-3-129>129</a>
</span><span class=lnt id=hl-3-130><a class=lnlinks href=#hl-3-130>130</a>
</span><span class=lnt id=hl-3-131><a class=lnlinks href=#hl-3-131>131</a>
</span><span class=lnt id=hl-3-132><a class=lnlinks href=#hl-3-132>132</a>
</span><span class=lnt id=hl-3-133><a class=lnlinks href=#hl-3-133>133</a>
</span><span class=lnt id=hl-3-134><a class=lnlinks href=#hl-3-134>134</a>
</span><span class=lnt id=hl-3-135><a class=lnlinks href=#hl-3-135>135</a>
</span><span class=lnt id=hl-3-136><a class=lnlinks href=#hl-3-136>136</a>
</span><span class=lnt id=hl-3-137><a class=lnlinks href=#hl-3-137>137</a>
</span><span class=lnt id=hl-3-138><a class=lnlinks href=#hl-3-138>138</a>
</span><span class=lnt id=hl-3-139><a class=lnlinks href=#hl-3-139>139</a>
</span><span class=lnt id=hl-3-140><a class=lnlinks href=#hl-3-140>140</a>
</span><span class=lnt id=hl-3-141><a class=lnlinks href=#hl-3-141>141</a>
</span><span class=lnt id=hl-3-142><a class=lnlinks href=#hl-3-142>142</a>
</span><span class=lnt id=hl-3-143><a class=lnlinks href=#hl-3-143>143</a>
</span><span class=lnt id=hl-3-144><a class=lnlinks href=#hl-3-144>144</a>
</span><span class=lnt id=hl-3-145><a class=lnlinks href=#hl-3-145>145</a>
</span><span class=lnt id=hl-3-146><a class=lnlinks href=#hl-3-146>146</a>
</span><span class=lnt id=hl-3-147><a class=lnlinks href=#hl-3-147>147</a>
</span><span class=lnt id=hl-3-148><a class=lnlinks href=#hl-3-148>148</a>
</span><span class=lnt id=hl-3-149><a class=lnlinks href=#hl-3-149>149</a>
</span><span class=lnt id=hl-3-150><a class=lnlinks href=#hl-3-150>150</a>
</span><span class=lnt id=hl-3-151><a class=lnlinks href=#hl-3-151>151</a>
</span><span class=lnt id=hl-3-152><a class=lnlinks href=#hl-3-152>152</a>
</span><span class=lnt id=hl-3-153><a class=lnlinks href=#hl-3-153>153</a>
</span><span class=lnt id=hl-3-154><a class=lnlinks href=#hl-3-154>154</a>
</span><span class=lnt id=hl-3-155><a class=lnlinks href=#hl-3-155>155</a>
</span><span class=lnt id=hl-3-156><a class=lnlinks href=#hl-3-156>156</a>
</span><span class=lnt id=hl-3-157><a class=lnlinks href=#hl-3-157>157</a>
</span><span class=lnt id=hl-3-158><a class=lnlinks href=#hl-3-158>158</a>
</span><span class=lnt id=hl-3-159><a class=lnlinks href=#hl-3-159>159</a>
</span><span class=lnt id=hl-3-160><a class=lnlinks href=#hl-3-160>160</a>
</span><span class=lnt id=hl-3-161><a class=lnlinks href=#hl-3-161>161</a>
</span><span class=lnt id=hl-3-162><a class=lnlinks href=#hl-3-162>162</a>
</span><span class=lnt id=hl-3-163><a class=lnlinks href=#hl-3-163>163</a>
</span><span class=lnt id=hl-3-164><a class=lnlinks href=#hl-3-164>164</a>
</span><span class=lnt id=hl-3-165><a class=lnlinks href=#hl-3-165>165</a>
</span><span class=lnt id=hl-3-166><a class=lnlinks href=#hl-3-166>166</a>
</span><span class=lnt id=hl-3-167><a class=lnlinks href=#hl-3-167>167</a>
</span><span class=lnt id=hl-3-168><a class=lnlinks href=#hl-3-168>168</a>
</span><span class=lnt id=hl-3-169><a class=lnlinks href=#hl-3-169>169</a>
</span><span class=lnt id=hl-3-170><a class=lnlinks href=#hl-3-170>170</a>
</span><span class=lnt id=hl-3-171><a class=lnlinks href=#hl-3-171>171</a>
</span><span class=lnt id=hl-3-172><a class=lnlinks href=#hl-3-172>172</a>
</span><span class=lnt id=hl-3-173><a class=lnlinks href=#hl-3-173>173</a>
</span><span class=lnt id=hl-3-174><a class=lnlinks href=#hl-3-174>174</a>
</span><span class=lnt id=hl-3-175><a class=lnlinks href=#hl-3-175>175</a>
</span><span class=lnt id=hl-3-176><a class=lnlinks href=#hl-3-176>176</a>
</span><span class=lnt id=hl-3-177><a class=lnlinks href=#hl-3-177>177</a>
</span><span class=lnt id=hl-3-178><a class=lnlinks href=#hl-3-178>178</a>
</span><span class=lnt id=hl-3-179><a class=lnlinks href=#hl-3-179>179</a>
</span><span class=lnt id=hl-3-180><a class=lnlinks href=#hl-3-180>180</a>
</span><span class=lnt id=hl-3-181><a class=lnlinks href=#hl-3-181>181</a>
</span><span class=lnt id=hl-3-182><a class=lnlinks href=#hl-3-182>182</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=k>using</span> <span class=nn>System</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Drawing</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Collections</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.ComponentModel</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Windows.Forms</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Data</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Management</span><span class=p>;&lt;/</span><span class=n>P</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>ReStartboot</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl> <span class=cs>/// Form1 的摘要说明。</span>
</span></span><span class=line><span class=cl> <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl> <span class=kd>public</span> <span class=k>class</span> <span class=nc>Form1</span> <span class=p>:</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Form</span>
</span></span><span class=line><span class=cl> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Printing</span><span class=p>.</span><span class=n>PrintDocument</span> <span class=n>printDocument1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Label</span> <span class=n>label1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Label</span> <span class=n>label2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Label</span> <span class=n>label3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>TextBox</span> <span class=n>textBox1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>TextBox</span> <span class=n>textBox2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>TextBox</span> <span class=n>textBox3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Button</span> <span class=n>button1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// 必需的设计器变量。</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=n>System</span><span class=p>.</span><span class=n>ComponentModel</span><span class=p>.</span><span class=n>Container</span> <span class=n>components</span> <span class=p>=</span> <span class=kc>null</span><span class=p>;&lt;/</span><span class=n>P</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=n>Form1</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=c1>//</span>
</span></span><span class=line><span class=cl>   <span class=c1>// Windows 窗体设计器支持所必需的</span>
</span></span><span class=line><span class=cl>   <span class=c1>//</span>
</span></span><span class=line><span class=cl>   <span class=n>InitializeComponent</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=c1>//</span>
</span></span><span class=line><span class=cl>   <span class=c1>// TODO: 在 InitializeComponent 调用后添加任何构造函数代码</span>
</span></span><span class=line><span class=cl>   <span class=c1>//</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// 清理所有正在使用的资源。</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kd>protected</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>Dispose</span><span class=p>(</span> <span class=kt>bool</span> <span class=n>disposing</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>if</span><span class=p>(</span> <span class=n>disposing</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>components</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=n>components</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=k>base</span><span class=p>.</span><span class=n>Dispose</span><span class=p>(</span> <span class=n>disposing</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#region</span> <span class=n>Windows</span> <span class=n>Form</span> <span class=n>Designer</span> <span class=n>generated</span> <span class=n>code</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// 设计器支持所需的方法 - 不要使用代码编辑器修改</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// 此方法的内容。</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=k>void</span> <span class=n>InitializeComponent</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>printDocument1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Printing</span><span class=p>.</span><span class=n>PrintDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Label</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label2</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Label</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label3</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Label</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>TextBox</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox2</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>TextBox</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox3</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>TextBox</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>button1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Button</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>SuspendLayout</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// label1</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label1</span><span class=p>.</span><span class=n>Location</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=m>16</span><span class=p>,</span> <span class=m>32</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label1</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;label1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label1</span><span class=p>.</span><span class=n>Size</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Size</span><span class=p>(</span><span class=m>120</span><span class=p>,</span> <span class=m>23</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label1</span><span class=p>.</span><span class=n>TabIndex</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label1</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;远程计算机名或IP：&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label1</span><span class=p>.</span><span class=n>TextAlign</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>ContentAlignment</span><span class=p>.</span><span class=n>MiddleRight</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// label2</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label2</span><span class=p>.</span><span class=n>Anchor</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>AnchorStyles</span><span class=p>.</span><span class=n>Top</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label2</span><span class=p>.</span><span class=n>Location</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=m>32</span><span class=p>,</span> <span class=m>80</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label2</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;label2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label2</span><span class=p>.</span><span class=n>TabIndex</span> <span class=p>=</span> <span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label2</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;管理员名：&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label2</span><span class=p>.</span><span class=n>TextAlign</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>ContentAlignment</span><span class=p>.</span><span class=n>MiddleRight</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// label3</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label3</span><span class=p>.</span><span class=n>Location</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=m>32</span><span class=p>,</span> <span class=m>128</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label3</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;label3&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label3</span><span class=p>.</span><span class=n>TabIndex</span> <span class=p>=</span> <span class=m>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label3</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;密码：&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>label3</span><span class=p>.</span><span class=n>TextAlign</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>ContentAlignment</span><span class=p>.</span><span class=n>MiddleRight</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// textBox1</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox1</span><span class=p>.</span><span class=n>Location</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=m>136</span><span class=p>,</span> <span class=m>32</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox1</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;textBox1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox1</span><span class=p>.</span><span class=n>Size</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Size</span><span class=p>(</span><span class=m>152</span><span class=p>,</span> <span class=m>21</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox1</span><span class=p>.</span><span class=n>TabIndex</span> <span class=p>=</span> <span class=m>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox1</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// textBox2</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox2</span><span class=p>.</span><span class=n>Location</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=m>136</span><span class=p>,</span> <span class=m>80</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox2</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;textBox2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox2</span><span class=p>.</span><span class=n>Size</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Size</span><span class=p>(</span><span class=m>152</span><span class=p>,</span> <span class=m>21</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox2</span><span class=p>.</span><span class=n>TabIndex</span> <span class=p>=</span> <span class=m>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox2</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// textBox3</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox3</span><span class=p>.</span><span class=n>Location</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=m>136</span><span class=p>,</span> <span class=m>128</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox3</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;textBox3&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox3</span><span class=p>.</span><span class=n>Size</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Size</span><span class=p>(</span><span class=m>152</span><span class=p>,</span> <span class=m>21</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox3</span><span class=p>.</span><span class=n>TabIndex</span> <span class=p>=</span> <span class=m>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>textBox3</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// button1</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>button1</span><span class=p>.</span><span class=n>Location</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=m>104</span><span class=p>,</span> <span class=m>168</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>button1</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;button1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>button1</span><span class=p>.</span><span class=n>Size</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Size</span><span class=p>(</span><span class=m>120</span><span class=p>,</span> <span class=m>23</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>button1</span><span class=p>.</span><span class=n>TabIndex</span> <span class=p>=</span> <span class=m>6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>button1</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;重启远程计算机&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>button1</span><span class=p>.</span><span class=n>Click</span> <span class=p>+=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>EventHandler</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>button1_Click</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=c1>// Form1</span>
</span></span><span class=line><span class=cl>   <span class=c1>// </span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>AutoScaleBaseSize</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Size</span><span class=p>(</span><span class=m>6</span><span class=p>,</span> <span class=m>14</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>ClientSize</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Size</span><span class=p>(</span><span class=m>320</span><span class=p>,</span> <span class=m>213</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>Controls</span><span class=p>.</span><span class=n>AddRange</span><span class=p>(</span><span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Control</span><span class=p>[]</span> <span class=p>{</span>         <span class=k>this</span><span class=p>.</span><span class=n>label1</span><span class=p>});</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>Name</span> <span class=p>=</span> <span class=s>&#34;Form1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=s>&#34;重启远程计算机&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>this</span><span class=p>.</span><span class=n>ResumeLayout</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=cp>#endregion</span><span class=p>&lt;/</span><span class=n>P</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// 应用程序的主入口点。</span>
</span></span><span class=line><span class=cl>  <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=na>  [STAThread]</span>
</span></span><span class=line><span class=cl>  <span class=kd>static</span> <span class=k>void</span> <span class=n>Main</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=n>Application</span><span class=p>.</span><span class=n>Run</span><span class=p>(</span><span class=k>new</span> <span class=n>Form1</span><span class=p>());</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=k>void</span> <span class=n>button1_Click</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>System</span><span class=p>.</span><span class=n>EventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=c1>//定义连接远程计算机的一些选项</span>
</span></span><span class=line><span class=cl>   <span class=n>ConnectionOptions</span> <span class=n>options</span><span class=p>=</span><span class=k>new</span> <span class=n>ConnectionOptions</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   <span class=n>options</span><span class=p>.</span><span class=n>Username</span><span class=p>=</span><span class=n>textBox2</span><span class=p>.</span><span class=n>Text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=n>options</span><span class=p>.</span><span class=n>Password</span><span class=p>=</span><span class=n>textBox3</span><span class=p>.</span><span class=n>Text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=n>ManagementScope</span> <span class=n>scope</span><span class=p>=</span><span class=k>new</span> <span class=n>ManagementScope</span><span class=p>(</span><span class=s>&#34;&lt;A&gt;\\\\&#34;</span><span class=p>+</span><span class=n>textBox1</span><span class=p>.</span><span class=n>Text</span><span class=p>+</span><span class=s>&#34;\\root\\cimv2&#34;</span><span class=p>,</span><span class=n>options</span><span class=p>&lt;/</span><span class=n>A</span><span class=p>&gt;);</span>
</span></span><span class=line><span class=cl>   <span class=k>try</span>
</span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//用给定管理者用户名和口令连接远程的计算机</span>
</span></span><span class=line><span class=cl>    <span class=n>scope</span><span class=p>.</span><span class=n>Connect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>ObjectQuery</span> <span class=n>oq</span><span class=p>=</span><span class=k>new</span> <span class=n>ObjectQuery</span><span class=p>(</span><span class=s>&#34;select * from win32_OperatingSystem&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ManagementObjectSearcher</span> <span class=n>query1</span><span class=p>=</span><span class=k>new</span> <span class=n>ManagementObjectSearcher</span><span class=p>(</span><span class=n>scope</span><span class=p>,</span><span class=n>oq</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ManagementObjectCollection</span> <span class=n>queryCollection1</span><span class=p>=</span><span class=n>query1</span><span class=p>.</span><span class=n>Get</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span><span class=p>(</span><span class=n>ManagementObject</span> <span class=n>mo</span> <span class=k>in</span> <span class=n>queryCollection1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=kt>string</span><span class=p>[]</span> <span class=n>ss</span><span class=p>={</span><span class=s>&#34;&#34;</span><span class=p>};</span>
</span></span><span class=line><span class=cl>     <span class=n>mo</span><span class=p>.</span><span class=n>InvokeMethod</span><span class=p>(</span><span class=s>&#34;Reboot&#34;</span><span class=p>,</span><span class=n>ss</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=k>catch</span><span class=p>(</span><span class=n>Exception</span> <span class=n>er</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MessageBox</span><span class=p>.</span><span class=n>Show</span><span class=p>(</span><span class=s>&#34;连接&#34;</span> <span class=p>+</span> <span class=n>textBox1</span><span class=p>.</span><span class=n>Text</span> <span class=p>+</span> <span class=s>&#34;出错，出错信息为：&#34;</span> <span class=p>+</span><span class=n>er</span><span class=p>.</span><span class=n>Message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>下图是编译上面代码后得到的程序运行界面：
<img src=/imgs/img-lazy-loading.gif data-src=reboot.gif alt=reboot></p><h3 id=六总结>六．总结：
<a class=header-anchor href=#%e5%85%ad%e6%80%bb%e7%bb%93></a></h3><p>其实WMI控制可以实现很多以前让我们很头痛的操作。并且使用WMI编写的管理程序也比不用WMI来实现同样功能的程序在设计难度上大大减轻。WMI内容十分丰富，重新启动远程计算机只是其中的一个最为基本的操作。在使用WMI控制之前有一点必须记住，就是你必须知道你所要进行操作的远程计算机的超级管理者的帐号，这是使用WMI的一个前提。</p></p></div><footer class=post-footer><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
利用C＃重启远程计算机</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/restart-the-remote-computer-using-c%23/ title=利用C＃重启远程计算机>https://blogs.qipai360.cn/post/restart-the-remote-computer-using-c%23/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/half-life-2-source-code/ rel=next title=半条命2(HalfLife2)的源代码><i class="fa fa-chevron-left"></i> 半条命2(HalfLife2)的源代码</a></div><div class="post-nav-prev post-nav-item"><a href=/post/wql-analyzer-v1.1-wmi-query-analyzer/ rel=prev title="WQL Analyzer V1.1(WMI查询分析器)">WQL Analyzer V1.1(WMI查询分析器)
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2026
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.157.0 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"restart-the-remote-computer-using-c%23","permalink":"https://blogs.qipai360.cn/post/restart-the-remote-computer-using-c%23/","title":"利用C＃重启远程计算机","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1772265585" defer></script><script type=text/javascript src="/js/clipboard.min.js?=1772265589" defer></script></body></html>