<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.157.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="水煮TCPMP (转)"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Reprint"><meta property="og:type" content="article"><meta property="og:title" content="水煮TCPMP (转)"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/boiled-tcpmp/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2007-11-26 12:54:00 +0800 +0800"><meta property="article:modified_time" content="2007-11-26 12:54:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1772265588"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>水煮TCPMP (转) - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>679</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>679</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>35</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>118</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2423147></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5207></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2026-02-28 15:59:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/boiled-tcpmp/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="水煮TCPMP (转)"><meta itemprop=description content="去年年底帮别人做一个项目，了解了一下TCPMP，觉得这个软件的结构写得很好就做了些记录，今天偶然翻出来看看觉得可能对正在研究这个软件的人有点帮助就贴出来。如果转载请注明出处，谢谢。
TCPMP是一个功能强大开放式的开源多媒体播放器，播放器主要由核心框架模块（common工程）和解码器分离器插件组成。TCPMP的插件非常多，、libmad我们联合几个最常用的插件（ffmpeg、splitter）来说明，其中interface插件实现TCPMP的界面，由于他和媒体播放没有什么关系，这部分可以完全被替换掉，替换成自己的界面。ffmpeg工程是系统主要的音视频解码模块，ffmpeg是一个集录制、转换、音/视频编码解码功能为一体的完整的开源解决方案。FFmpeg的开发是基于Linux操作系统，但是可以在大多数操作系统中编译和使用。ffmpeg支持MPEG、DivX、MPEG4、AC3、DV、FLV等40多种编码，AVI、MPEG、OGG、Matroska、ASF等90多种解码。很多开源播放器都用到了ffmpeg。但是ffmpeg程序解码效率不是很高，系统仅仅使用了FFmpeg的部分解码功能。ffmpeg主目录下主要有libavcodec、libavformat和libavutil等子目录。其中libavcodec用于存放各个encode/decode模块，libavformat用于存放muxer/demuxer模块，libavutil用于存放内存操作等常用模块。本系统的媒体文件分离器有单独的splitter模块完成所以不需要libavformat子目录。ffmpeg目录下libavcodec、libavutil保留子目录。"></span><header class=post-header><h1 class=post-title itemprop="name headline">水煮TCPMP (转)</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2007年11月26日 12:54:00 CST" itemprop="dateCreated datePublished" datetime="2007-11-26 12:54:00 +0800 +0800">2007年11月26日</time></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>6200</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>13分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/boiled-tcpmp/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p><span style=font-size:10pt><span style=font-family:宋体>去年年底帮别人做一个项目，了解了一下</span><span style="font-family:MS Shell Dlg">TCPMP</span><span style=font-family:宋体>，觉得这个软件的结构写得很好就做了些记录，今天偶然翻出来看看觉得可能对正在研究这个软件的人有点帮助就贴出来。如果转载请注明出处，谢谢。</span><span style="font-family:MS Shell Dlg"><p></span></span></p><p><span style=font-size:10pt><span style="font-family:MS Shell Dlg">TCPMP</span><span style=font-family:宋体>是一个功能强大开放式的开源多媒体播放器，</span><span style="font-family:MS Shell Dlg"><br></span><span style=font-family:宋体>播放器主要由核心框架模块（</span><span style="font-family:MS Shell Dlg">common</span><span style=font-family:宋体>工程）和解码器分离器插件组成。</span><span style="font-family:MS Shell Dlg"><br>TCPMP</span><span style=font-family:宋体>的插件非常多，、</span><span style="font-family:MS Shell Dlg">libmad</span><span style=font-family:宋体>我们联合几个最常用的插件（</span><span style="font-family:MS Shell Dlg">ffmpeg</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">splitter</span><span style=font-family:宋体>）来说明，其中</span><span style="font-family:MS Shell Dlg">interface</span><span style=font-family:宋体>插件实现</span><span style="font-family:MS Shell Dlg">TCPMP</span><span style=font-family:宋体>的界面，由于他和媒体播放没有什么关系，这部分可以完全被替换掉，替换成自己的界面。</span><span style="font-family:MS Shell Dlg"><br>ffmpeg</span><span style=font-family:宋体>工程是系统主要的音视频解码模块，</span><span style="font-family:MS Shell Dlg">ffmpeg</span><span style=font-family:宋体>是一个集录制、转换、音</span><span style="font-family:MS Shell Dlg">/</span><span style=font-family:宋体>视频编码解码功能为一体的完整的开源解决方案。</span><span style="font-family:MS Shell Dlg">FFmpeg</span><span style=font-family:宋体>的开发是基于</span><span style="font-family:MS Shell Dlg">Linux</span><span style=font-family:宋体>操作系统，但是可以在大多数操作系统中编译和使用。</span><span style="font-family:MS Shell Dlg">ffmpeg</span><span style=font-family:宋体>支持</span><span style="font-family:MS Shell Dlg">MPEG</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">DivX</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">MPEG4</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">AC3</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">DV</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">FLV</span><span style=font-family:宋体>等</span><span style="font-family:MS Shell Dlg">40</span><span style=font-family:宋体>多种编码，</span><span style="font-family:MS Shell Dlg">AVI</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">MPEG</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">OGG</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">Matroska</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">ASF</span><span style=font-family:宋体>等</span><span style="font-family:MS Shell Dlg">90</span><span style=font-family:宋体>多种解码。很多开源播放器都用到了</span><span style="font-family:MS Shell Dlg">ffmpeg</span><span style=font-family:宋体>。但是</span><span style="font-family:MS Shell Dlg">ffmpeg</span><span style=font-family:宋体>程序解码效率不是很高，系统仅仅使用了</span><span style="font-family:MS Shell Dlg">FFmpeg</span><span style=font-family:宋体>的部分解码功能。</span><span style="font-family:MS Shell Dlg"><br>ffmpeg</span><span style=font-family:宋体>主目录下主要有</span><span style="font-family:MS Shell Dlg">libavcodec</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">libavformat</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">libavutil</span><span style=font-family:宋体>等子目录。其中</span><span style="font-family:MS Shell Dlg">libavcodec</span><span style=font-family:宋体>用于存放各个</span><span style="font-family:MS Shell Dlg">encode/decode</span><span style=font-family:宋体>模块，</span><span style="font-family:MS Shell Dlg">libavformat</span><span style=font-family:宋体>用于存放</span><span style="font-family:MS Shell Dlg">muxer/demuxer</span><span style=font-family:宋体>模块，</span><span style="font-family:MS Shell Dlg">libavutil</span><span style=font-family:宋体>用于存放内存操作等常用模块。本系统的媒体文件分离器有单独的</span><span style="font-family:MS Shell Dlg">splitter</span><span style=font-family:宋体>模块完成所以不需要</span><span style="font-family:MS Shell Dlg">libavformat</span><span style=font-family:宋体>子目录。</span><span style="font-family:MS Shell Dlg">ffmpeg</span><span style=font-family:宋体>目录下</span><span style="font-family:MS Shell Dlg">libavcodec</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">libavutil</span><span style=font-family:宋体>保留子目录。</span><span style="font-family:MS Shell Dlg"></p><a id=more></a><p></span></span></p><p><span style=font-size:10pt><span style="font-family:MS Shell Dlg">libmad</span><span style=font-family:宋体>工程用于</span><span style="font-family:MS Shell Dlg">MP3</span><span style=font-family:宋体>文件解码，该工程包含两个功能模块，一个负责解析</span><span style="font-family:MS Shell Dlg">MP3</span><span style=font-family:宋体>文件格式，包括</span><span style="font-family:MS Shell Dlg">MPEG1</span><span style=font-family:宋体>音频文件</span><span style="font-family:MS Shell Dlg"> (MP1,MP2,MP3,MPA)</span><span style=font-family:宋体>，读取每一帧音频数据；另一个负责解码</span><span style="font-family:MS Shell Dlg">MPEG1</span><span style=font-family:宋体>音频数据，解码代码在</span><span style="font-family:MS Shell Dlg">libmad</span><span style=font-family:宋体>子目录中。</span><span style="font-family:MS Shell Dlg"><br>libmad</span><span style=font-family:宋体>是一个开源的高精度</span><span style="font-family:MS Shell Dlg"> MPEG1</span><span style=font-family:宋体>音频解码库，支持</span><span style="font-family:MS Shell Dlg"> MPEG-1</span><span style=font-family:宋体>（</span><span style="font-family:MS Shell Dlg">Layer I, Layer II </span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg"> LayerIII</span><span style=font-family:宋体>，也就是</span><span style="font-family:MS Shell Dlg"> MP3</span><span style=font-family:宋体>）。</span><span style="font-family:MS Shell Dlg">libmad</span><span style=font-family:宋体>提供</span><span style="font-family:MS Shell Dlg"> 24-bit </span><span style=font-family:宋体>的</span><span style="font-family:MS Shell Dlg"> PCM </span><span style=font-family:宋体>输出，完全是定点计算，非常适合没有浮点支持的平台上使用。使用</span><span style="font-family:MS Shell Dlg"> libmad </span><span style=font-family:宋体>提供的一系列</span><span style="font-family:MS Shell Dlg"> API</span><span style=font-family:宋体>，就可以非常简单地实现</span><span style="font-family:MS Shell Dlg"> MP3 </span><span style=font-family:宋体>数据解码工作。在</span><span style="font-family:MS Shell Dlg"> libmad </span><span style=font-family:宋体>的源代码文件目录下的</span><span style="font-family:MS Shell Dlg"> mad.h </span><span style=font-family:宋体>文件中，可以看到绝大部分该库的数据结构和</span><span style="font-family:MS Shell Dlg"> API </span><span style=font-family:宋体>等。</span><span style="font-family:MS Shell Dlg">libmad</span><span style=font-family:宋体>是用的</span><span style="font-family:MS Shell Dlg">fixed-integer</span><span style=font-family:宋体>，通过整数模拟小数计算的，精度只能保证到小数点后第</span><span style="font-family:MS Shell Dlg">9</span><span style=font-family:宋体>位（大于</span><span style="font-family:MS Shell Dlg">0</span><span style=font-family:宋体>的最小值</span><span style="font-family:MS Shell Dlg"> 0.00000000372529</span><span style=font-family:宋体>），虽然解码精度会有损失，但是极大提高了解码效率，特别是在嵌入式设备上也可以实现高码率</span><span style="font-family:MS Shell Dlg">MP3</span><span style=font-family:宋体>文件的解码。</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style="font-family:MS Shell Dlg">splitter</span><span style=font-family:宋体>工程用于解析多种音视频文件格式。可以解析的文件格式包括：</span><span style="font-family:MS Shell Dlg">ASF</span><span style=font-family:宋体>媒体文件，视频文件</span><span style="font-family:MS Shell Dlg"> (AVI,DIVX)</span><span style=font-family:宋体>，</span><span style="font-family:MS Shell Dlg">Windows</span><span style=font-family:宋体>波形文件</span><span style="font-family:MS Shell Dlg"> (WAV,RMP)</span><span style=font-family:宋体>，</span><span style="font-family:MS Shell Dlg">MPEG</span><span style=font-family:宋体>电影文件</span><span style="font-family:MS Shell Dlg"> (MPEG,MPG,MPV)</span><span style=font-family:宋体>，</span><span style="font-family:MS Shell Dlg">MPEG4</span><span style=font-family:宋体>文件</span><span style="font-family:MS Shell Dlg"> (MP4,3GP,M4A,M4B,K3G)</span><span style=font-family:宋体>。以上格式可以被解析但是数据编码不一定能正确解码，需要依赖系统的解码器。</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style="font-family:MS Shell Dlg">common</span><span style=font-family:宋体>工程是核心模块，是一个开放的集数据输入、转换、音</span><span style="font-family:MS Shell Dlg">/</span><span style=font-family:宋体>视频解码、信号输出等功能为一体的完整的多媒体播放框架。这个框架自身不包含任何的</span><span style="font-family:MS Shell Dlg">Decode</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">Split</span><span style=font-family:宋体>功能，这些功能由插件实现，核心模块以一个树状结构管理所有的功能模块和插件模块，实现数据</span><span style="font-family:MS Shell Dlg">Render</span><span style=font-family:宋体>功能，对输入、转换、输出流程的控制，接受播放过程中的操作和对事件进行处理，同时也实现系统运行中经常使用的一些共用函数，比如解码过程中经常使用的逆离散余弦变换，内存操作，界面中需要使用的多语言字符处理等。</span><span style="font-family:MS Shell Dlg">common</span><span style=font-family:宋体>工程的主目录下主要有：</span><span style="font-family:MS Shell Dlg">blit</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">dyncode</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">overlay</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">pcm</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">softidct</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">win32</span><span style=font-family:宋体>、</span><span style="font-family:MS Shell Dlg">zlib</span><span style=font-family:宋体>等子目录。其中</span><span style="font-family:MS Shell Dlg">blit</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">overlay</span><span style=font-family:宋体>存放是视频信号渲染模块，</span><span style="font-family:MS Shell Dlg">pcm</span><span style=font-family:宋体>存放</span><span style="font-family:MS Shell Dlg">PCM</span><span style=font-family:宋体>音频信号转换模块，</span><span style="font-family:MS Shell Dlg">softidct</span><span style=font-family:宋体>存放逆离散余弦变换函数，</span><span style="font-family:MS Shell Dlg">win32</span><span style=font-family:宋体>存放内存操作等常用模块，</span><span style="font-family:MS Shell Dlg">dyncode</span><span style=font-family:宋体>这个目录的代码比较晦涩，存放的是程序运行是动态生成代码模块，针对不同的</span><span style="font-family:MS Shell Dlg">CPU</span><span style=font-family:宋体>指令集，</span><span style="font-family:MS Shell Dlg">PCM</span><span style=font-family:宋体>数据数据声道和采样率不同，视频渲染数据格式和色深等不同情况动态生成不同的优化代码（这段代码非常精彩，不能不让人佩服</span><span style="font-family:MS Shell Dlg">TCPMP</span><span style=font-family:宋体>作者的高超水平）。核心模块有一个上下文对象</span><span style="font-family:MS Shell Dlg">context</span><span style=font-family:宋体>，该对象在初始化函数</span><span style="font-family:MS Shell Dlg">bool_t Context_Init(……)</span><span style=font-family:宋体>中候创建了一个该对象实例。该对象实例记录管理各个功能模块，用户界面可以通过该对象和核心模块交互，管理控制播放过程。</span><span style="font-family:MS Shell Dlg"><br> Context</span><span style=font-family:宋体>对象说明：</span><span style="font-family:MS Shell Dlg"><br>typedef struct context<br>{<br> int Version; //</span><span style=font-family:宋体>版本信息</span><span style="font-family:MS Shell Dlg"><br> uint32_t ProgramId;<br> const tchar_t* ProgramName;  //</span><span style=font-family:宋体>应用程序名称</span><span style="font-family:MS Shell Dlg"><br> const tchar_t* ProgramVersion; //</span><span style=font-family:宋体>程序版本号，字符串</span><span style="font-family:MS Shell Dlg"><br> const tchar_t* CmdLine;   //</span><span style=font-family:宋体>程序命令行信息</span><span style="font-family:MS Shell Dlg"><br> void* Wnd;   //</span><span style=font-family:宋体>视频渲染窗口句柄</span><span style="font-family:MS Shell Dlg"><br> void* NodeLock;  //</span><span style=font-family:宋体>功能模块访问临界区互斥变量</span><span style="font-family:MS Shell Dlg"><br> array Node;   //</span><span style=font-family:宋体>功能模块数据对象数组</span><span style="font-family:MS Shell Dlg"><br> array NodeClass;  //</span><span style=font-family:宋体>功能模块定义对象数组，按照系统逻辑关系组织</span><span style="font-family:MS Shell Dlg"><br> array NodeClassPri; //</span><span style=font-family:宋体>功能模块定义对象数组，按照系统逻辑关系和模块优先级排列</span><span style="font-family:MS Shell Dlg"><br> array NodeModule;  //</span><span style=font-family:宋体>外部插件模块数组</span><span style="font-family:MS Shell Dlg"><br> int LoadModuleNo;  //</span><span style=font-family:宋体>当前正在装载的外部插件序号</span><span style="font-family:MS Shell Dlg"><br> void* LoadModule;<br> array StrTable[2];  //</span><span style=font-family:宋体>字符串资源数组，字符串分为</span><span style="font-family:MS Shell Dlg"><br>      //</span><span style=font-family:宋体>给底层使用的标准字符串资源和</span><span style="font-family:MS Shell Dlg"><br>      //</span><span style=font-family:宋体>给界面使用的显示字符串资源，两种资源用两个数组表示</span><span style="font-family:MS Shell Dlg"><br> array StrBuffer;<br> array StrModule;  //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> void* StrLock;  //</span><span style=font-family:宋体>字符串数组访问临界区互斥变量</span><span style="font-family:MS Shell Dlg"><br> uint32_t Lang;   //</span><span style=font-family:宋体>当前使用语言标志</span><span style="font-family:MS Shell Dlg"><br> int CodePage;   //</span><span style=font-family:宋体>当前使用代码页标志</span><span style="font-family:MS Shell Dlg"><br> struct pcm_soft* PCM; //PCM</span><span style=font-family:宋体>音频信号转换模块</span><span style="font-family:MS Shell Dlg"><br> struct blitpack* Blit; //</span><span style=font-family:宋体>视频信号渲染模块</span><span style="font-family:MS Shell Dlg"><br> struct node* Platform; //</span><span style=font-family:宋体>得到平台相关信息</span><span style="font-family:MS Shell Dlg"><br> struct node* Advanced; //</span><span style=font-family:宋体>得到播放模块高级信息</span><span style="font-family:MS Shell Dlg"><br> struct node* Player;  //</span><span style=font-family:宋体>播放控制模块</span><span style="font-family:MS Shell Dlg"><br> notify Error;   //</span><span style=font-family:宋体>信息错误回调函数</span><span style="font-family:MS Shell Dlg"><br> //</span><span style=font-family:宋体>屏幕旋转信息，在某些系统中屏幕可以旋转</span><span style="font-family:MS Shell Dlg">90</span><span style=font-family:宋体>度或</span><span style="font-family:MS Shell Dlg">180</span><span style=font-family:宋体>度</span><span style="font-family:MS Shell Dlg"><br> int (<em>HwOrientation)(void</em>);<br> void <em>HwOrientationContext;<br> bool_t TryDynamic;  //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> int SettingsPage;   //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> size_t StartUpMemory;  //</span><span style=font-family:宋体>可以使用的有效内存数</span><span style="font-family:MS Shell Dlg"><br> bool_t InHibernate;   //</span><span style=font-family:宋体>是否进入休眠状态</span><span style="font-family:MS Shell Dlg"><br> bool_t WaitDisable;   //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> int FtrId;     //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> bool_t LowMemory;  //</span><span style=font-family:宋体>可以使用的有效内存数是否小于系统要求的最低要求</span><span style="font-family:MS Shell Dlg"><br> //</span><span style=font-family:宋体>动态代码生成中间状态及数据</span><span style="font-family:MS Shell Dlg"><br> bool_t CodeFailed;<br> bool_t CodeMoveBack;<br> bool_t CodeDelaySlot;<br> void</em> CodeLock;<br> void* CodeInstBegin;<br> void* CodeInstEnd;<br> int NextCond;<br> bool_t NextSet;<br> bool_t NextByte;<br> bool_t NextHalf;<br> bool_t NextSign;<br> <br> uint32_t* FlushCache;  //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> void* CharConvertUTF8; //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> void* CharConvertCustom; //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> int CustomCodePage;  //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> void* CharConvertAscii; //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> void* Application;<br> void* Logger;    //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"><br> bool_t KeepDisplay;  //</span><span style=font-family:宋体>是否保持背光长亮</span><span style="font-family:MS Shell Dlg"><br> int DisableOutOfMemory; //</span><span style=font-family:宋体>未使用</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style="font-family:MS Shell Dlg">} context;<br></span><span style=font-family:宋体>核心模块上下文指针可以通过全局函数获得</span><span style="font-family:MS Shell Dlg">context* Context();<br></span><span style=font-family:宋体>初始化上下文对象的全局函数是</span><span style="font-family:MS Shell Dlg">bool_t Context_Init(const tchar_t* Name,const tchar_t* Version,int Id,const tchar_t* CmdLine,void* Application);</span><span style=font-family:宋体>其中</span><span style="font-family:MS Shell Dlg">Name</span><span style=font-family:宋体>参数为应用程序名称，</span><span style="font-family:MS Shell Dlg">Version</span><span style=font-family:宋体>为版本信息字符串。</span><span style="font-family:MS Shell Dlg"><br></span><span style=font-family:宋体>释放上下文对象的全局函数是</span><span style="font-family:MS Shell Dlg">void Context_Done();</span><span style=font-family:宋体>。</span><span style="font-family:MS Shell Dlg"><br>void Context_Wnd(void*);</span><span style=font-family:宋体>函数将视频播放窗口句柄初始化给设备上下文。</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style=font-family:宋体>功能模块包含定义对象和数据对象，定义对象描述功能模块相互间的逻辑结构，数据对象记录模块属性和方法。</span><span style="font-family:MS Shell Dlg"><br></span><span style=font-family:宋体>所有的功能模块结构按一个树状结构来组织，结构关系如下，</span><span style="font-family:MS Shell Dlg">NODE</span><span style=font-family:宋体>是整个结构的根结点，其下为子节点，节点按类型可分为实节点，全局节点，设置节点，抽象节点。</span><span style="font-family:MS Shell Dlg"><br>#define CF_SIZE   0x00FFFFFF<br>#define CF_GLOBAL  0x01000000<br>#define CF_SETTINGS  0x02000000<br>#define CF_ABSTRACT  0x08000000<br></span><span style=font-family:宋体>抽象节点没有对应的对象实例，类似</span><span style="font-family:MS Shell Dlg">C++</span><span style=font-family:宋体>的抽象基类，为了按照逻辑关系组织系统结构而存在，例如</span><span style="font-family:MS Shell Dlg">NODE</span><span style=font-family:宋体>就是抽象节点。全局节点全局只有一个对象的实例，如播放控制模块</span><span style="font-family:MS Shell Dlg">PLAYER_ID</span><span style=font-family:宋体>。设置节点表示和系统播放设置相关，比如声音均衡器模块</span><span style="font-family:MS Shell Dlg">EQUALIZER_ID</span><span style=font-family:宋体>，颜色控制模块</span><span style="font-family:MS Shell Dlg">COLOR_ID</span><span style=font-family:宋体>。实节点与抽象节点不同，指可以生成对象实例的节点，实节点没有特殊标识，一般以数据对象占用内存大小表示是否是一个实节点，创建节点时要根据该信息分配内存单元，实节点也可以有子节点，例如：</span><span style="font-family:MS Shell Dlg">MMS_ID</span><span style=font-family:宋体>的父节点是</span><span style="font-family:MS Shell Dlg">HTTP_ID</span><span style=font-family:宋体>。全局节点，设置节点和实节点可以相互组合，比如播放控制节点同时是全局节点，设置节点和实节点。节点名称后带</span><span style="font-family:MS Shell Dlg">_ID</span><span style=font-family:宋体>的就是实节点，否则就是抽象节点。</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style="font-family:MS Shell Dlg">    NODE </span><span style=font-family:宋体>（根节点）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">FLOW </span><span style=font-family:宋体>（流控制模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">CODEC </span><span style=font-family:宋体>（解码模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">EQUALIZER_ID </span><span style=font-family:宋体>（声音均衡器模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">VBUFFER_ID </span><span style=font-family:宋体>（视频缓冲模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">DMO </span><span style=font-family:宋体>（</span><span style="font-family:MS Shell Dlg">DirectX Media Object</span><span style=font-family:宋体>）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">WMV_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">WMS_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">WMVA_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">WMA_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">WMAV_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">FFMPEG VIDEO </span><span style=font-family:宋体>（</span><span style="font-family:MS Shell Dlg">FFMpeg </span><span style=font-family:宋体>解码模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">LIBMAD_ID </span><span style=font-family:宋体>（</span><span style="font-family:MS Shell Dlg">Libmad Mp3</span><span style=font-family:宋体>解码模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">OUT </span><span style=font-family:宋体>（信号渲染模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">AOUT </span><span style=font-family:宋体>（音频信号渲染）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">NULLAUDIO_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">WAVEOUT_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">VOUT </span><span style=font-family:宋体>（视频信号渲染）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">NULLVIDEO_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">OVERLAY<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">IDCT </span><span style=font-family:宋体>（离散余弦解码模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">SOFTIDCT_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">CODECIDCT</span><span style=font-family:宋体>（离散余弦解码模块，函数比</span><span style="font-family:MS Shell Dlg">IDCT</span><span style=font-family:宋体>要少）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">MPEG1_ID<br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">MEDIA </span><span style=font-family:宋体>（媒体文件格式编码解析模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">FORMAT </span><span style=font-family:宋体>（格式解析模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">FORMATBASE<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">RAWAUDIO<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">MP3_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">RAWIMAGE<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">ASF_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">AVI_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">MP4_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">MPG_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">NSV_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">      </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">WAV_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">PLAYLIST </span><span style=font-family:宋体>（播放列表模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">ASX_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">M3U_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">PLS_ID<br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">STREAMPROCESS </span><span style=font-family:宋体>（数据流处理模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">STREAM </span><span style=font-family:宋体>（数据输入模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">MEMSTREAM_ID </span><span style=font-family:宋体>（内存数据流模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">FILE_ID </span><span style=font-family:宋体>（文件</span><span style="font-family:MS Shell Dlg">IO</span><span style=font-family:宋体>模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">HTTP_ID </span><span style=font-family:宋体>（网络数据获取模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">TIMER </span><span style=font-family:宋体>（定时器模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>│</span><span style="font-family:MS Shell Dlg">  </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">SYSTIMER_ID<br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">ASSOCIATION_ID </span><span style=font-family:宋体>（文件扩展名自动关联模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">ADVANCED_ID </span><span style=font-family:宋体>（高级设置模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">COLOR_ID </span><span style=font-family:宋体>（颜色控制模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">PLATFORM_ID </span><span style=font-family:宋体>（平台信息模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">XSCALEDRIVER_ID </span><span style=font-family:宋体>（</span><span style="font-family:MS Shell Dlg">Intel XScale CPU </span><span style=font-family:宋体>信息模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>├─</span><span style="font-family:MS Shell Dlg">PLAYER_ID </span><span style=font-family:宋体>（播放控制模块）</span><span style="font-family:MS Shell Dlg"><br>    </span><span style=font-family:宋体>└─</span><span style="font-family:MS Shell Dlg">PLAYER_BUFFER_ID </span><span style=font-family:宋体>（播放缓冲模块）</span><span style="font-family:MS Shell Dlg"><br>   <br>    </span><span style=font-family:宋体>节点树状结构由若干个静态定义对象</span><span style="font-family:MS Shell Dlg">(nodedef)</span><span style=font-family:宋体>实例实现，</span><span style="font-family:MS Shell Dlg"><br>        typedef struct nodedef<br>  {<br>   int    Flags;<br>   int    Class;<br>   int    ParentClass;<br>   int    Priority;<br>   nodecreate  Create;<br>   nodedelete  Delete;<br>  } nodedef;<br> Flags</span><span style=font-family:宋体>表示当前节点的类型：抽象、实节点、全局、设置。</span><span style="font-family:MS Shell Dlg"><br> Class</span><span style=font-family:宋体>表示当前节点的标识，如</span><span style="font-family:MS Shell Dlg">MEDIA_CLASS</span><span style=font-family:宋体>或</span><span style="font-family:MS Shell Dlg">ASF_ID</span><span style=font-family:宋体>等等。</span><span style="font-family:MS Shell Dlg"><br> ParentClass</span><span style=font-family:宋体>表示当前节点的父节点标识，如</span><span style="font-family:MS Shell Dlg">SYSTIMER_ID</span><span style=font-family:宋体>对象的父节点是</span><span style="font-family:MS Shell Dlg">TIMER_CLASS</span><span style=font-family:宋体>。</span><span style="font-family:MS Shell Dlg"><br> Priority</span><span style=font-family:宋体>表示当前节点优先级。</span><span style="font-family:MS Shell Dlg"><br> Create</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">Delete</span><span style=font-family:宋体>是两个函数指针，表示该节点的创建函数和销毁函数。</span><span style="font-family:MS Shell Dlg"><br> </span><span style=font-family:宋体>如播放控制模块的结构定义是</span><span style="font-family:MS Shell Dlg"><br> static const nodedef Player =<br> {<br>  sizeof(player_base)|CF_GLOBAL|CF_SETTINGS,<br>  PLAYER_ID,<br>  NODE_CLASS,<br>  PRI_MAXIMUM+600,<br>  (nodecreate)Create,<br>  (nodedelete)Delete,<br> };<br> <br> </span><span style=font-family:宋体>绝大多数节点都有一个对应的数据对象，记录该节点的数据和方法，每一个子节点对象都是以父节点对象作为该节点一个元素，类似</span><span style="font-family:MS Shell Dlg">C++</span><span style=font-family:宋体>的封装继承机制。如果子节点的父节点没有数据对象，该节点可以从</span><span style="font-family:MS Shell Dlg">node</span><span style=font-family:宋体>节点直接继承。每一个节点都可以看成</span><span style="font-family:MS Shell Dlg">Node</span><span style=font-family:宋体>节点的直接或间接子节点，所以所有节点头以一个相同的</span><span style="font-family:MS Shell Dlg">node</span><span style=font-family:宋体>结构开头，子节点可能还有自己的属性，在继承父对象后就是子节点自己的元素。</span><span style="font-family:MS Shell Dlg"><br>    typedef struct node<br> {<br>  int   Class;<br>  nodeenum Enum;<br>  nodeget  Get;<br>  nodeset  Set;<br> } node;<br> Class</span><span style=font-family:宋体>表示该对象的标识，如</span><span style="font-family:MS Shell Dlg">PLAYER_ID</span><span style=font-family:宋体>。</span><span style="font-family:MS Shell Dlg"><br> Enum</span><span style=font-family:宋体>是一个函数指针，指向一个函数用于枚举当前节点的属性。</span><span style="font-family:MS Shell Dlg"><br> Get</span><span style=font-family:宋体>是一个函数指针，得到当前节点某一属性值。</span><span style="font-family:MS Shell Dlg"><br> Set</span><span style=font-family:宋体>是一个函数指针，设置当前节点的某一属性数值。</span><span style="font-family:MS Shell Dlg"><br> <br> </span><span style=font-family:宋体>节点的属性值数据特性在一个</span><span style="font-family:MS Shell Dlg">static const datatable xxxParams[] = {……};</span><span style=font-family:宋体>的静态数组里定义。</span><span style="font-family:MS Shell Dlg"><br> typedef struct datatable<br> {<br>  int No;<br>  int Type;<br>  int Flags;<br>  int Format1;<br>  int Format2;<br> } datatable;<br> <br> No</span><span style=font-family:宋体>表示属性的标识，如播放控制模块的</span><span style="font-family:MS Shell Dlg">#define PLAYER_PLAY 0x32 </span><span style=font-family:宋体>就表示控制播放器播放或暂停。</span><span style="font-family:MS Shell Dlg"><br> Type</span><span style=font-family:宋体>表示属性的数据类型，可用值在</span><span style="font-family:MS Shell Dlg">node.h</span><span style=font-family:宋体>中定义。</span><span style="font-family:MS Shell Dlg"><br> Flags</span><span style=font-family:宋体>是属性数据的标志，表示该数据是不是只读数据，是否有最大最小值等等，可用值在</span><span style="font-family:MS Shell Dlg">node.h</span><span style=font-family:宋体>中定义，如果该标志包含</span><span style="font-family:MS Shell Dlg">DF_SETUP</span><span style=font-family:宋体>同时不包含</span><span style="font-family:MS Shell Dlg">DF_NOSAVE</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">DF_RDONLY</span><span style=font-family:宋体>属性，该属性会被记录在注册表中，下次启动时用注册表的数据初始化该属性。</span><span style="font-family:MS Shell Dlg"><br> Format1</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">Format2</span><span style=font-family:宋体>是可选标志与</span><span style="font-family:MS Shell Dlg">Flags</span><span style=font-family:宋体>配合使用，比如如果</span><span style="font-family:MS Shell Dlg">Flags</span><span style=font-family:宋体>表示该属性存在最大最小值，</span><span style="font-family:MS Shell Dlg">Format1</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">Format2</span><span style=font-family:宋体>可以分别表示最小和最大数值。</span><span style="font-family:MS Shell Dlg"><br> <br> </span><span style=font-family:宋体>在在系统上下文对象中有两个元素记录节点信息</span><span style="font-family:MS Shell Dlg">array Node;</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">array NodeClass;</span><span style=font-family:宋体>，</span><span style="font-family:MS Shell Dlg">array</span><span style=font-family:宋体>是数组数据类型，</span><span style="font-family:MS Shell Dlg">Node</span><span style=font-family:宋体>是节点数据对象的数组，</span><span style="font-family:MS Shell Dlg">NodeClass</span><span style=font-family:宋体>节点对象的数组，按照系统逻辑关系组织。</span><span style="font-family:MS Shell Dlg"><br> </span><span style=font-family:宋体>创建节点时传入</span><span style="font-family:MS Shell Dlg">nodedef</span><span style=font-family:宋体>对象到节点创建函数，函数会根据</span><span style="font-family:MS Shell Dlg">nodedef</span><span style=font-family:宋体>信息生成对应</span><span style="font-family:MS Shell Dlg">nodeclass</span><span style=font-family:宋体>对象添加到</span><span style="font-family:MS Shell Dlg">NodeClass</span><span style=font-family:宋体>数组，同时根据</span><span style="font-family:MS Shell Dlg">nodedef</span><span style=font-family:宋体>信息分配数据对象的内存空间。在该节点的</span><span style="font-family:MS Shell Dlg">Create</span><span style=font-family:宋体>函数里面再初始化该节点的数据对象。</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style=font-family:宋体>在所有功能模块中和界面加交互的主要就是播放控制模块</span><span style="font-family:MS Shell Dlg">struct node* Player;</span><span style=font-family:宋体>使用方法如下：</span><span style="font-family:MS Shell Dlg"><br>context* p = Context();<br>player* myplayer = NULL;<br>if(p) myplayer = (player*)(p->Player);<br></span><span style=font-family:宋体>控制播放参数使用</span><span style="font-family:MS Shell Dlg">Set(void* This,int No,const void* Data,int Size);</span><span style=font-family:宋体>函数，第一个参数是播放模块指针，第二个参数是控制代码，即要进行什么操作，第三个参数是需要赋值给控制代码的数值，最后一个参数是所赋数值的占用内存的大小。</span><span style="font-family:MS Shell Dlg"><br></span><span style=font-family:宋体>例如开始播放的代码是：</span><span style="font-family:MS Shell Dlg"><br>myplayer->Set(myplayer,PLAYER_PLAY,1,sizeof(int));<br>PLAYER_PLAY</span><span style=font-family:宋体>为控制代码，表示当前控制的是播放暂停功能，数值为</span><span style="font-family:MS Shell Dlg">1</span><span style=font-family:宋体>表示播放为</span><span style="font-family:MS Shell Dlg">0</span><span style=font-family:宋体>表示暂停。</span><span style="font-family:MS Shell Dlg"><br></span><span style=font-family:宋体>得到某一控制属性使用</span><span style="font-family:MS Shell Dlg">Get(void* This,int No,void* Data,int Size);</span><span style=font-family:宋体>函数，参数含义和</span><span style="font-family:MS Shell Dlg">Set</span><span style=font-family:宋体>函数相同。</span><span style="font-family:MS Shell Dlg"><br></span><span style=font-family:宋体>控制代码是一组宏，定义在</span><span style="font-family:MS Shell Dlg">player.h</span><span style=font-family:宋体>文件中。比较重要的控制参数有</span><span style="font-family:MS Shell Dlg"><br>// play or pause (bool_t)<br>#define PLAYER_PLAY   0x32<br>// position in fraction (fraction)<br>#define PLAYER_PERCENT  0x25<br>// position in time (tick_t)<br>#define PLAYER_POSITION  0x28<br>// current format (format*)<br>#define PLAYER_FORMAT  0x2B<br>// current file in playlist (int)<br>#define PLAYER_LIST_CURRENT 0x2F<br>// current file index (suffled) in playlist (int)<br>#define PLAYER_LIST_CURRIDX 0xA2<br>// fullscreen mode (bool_t)<br>#define PLAYER_FULLSCREEN 0x3E<br>// stop<br>#define PLAYER_STOP   0xB2<br>// skin viewport rectangle (rect)<br>#define PLAYER_SKIN_VIEWPORT 0x3C<br></span><span style=font-family:宋体>播放控制模块所有可用参数见</span><span style="font-family:MS Shell Dlg">static const datatable PlayerParams[]</span><span style=font-family:宋体>结构。</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style=font-family:宋体>添加一个媒体文件到播放模块使用</span><span style="font-family:MS Shell Dlg">int PlayerAdd(player* Player,int Index, const tchar_t* Path, const tchar_t* Title);<br></span><span style=font-family:宋体>第一个参数为播放模块指针，第二个参数是添加到播放模块文件队列的序号，如果是使文件成为第一个文件该参数设为</span><span style="font-family:MS Shell Dlg">0</span><span style=font-family:宋体>，第三个参数是媒体文件的目录和名称，第四个参数为媒体文件标题，该参数可以忽略。</span><span style="font-family:MS Shell Dlg"></p><p></span></span></p><p><span style=font-size:10pt><span style=font-family:宋体>核心模块也管理多语言字符串，使用函数</span><span style="font-family:MS Shell Dlg">const tchar_t* LangStr(int Class, int Id);</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">const tchar_t* LangStrDef(int Class, int Id)</span><span style=font-family:宋体>可以得到对应字符串，系统字符串资源有两种，标准字符串和特殊字符集字符串。标准字符串资源文件是工程目录下的</span><span style="font-family:MS Shell Dlg">lang_std.txt</span><span style=font-family:宋体>文件，该文件字符串为</span><span style="font-family:MS Shell Dlg">ASCII</span><span style=font-family:宋体>字符，可与其他代码页字符兼容。该文件记录的是核心模块运行时需要使用的字符串，</span><span style="font-family:MS Shell Dlg">Decode</span><span style=font-family:宋体>和</span><span style="font-family:MS Shell Dlg">Splite</span><span style=font-family:宋体>模块可以处理的编码格式和文件格式也在这个文件中记录，例如</span><span style="font-family:MS Shell Dlg">lang_std.txt</span><span style=font-family:宋体>文件中的</span><span style="font-family:MS Shell Dlg"><br>MP3_0001=audio/mpeg<br>MP3_0002=mp1:A;mp2:A;mp3:A;mpa:A<br>MP3_0200=acodec/0x0055<br></span><span style=font-family:宋体>纪录了</span><span style="font-family:MS Shell Dlg">MP3</span><span style=font-family:宋体>文件分离器对应的文件类型、扩展名和文件特征码。</span><span style="font-family:MS Shell Dlg"><br></span><span style=font-family:宋体>要得到标准字符串使用函数</span><span style="font-family:MS Shell Dlg">LangStrDef</span><span style=font-family:宋体>，第一个参数表示字符类别，第二个参数表示字符</span><span style="font-family:MS Shell Dlg">ID</span><span style=font-family:宋体>。界面相关的是特殊字符集的字符串，使用函数</span><span style="font-family:MS Shell Dlg">LangStr</span><span style=font-family:宋体>，第一个参数表示字符类别，第二个参数表示字符</span><span style="font-family:MS Shell Dlg">ID</span><span style=font-family:宋体>。关于字符串资源文件结构含义将在以后的文档中说明。<a href=http://blog.csdn.net/navi_dx/archive/2007/11/14/1885780.aspx></span><span style="font-family:MS Shell Dlg"><span style=color:#2e9ce9>
<a href=http://blog.csdn.net/navi_dx/archive/2007/11/14/1885780.aspx title=http://blog.csdn.net/navi_dx/archive/2007/11/14/1885780.aspx rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://blog.csdn.net/navi_dx/archive/2007/11/14/1885780.aspx</a></span></p><p></span></span></p></p></div><footer class=post-footer><div class=post-tags><a href=/tags/reprint/>Reprint</a></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
水煮TCPMP (转)</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/boiled-tcpmp/ title="水煮TCPMP (转)">https://blogs.qipai360.cn/post/boiled-tcpmp/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/avp-active-defense-hidden-process/ rel=next title=AVP主动防御之隐藏进程><i class="fa fa-chevron-left"></i> AVP主动防御之隐藏进程</a></div><div class="post-nav-prev post-nav-item"><a href=/post/chinese-hacker-black-industry/ rel=prev title=中国黑客自揭黑色产业链条：做病毒一定要低调>中国黑客自揭黑色产业链条：做病毒一定要低调
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2026
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.157.0 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"boiled-tcpmp","permalink":"https://blogs.qipai360.cn/post/boiled-tcpmp/","title":"水煮TCPMP (转)","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1772265585" defer></script></body></html>