<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.152.2"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="使用Flash彻底美化你的程序"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Rise,ZhangTuohui,技术,C++,Unity3D,Lua,NodeJS,C#,JavaScript,游戏开发,机器学习,深度学习,AI,编程,编程语言,编程技术,编程开发,游戏引擎,游戏设计,游戏制作,游戏开发者,游戏开发者博客,游戏开发者网站,游戏开发者工具,游戏开发者教程,游戏开发者学习,游戏开发者交流,游戏开发者分享,游戏开发者经验,游戏开发者心得,游戏开发者技巧,游戏开发者方法,游戏开发者思路,游戏开发者理念,游戏开发者文化,游戏开发者精神,游戏开发者信仰"><meta property="og:type" content="article"><meta property="og:title" content="使用Flash彻底美化你的程序"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/enhancing-programs-with-flash/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2005-07-09 13:01:00 +0800 +0800"><meta property="article:modified_time" content="2005-07-09 13:01:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1761990627"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>使用Flash彻底美化你的程序 - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>678</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>678</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>34</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>117</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2418817></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5198></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2025-11-01 14:55:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/enhancing-programs-with-flash/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="使用Flash彻底美化你的程序"><meta itemprop=description content=' 
曾经在VCKbase（VC知识库）网站看到过一篇关于Flash的文章，叫做《在VC中使用 Flash 美化你的程序》，文章中介绍的是使用Flash控件在对话框程序中播放Flash文件。由于以前的工作需要曾经接触过使用Scoket通信在VC的Exe程序和Flash程序中通信的相关技术。在这里介绍给大家。相比上面的那篇文章，其有一下有点：
1、&nbsp; 界面上更加优美。所有的界面部分都是直接使用Flash。
2、&nbsp; 所能完成的功能更加完备。几乎所有能在VC的程序中能使用的功能都可以使用。
要做到以上两点所要做的工作也是很简单的，使用的技术也很简单。只要求以下几点：
1、&nbsp; 会使用简单的Flash编辑工具。会写简单的Flash Script脚本。
2、&nbsp; Socket编程的相关知识。
程序的原理就是：VC程序(对话框程序)在启动以后最小化的任务栏，并建立一个Socket Server进行侦听，在建立完Socket和设置好相关的处理函数以后，启动编译为Exe的Flash程序，Flash程序通过Socket于VC程序建立连接，将Flash界面上的操作转换为Socket通信，让VC程序处理完成以后将结果返回给Flash程序。其简单的步骤为：
1、&nbsp; 在VC程序端（或者其他任何编程语言的程序）：建立一个对话框程序，在APP类的InitInstance()函数中添加Scoket初始化：
if (!AfxSocketInit()) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox(IDP_SOCKETS_INIT_FAILED); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return FALSE; 


} 


2、&nbsp; 在对话框类的OnInitDialog()函数中添加处理界面部分的程序段： 


MoveWindow(0,0,0,0);&nbsp; //将对话框程序界面改变为0 


ShowWindow(SW_SHOWMINIMIZED);&nbsp;&nbsp; //使界面最小化到任务栏 


OnOK(); //调用对话框的OnOK函数 


3、&nbsp; 在对话框类的OnOK()函数中建立Socket server并侦听： 


WSADATA wsaData; 


&nbsp;&nbsp; &nbsp;int iErrorCode; 


&nbsp;&nbsp;&nbsp; if (WSAStartup(MAKEWORD(2,1),&amp;wsaData)) //Windows Sockets DLL 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;AfxMessageBox("Winsock can not initialize.",MB_ICONSTOP); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSACleanup(); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;SendMessage(WM_CLOSE,NULL,NULL);//关闭对话框程序 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 



&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Create server Socket，type is SOCK_STREAM， 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ServerSocket = socket(PF_INET,SOCK_STREAM,0);&nbsp;&nbsp;&nbsp; 


&nbsp;&nbsp;&nbsp; if(ServerSocket == INVALID_SOCKET) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox("Could not create server Socket.",MB_ICONSTOP); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SendMessage(WM_CLOSE,NULL,NULL); //关闭对话框程序 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 



&nbsp;

m_sockServerAddr.sin_family = AF_INET; 


//IP 设置为广播 


&nbsp;&nbsp;&nbsp; m_sockServerAddr.sin_addr.s_addr = inet_addr("127.0.0.1"); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //使用9813端口，自己编程的时候可以随意选择，最好使用5000以后的 


&nbsp;&nbsp;&nbsp; m_sockServerAddr.sin_port = htons(9813); 



&nbsp;

//绑定Socket 


&nbsp;&nbsp;&nbsp; if (bind(ServerSocket,(LPSOCKADDR)&amp;m_sockServerAddr,sizeof(m_sockServerAddr)) == SOCKET_ERROR) // 


&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox("Could not bind Server socket.",MB_ICONSTOP); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SendMessage(WM_CLOSE,NULL,NULL); //关闭对话框程序 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp; iErrorCode = WSAAsyncSelect(ServerSocket,m_hWnd,WM_CLIENT_ACCEPT,FD_ACCEPT); 


&nbsp;&nbsp;&nbsp; if (iErrorCode == SOCKET_ERROR) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox("Could not select socket.",MB_ICONSTOP); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SendMessage(WM_CLOSE,NULL,NULL); //关闭对话框程序 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 



&nbsp;

&nbsp;&nbsp;&nbsp; if (listen(ServerSocket,1) == SOCKET_ERROR) //begin listen client 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox("Could not listen.",MB_ICONSTOP); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SendMessage(WM_CLOSE,NULL,NULL); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //启动Flash程序 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString FlashExePath; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char DialogExePath[256]; 


&nbsp;&nbsp; //获得对话框程序的路径，包含文件名 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::GetModuleFileName(0, DialogExePath, sizeof(DialogExePath)); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FlashExePath = DialogExePath; 


&nbsp;&nbsp; //去除对话框程序文件名，获得所在目录路径 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int Len = FlashExePath.ReverseFind(&#39;\\&#39;); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FlashExePath = FlashExePath.Left(Len); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Sample.exe为编译好的Flash程序，存放在和VC程序同一目录下 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FlashExePath &nbsp;+= "\\Sample.exe";&nbsp; 


WinExec(FlashExePath,1); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return; 


} 


相关变量定义在对话框类的头文件中，作为成员变量： 


SOCKET Client;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //客户的连接请求 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SOCKET ServerSocket;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //SOCKET 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SOCKADDR_IN m_sockServerAddr;&nbsp; //SOCKET 结构 


4．在对话框程序中添加Socket的处理函数： 


头文件中添加： 


#define WM_CLIENT_ACCEPT WM_USER+101 


#define WM_CLIENT_READCLOSE WM_USER+102 


和 


LRESULT OnAccept(WPARAM wParam, LPARAM lParam); 


LRESULT OnReadClose(WPARAM wParam,LPARAM lParam); 


在CPP文件中添加消息映射宏和相关函数的实现： 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON_MESSAGE(WM_CLIENT_ACCEPT,OnAccept) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON_MESSAGE(WM_CLIENT_READCLOSE,OnReadClose) 


和 


LRESULT CSetupDlg::OnAccept(WPARAM wParam,LPARAM lParam) 


{ 


//出错返回 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (WSAGETSELECTERROR(lParam)) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0L; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(WSAGETSELECTEVENT(lParam) == FD_ACCEPT) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Client = accept(ServerSocket,(LPSOCKADDR)&amp;m_sockServerAddr,0); 



&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (Client == INVALID_SOCKET) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox("INVALID_SOCKET.",MB_ICONSTOP); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0L; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSAAsyncSelect(Client,m_hWnd,WM_CLIENT_READCLOSE,FD_READ|FD_CLOSE); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0L; 


} 


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 


LRESULT CSetupDlg::OnReadClose(WPARAM wParam,LPARAM lParam) 


{&nbsp;&nbsp; 


//在这里接收从Flash发送来的数据包，并解析它们，根据包中的数据不同通过Swith执行相//关的操作，可以调用其他的函数，需要将执行的结果返回（发送）给Flash。 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString str; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch (WSAGETSELECTEVENT(lParam)) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //这里的msg和msg中的相关定义都是自定义的结构体 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case FD_READ: 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(recv(Client,(char *)&amp;msg,sizeof(msg),0) == SOCKET_ERROR) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.Format("%s",msg.msg); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list.InsertString(0,str); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PSockmsg recmsg=(PSockmsg)msg.msg; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str=recmsg->msg; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch(recmsg->action) 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#39;D&#39;: 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#39;W&#39;: 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default: 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case FD_CLOSE: 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str = _T("client close."); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; closesocket(Client);//关闭Socket 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SendMessage(WM_CLOSE,NULL,NULL);//发送消息结束程序 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0L; 


} 


这段函数我就不多解释了，注意在OnOK中的WSAAsyncSelect调用确定了当收到发生Socket事件的时候发出WM_CLIENT_ACCEPT消息。第二个消息处理函数中用到了一些自定义的结构体，这是在和Flash统一以后确定的一些结构体，用于在Flash和VC程序之间传递消息参数的，这也是其重要的部分，需要根据实际的情况确定。 



&nbsp;

2．在Flash端：需要进行Socket连接，并组织并发送相关的Socket包，接收VC端返回的结果。参考代码： 


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 


function onsock(success) { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (success) { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _root.gotoAndPlay(2); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _root.gSock.connect("127.0.0.1", 9813);//连接VC程序 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp; function onsockclose() { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fscommand ("quit"); 


&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp; stop(); 


&nbsp;&nbsp;&nbsp; fscommand ("fullscreen", false); 


&nbsp;&nbsp;&nbsp; fscommand ("allowscale", false); 


&nbsp;&nbsp;&nbsp; fscommand ("showmenu", false); 


&nbsp;&nbsp;&nbsp; Stage.showMenu = false; 


&nbsp;&nbsp;&nbsp; var gSock = new XMLSocket ();//new一个Socket对象 


&nbsp;&nbsp;&nbsp; var installed = false; 


&nbsp;&nbsp;&nbsp; var usethreeside = false; 


&nbsp;&nbsp;&nbsp; var havewireless = false; 


&nbsp;&nbsp;&nbsp; var finished = false; 


&nbsp;&nbsp;&nbsp; var osys = true; 


&nbsp;&nbsp;&nbsp; var mem = true; 


&nbsp;&nbsp;&nbsp; var processor = true; 


&nbsp;&nbsp;&nbsp; var harddisk = true; 


&nbsp;&nbsp;&nbsp; var network = true; 


&nbsp;&nbsp;&nbsp; gSock.onClose = onsockclose;//指定Socket的相关回调函数 


&nbsp;&nbsp;&nbsp; _root.gSock.connect("127.0.0.1", 9813);//调用自定义的函数 


_root.gSock.onConnect = onsock; 


/////////////////////////////////////////////////////////////// 


//接收并判断相关的在VC程序段执行的结果。 


function onrecv(XMLDoc) { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var _local2; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _local2 = XMLDoc.toString(); 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_local2 == "failed") { 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _root.osys = false; 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _root.gotoAndPlay(196); 


&nbsp;&nbsp;&nbsp; } 


&nbsp;&nbsp;&nbsp; _root.stop(); 


&nbsp;&nbsp;&nbsp; _root.gSock.onXML = onrecv; 


&nbsp;&nbsp;&nbsp; var local1; 


&nbsp;&nbsp;&nbsp; local1 = "Wcheckos";//相关的信息组织 


&nbsp;&nbsp;&nbsp; _root.gSock.send(local1);//发送数据 



&nbsp;

就写这么多了，也许相关的说明不是很清楚，主要是因为在做这个工作的时候，Flash端都是公司的美工做的，我对Flash也不是很熟悉。一直想给大家做一个Demo程序，但是真的是由于本人对Flash的操作实在是有限，如果有相关的Flash高手愿意，可以联系我一起给大家做一个Demo。我现在的Mail为：vcleaner@sina.com。这种应用一般使用在安装程序上的比较多，通过Socket通信在VC程序端调用相关的函数执行一些在Flash中很难执行的操作，比如检测硬件，写系统注册表，Copy文件，调用第三方的程序等等。'></span><header class=post-header><h1 class=post-title itemprop="name headline">使用Flash彻底美化你的程序</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2005年07月09日 13:01:00 CST" itemprop="dateCreated datePublished" datetime="2005-07-09 13:01:00 +0800 +0800">2005年07月09日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/flash/ itemprop=url rel=index><span itemprop=name>dev/Flash</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>2359</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>5分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/enhancing-programs-with-flash/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p><span id=ArticleContent1_ArticleContent1_lblContent style=font-size:10pt> </p><p class=MsoNormal style=margin:0;text-indent:18pt><font size=3><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">曾经在</span><span lang=EN-US><font face="Times New Roman">VCKbase</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">（</span><span lang=EN-US><font face="Times New Roman">VC</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">知识库）网站看到过一篇关于</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">的文章，叫做</span><span lang=EN-US><a href="http://www.vckbase.com/document/viewdoc/?id=1201"><span lang=EN-US style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'"><span lang=EN-US>《</span></span><span lang=EN-US style=font-family:宋体;letter-spacing:.75pt;mso-bidi-font-size:10.5pt;mso-ascii-font-family:Tahoma;mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;mso-bidi-font-weight:bold><span lang=EN-US>在</span></span><span style=font-family:Tahoma;letter-spacing:.75pt;mso-bidi-font-size:10.5pt;mso-bidi-font-weight:bold>VC</span><span lang=EN-US style=font-family:宋体;letter-spacing:.75pt;mso-bidi-font-size:10.5pt;mso-ascii-font-family:Tahoma;mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;mso-bidi-font-weight:bold><span lang=EN-US>中使用</span></span><span style=font-family:Tahoma;letter-spacing:.75pt;mso-bidi-font-size:10.5pt;mso-bidi-font-weight:bold> Flash </span><span lang=EN-US style=font-family:宋体;letter-spacing:.75pt;mso-bidi-font-size:10.5pt;mso-ascii-font-family:Tahoma;mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;mso-bidi-font-weight:bold><span lang=EN-US>美化你的程序</span></span><span lang=EN-US style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'"><span lang=EN-US>》</span></span></a></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">，文章中介绍的是使用</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">控件在对话框程序中播放</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">文件。由于以前的工作需要曾经接触过使用</span><span lang=EN-US><font face="Times New Roman">Scoket</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">通信在</span><span lang=EN-US><font face="Times New Roman">VC</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">的</span><span lang=EN-US><font face="Times New Roman">Exe</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序和</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序中通信的相关技术。在这里介绍给大家。相比上面的那篇文章，其有一下有点：</span></font></p><p class=MsoNormal style="margin:0 0 0 36pt;text-indent:-18pt;mso-list:l2 level1 lfo1;tab-stops:list 36pt"><span lang=EN-US style="mso-fareast-font-family:'Times New Roman'"><span style=mso-list:Ignore><font face="Times New Roman"><font size=3>1、</font><span style="font:7pt times new roman">&nbsp; </span></font></span></span><font size=3><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">界面上更加优美。所有的界面部分都是直接使用</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">。</span></font></p><p class=MsoNormal style="margin:0 0 0 36pt;text-indent:-18pt;mso-list:l2 level1 lfo1;tab-stops:list 36pt"><span lang=EN-US style="mso-fareast-font-family:'Times New Roman'"><span style=mso-list:Ignore><font face="Times New Roman"><font size=3>2、</font><span style="font:7pt times new roman">&nbsp; </span></font></span></span><font size=3><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">所能完成的功能更加完备。几乎所有能在</span><span lang=EN-US><font face="Times New Roman">VC</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">的程序中能使用的功能都可以使用。</span></font></p><p class=MsoNormal style="margin:0 0 0 18pt"><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'"><font size=3>要做到以上两点所要做的工作也是很简单的，使用的技术也很简单。只要求以下几点：</font></span></p><p class=MsoNormal style="margin:0 0 0 36pt;text-indent:-18pt;mso-list:l0 level1 lfo2;tab-stops:list 36pt"><span lang=EN-US style="mso-fareast-font-family:'Times New Roman'"><span style=mso-list:Ignore><font face="Times New Roman"><font size=3>1、</font><span style="font:7pt times new roman">&nbsp; </span></font></span></span><font size=3><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">会使用简单的</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">编辑工具。会写简单的</span><span lang=EN-US><font face="Times New Roman">Flash Script</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">脚本。</span></font></p><p class=MsoNormal style="margin:0 0 0 36pt;text-indent:-18pt;mso-list:l0 level1 lfo2;tab-stops:list 36pt"><font face="Times New Roman"><span lang=EN-US style="mso-fareast-font-family:'Times New Roman'"><span style=mso-list:Ignore><font size=3>2、</font><span style="font:7pt times new roman">&nbsp; </span></span></span><span lang=EN-US><font size=3>Socket</font></span></font><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'"><font size=3>编程的相关知识。</font></span></p><p class=MsoNormal style="margin:0 0 0 28.45pt;text-indent:-10.5pt;mso-char-indent-count:-1;mso-para-margin-left:1.71gd"><font size=3><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序的原理就是：</span><span lang=EN-US><font face="Times New Roman">VC</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序</span><span lang=EN-US><font face="Times New Roman">(</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">对话框程序</span><span lang=EN-US><font face="Times New Roman">)</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">在启动以后最小化的任务栏，并建立一个</span><span lang=EN-US><font face="Times New Roman">Socket Server</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">进行侦听，在建立完</span><span lang=EN-US><font face="Times New Roman">Socket</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">和设置好相关的处理函数以后，启动编译为</span><span lang=EN-US><font face="Times New Roman">Exe</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">的</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序，</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序通过</span><span lang=EN-US><font face="Times New Roman">Socket</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">于</span><span lang=EN-US><font face="Times New Roman">VC</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序建立连接，将</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">界面上的操作转换为</span><span lang=EN-US><font face="Times New Roman">Socket</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">通信，让</span><span lang=EN-US><font face="Times New Roman">VC</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序处理完成以后将结果返回给</span><span lang=EN-US><font face="Times New Roman">Flash</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序。其简单的步骤为：</span></font></p><p class=MsoNormal style="margin:0 0 0 36pt;text-indent:-18pt;mso-list:l1 level1 lfo3;tab-stops:list 36pt"><span lang=EN-US style="mso-fareast-font-family:'Times New Roman'"><span style=mso-list:Ignore><font face="Times New Roman"><font size=3>1、</font><span style="font:7pt times new roman">&nbsp; </span></font></span></span><font size=3><b><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">在</span><span lang=EN-US><font face="Times New Roman">VC</font></span></b><b><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">程序端（或者其他任何编程语言的程序）：</span></b><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">建立一个对话框程序，在</span><span lang=EN-US><font face="Times New Roman">APP</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">类的</span><font face="Times New Roman"><b><span lang=EN-US style=color:#800;mso-font-kerning:0>InitInstance</span></b><b><span lang=EN-US style=color:#930;mso-font-kerning:0>()</span></b></font><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">函数中添加</span><span lang=EN-US><font face="Times New Roman">Scoket</font></span><span style="font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman'">初始化：</span></font></p><p class=MsoNormal style=margin:0;text-indent:18pt;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (!</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxSocketInit</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>())<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxMessageBox</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>IDP_SOCKETS_INIT_FAILED</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>FALSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style="margin:0 0 0 21pt"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3>}<p></p></font></font></span></b><p></p><p class=MsoNormal style="margin:0 0 0 36pt;text-indent:-18pt;mso-list:l1 level1 lfo3;tab-stops:list 36pt"><span lang=EN-US style=font-family:宋体;mso-bidi-font-family:宋体><span style=mso-list:Ignore><font size=3>2、</font><span style="font:7pt times new roman">&nbsp; </span></span></span><font size=3><span style=color:#000;font-family:宋体;mso-font-kerning:0>在对话框类的</span><b><span lang=EN-US style=color:#930;font-family:宋体;mso-font-kerning:0>OnInitDialog()</span></b><span style=color:#000;font-family:宋体;mso-font-kerning:0>函数中添加处理界面部分的程序段：</span><span lang=EN-US style=font-family:宋体><p></p></span></font><p></p><p class=MsoNormal style="margin:0 0 0 17.95pt;text-align:left;mso-layout-grid-align:none;mso-para-margin-left:1.71gd" align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#800;mso-font-kerning:0>MoveWindow</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(0,0,0,0);<span style=mso-tab-count:1>&nbsp; </span></span></b><b><span lang=EN-US style=color:#396;mso-font-kerning:0>//</span></b></font><b><span style="color:#396;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">将对话框程序界面改变为</span></b><font face="Times New Roman"><b><span lang=EN-US style=color:#396;mso-font-kerning:0>0</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font></font><p></p><p class=MsoNormal style="margin:0 0 0 17.95pt;text-align:left;mso-layout-grid-align:none;mso-para-margin-left:1.71gd" align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#800;mso-font-kerning:0>ShowWindow</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SW_SHOWMINIMIZED</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<span style=mso-tab-count:1>&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#396;mso-font-kerning:0>//</span></b></font><b><span style="color:#396;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">使界面最小化到任务栏</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style="margin:0 0 0 17.95pt;mso-para-margin-left:1.71gd"><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#800;mso-font-kerning:0>OnOK</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>();<span style=mso-tab-count:1> </span></span></b><b><span lang=EN-US style=color:#396;mso-font-kerning:0>//</span></b></font><b><span style="color:#396;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">调用对话框的</span></b><b><span lang=EN-US style=color:#396;mso-font-kerning:0><font face="Times New Roman">OnOK</font></span></b><b><span style="color:#396;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">函数</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style="margin:0 0 0 36pt;text-indent:-18pt;mso-list:l1 level1 lfo3;tab-stops:list 36pt"><span lang=EN-US style="color:#000;mso-fareast-font-family:'Times New Roman';mso-font-kerning:0"><span style=mso-list:Ignore><font face="Times New Roman"><font size=3>3、</font><span style="font:7pt times new roman">&nbsp; </span></font></span></span><font size=3><span style=color:#000;font-family:宋体;mso-font-kerning:0>在对话框类的</span><font face="Times New Roman"><b><span lang=EN-US style=color:#800;mso-font-kerning:0>OnOK</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>()</span></b></font><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">函数中建立</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Socket server</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">并侦听：</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-indent:26.25pt;text-align:left;mso-char-indent-count:2.49;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>WSADATA </span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>wsaData;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;</span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>int</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> iErrorCode;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>WSAStartup</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>MAKEWORD</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(2,1),&amp;wsaData))</span></b><b><span lang=EN-US style=color:#396;mso-font-kerning:0> //Windows Sockets DLL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;</span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxMessageBox</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"Winsock can not initialize."</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>MB_ICONSTOP</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>WSACleanup</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>();<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;</span></span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SendMessage</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0>//</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">关闭对话框程序</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p><font face="Times New Roman" size=3>&nbsp;</font></p></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0>//Create server Socket</span></b></font><b><span style="color:#090;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">，</span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0><font face="Times New Roman">type is SOCK_STREAM</font></span></b><b><span style="color:#090;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">，</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ServerSocket = </span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>socket</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>PF_INET</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SOCK_STREAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,0);<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;</span><p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(ServerSocket == </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>INVALID_SOCKET</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxMessageBox</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"</span></b><b><span lang=EN-US style=color:navy;mso-font-kerning:0>Could not create server Socket.</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>MB_ICONSTOP</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SendMessage</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0> //</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">关闭对话框程序</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p><font face="Times New Roman" size=3>&nbsp;</font></p></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:24pt;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0>m_sockServerAddr.sin_family = </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>AF_INET</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-indent:21.1pt;text-align:left;mso-char-indent-count:2;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#090;mso-font-kerning:0><font face="Times New Roman">//IP </font></span></b><b><span style="color:#090;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">设置为广播</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style="margin:0 0 0 21.1pt;text-indent:-21.1pt;text-align:left;mso-char-indent-count:-2;mso-layout-grid-align:none" align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>m_sockServerAddr.sin_addr.</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>s_addr</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> = </span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>inet_addr</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"127.0.0.1"</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style="margin:0 0 0 21.1pt;text-indent:-21.1pt;text-align:left;mso-char-indent-count:-2;mso-layout-grid-align:none" align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0>//</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">使用</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">9813</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">端口，自己编程的时候可以随意选择，最好使用</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">5000</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">以后的</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style="margin:0 0 0 21.1pt;text-indent:-21.1pt;text-align:left;mso-char-indent-count:-2;mso-layout-grid-align:none" align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>m_sockServerAddr.sin_port = </span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>htons</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(9813);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p><font face="Times New Roman" size=3>&nbsp;</font></p></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">//</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">绑定</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">Socket<p></p></font></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>bind</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(ServerSocket,(LPSOCKADDR)&amp;m_sockServerAddr,</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>sizeof</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(m_sockServerAddr)) == </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SOCKET_ERROR</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>) </span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0>//</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxMessageBox</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"Could not bind Server socket."</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>MB_ICONSTOP</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SendMessage</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0> //</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">关闭对话框程序</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>iErrorCode = </span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>WSAAsyncSelect</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(ServerSocket,m_hWnd,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLIENT_ACCEPT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>FD_ACCEPT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (iErrorCode == </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SOCKET_ERROR</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxMessageBox</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"Could not select socket."</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>MB_ICONSTOP</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SendMessage</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0> //</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">关闭对话框程序</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p><font face="Times New Roman" size=3>&nbsp;</font></p></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>listen</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(ServerSocket,1) == </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SOCKET_ERROR</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>) </span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0>//begin listen client</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxMessageBox</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"Could not listen."</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>MB_ICONSTOP</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SendMessage</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0>//</span></b></font><b><span style="color:#090;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">启动</span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0><font face="Times New Roman">Flash</font></span></b><b><span style="color:#090;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">程序</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>CString</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> FlashExePath;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>char</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> DialogExePath[256];<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0>//</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">获得对话框程序的路径，包含文件名</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>GetModuleFileName</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(0, DialogExePath, </span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>sizeof</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(DialogExePath));<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FlashExePath = DialogExePath;<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-spacerun:yes>&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0>//</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">去除对话框程序文件名，获得所在目录路径</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>int</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> Len = FlashExePath.</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>ReverseFind</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>'\\'</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FlashExePath = FlashExePath.</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>Left</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(Len);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0>// Sample.exe</span></b></font><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">为编译好的</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">Flash</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">程序，存放在和</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">VC</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">程序同一目录下</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FlashExePath <span style=mso-spacerun:yes>&nbsp;</span>+= </span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"\\Sample.exe"</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<span style=mso-tab-count:1>&nbsp;</span><p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#800;mso-font-kerning:0>WinExec</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(FlashExePath,1);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">相关变量定义在对话框类的头文件中，作为成员变量：</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:blue;mso-font-kerning:0>SOCKET</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> Client;<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0>//</span></b></font><b><span style="color:#090;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">客户的连接请求</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>SOCKET</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> ServerSocket;<span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0>//SOCKET </span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>SOCKADDR_IN</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> m_sockServerAddr;<span style=mso-spacerun:yes>&nbsp; </span></span></b><b><span lang=EN-US style=color:#090;mso-font-kerning:0>//SOCKET </span></b></font><b><span style="color:#090;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">结构</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">4</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">．在对话框程序中添加</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Socket</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">的处理函数：</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">头文件中添加：</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>#define </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLIENT_ACCEPT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_USER</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>+101<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>#define </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLIENT_READCLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_USER</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>+102<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">和</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LRESULT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>OnAccept</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>WPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> wParam, </span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> lParam);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LRESULT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>OnReadClose</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>WPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> wParam,</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> lParam);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">在</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">CPP</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">文件中添加消息映射宏和相关函数的实现：</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>ON_MESSAGE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLIENT_ACCEPT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,OnAccept)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>ON_MESSAGE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLIENT_READCLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,OnReadClose)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><span style=color:#000;font-family:宋体><font size=3>和<span lang=EN-US><p></p></span></font></span><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LRESULT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>CSetupDlg</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>::</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>OnAccept</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>WPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> wParam,</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> lParam)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">//</font></span></b><b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">出错返回</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WSAGETSELECTERROR</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(lParam))<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> <chmetcnv w:st=on tcsc=0 numbertype=1 negative=False hasspace=False sourcevalue=0 unitname=l>0L</chmetcnv>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WSAGETSELECTEVENT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(lParam) == </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>FD_ACCEPT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>Client = </span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>accept</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(ServerSocket,(LPSOCKADDR)&amp;m_sockServerAddr,0);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p><font face="Times New Roman" size=3>&nbsp;</font></p></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (Client == </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>INVALID_SOCKET</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>AfxMessageBox</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"</span></b><b><span lang=EN-US style=color:navy;mso-font-kerning:0>INVALID_SOCKET.</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>MB_ICONSTOP</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> <chmetcnv w:st=on tcsc=0 numbertype=1 negative=False hasspace=False sourcevalue=0 unitname=l>0L</chmetcnv>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>WSAAsyncSelect</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(Client,m_hWnd,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLIENT_READCLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>FD_READ</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>|</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>FD_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> <chmetcnv w:st=on tcsc=0 numbertype=1 negative=False hasspace=False sourcevalue=0 unitname=l>0L</chmetcnv>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman"><font size=3>///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LRESULT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>CSetupDlg</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>::</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>OnReadClose</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>WPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> wParam,</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>LPARAM</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> lParam)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3>{<span style=mso-spacerun:yes>&nbsp;&nbsp;</span><p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">//</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">在这里接收从</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">Flash</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">发送来的数据包，并解析它们，根据包中的数据不同通过</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">Swith</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">执行相</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">//</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">关的操作，可以调用其他的函数，需要将执行的结果返回（发送）给</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman">Flash</font></span></b><b><span style="color:green;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">。</span></b><b><span lang=EN-US style=color:green;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>CString</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> str;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>switch</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> (</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WSAGETSELECTEVENT</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(lParam))<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</font></span></b><b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">这里的</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">msg</font></span></b><b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">和</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">msg</font></span></b><b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">中的相关定义都是自定义的结构体</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>case</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>FD_READ</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>:<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>if</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>recv</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(Client,(</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>char</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> *)&amp;msg,</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>sizeof</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(msg),0) == </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SOCKET_ERROR</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> 0;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>str.</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>Format</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"%s"</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,msg.msg);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>list.</span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>InsertString</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(0,str);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>PSockmsg</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> recmsg=(</span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>PSockmsg</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>)msg.msg;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>str=recmsg->msg;<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>switch</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(recmsg->action)<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>case</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>'D'</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>:<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>break</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>case</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>'W'</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>:<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:5>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>break</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>default</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>:<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>break</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>case</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>FD_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>:<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>str = </span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>_T</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#007;mso-font-kerning:0>"client close."</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#800;mso-font-kerning:0>closesocket</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(Client);//</span></b></font><b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">关闭</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Socket<p></p></font></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><font face="Times New Roman"><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>SendMessage</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>(</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>WM_CLOSE</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>,</span></b><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0>NULL</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>);//</span></b></font><b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">发送消息结束程序</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>break</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font face="Times New Roman"><font size=3><b><span lang=EN-US style=color:#000;mso-font-kerning:0><span style=mso-tab-count:1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang=EN-US style=color:blue;mso-font-kerning:0>return</span></b><b><span lang=EN-US style=color:#000;mso-font-kerning:0> <chmetcnv w:st=on tcsc=0 numbertype=1 negative=False hasspace=False sourcevalue=0 unitname=l>0L</chmetcnv>;<p></p></span></b></font></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman"><font size=3>}<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><span style=color:#000;font-family:宋体>这段函数我就不多解释了，注意在<span lang=EN-US>OnOK</span>中的</span><b><span lang=EN-US style=color:#936;mso-font-kerning:0><font face="Times New Roman">WSAAsyncSelect</font></span></b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">调用确定了当收到发生</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Socket</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">事件的时候发出</span><b><span lang=EN-US style=color:#a000a0;mso-font-kerning:0><font face="Times New Roman">WM_CLIENT_ACCEPT</font></span></b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">消息。第二个消息处理函数中用到了一些自定义的结构体，这是在和</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Flash</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">统一以后确定的一些结构体，用于在</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Flash</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">和</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">VC</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">程序之间传递消息参数的，这也是其重要的部分，需要根据实际的情况确定。</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><span lang=EN-US style=color:#000;mso-font-kerning:0><p><font face="Times New Roman" size=3>&nbsp;</font></p></span><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">2</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">．<b>在</b></span><b><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Flash</font></span></b><b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">端</span></b><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">：需要进行</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Socket</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">连接，并组织并发送相关的</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">Socket</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">包，接收</span><span lang=EN-US style=color:#000;mso-font-kerning:0><font face="Times New Roman">VC</font></span><span style="color:#000;font-family:宋体;mso-ascii-font-family:'Times New Roman';mso-hansi-font-family:'Times New Roman';mso-font-kerning:0">端返回的结果。参考代码：</span><span lang=EN-US style=color:#000;mso-font-kerning:0><p></p></span></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:green;mso-font-kerning:0><font face="Times New Roman"><font size=3>///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////<p></p></font></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3>function onsock(success) {<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (success) {<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_root.gotoAndPlay(2);<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} else {<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#936;font-family:宋体><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_root.gSock.connect("127.0.0.1", 9813);</span></b><b><span lang=EN-US style=color:green;font-family:宋体>//</span></b><b><span style=color:green;font-family:宋体>连接<span lang=EN-US>VC</span>程序</span></b><b><span lang=EN-US style=color:#936;font-family:宋体><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>}<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>function onsockclose() {<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fscommand ("quit");<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>}<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>stop();<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>fscommand ("fullscreen", false);<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>fscommand ("allowscale", false);<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>fscommand ("showmenu", false);<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>Stage.showMenu = false;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#936;font-family:宋体><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var gSock = new XMLSocket ();</span></b><b><span lang=EN-US style=color:green;font-family:宋体>//new</span></b><b><span style=color:green;font-family:宋体>一个<span lang=EN-US>Socket</span>对象</span></b><b><span lang=EN-US style=color:#936;font-family:宋体><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var installed = false;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var usethreeside = false;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var havewireless = false;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var finished = false;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var osys = true;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var mem = true;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var processor = true;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var harddisk = true;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var network = true;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#936;font-family:宋体><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>gSock.onClose = onsockclose;</span></b><b><span lang=EN-US style=color:green;font-family:宋体>//</span></b><b><span style=color:green;font-family:宋体>指定<span lang=EN-US>Socket</span>的相关回调函数<span lang=EN-US><p></p></span></span></b></font><p></p><p class=MsoNormal style=margin:0;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#936;font-family:宋体><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>_root.gSock.connect("127.0.0.1", 9813);</span></b><b><span lang=EN-US style=color:green;font-family:宋体>//</span></b><b><span style=color:green;font-family:宋体>调用自定义的函数<span lang=EN-US><p></p></span></span></b></font><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3>_root.gSock.onConnect = onsock;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:green;font-family:宋体><font size=3>///////////////////////////////////////////////////////////////<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:green;font-family:宋体>//</span></b><b><span style=color:green;font-family:宋体>接收并判断相关的在<span lang=EN-US>VC</span>程序段执行的结果。<span lang=EN-US><p></p></span></span></b></font><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3>function onrecv(XMLDoc) {<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>var _local2;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_local2 = XMLDoc.toString();<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (_local2 == "failed") {<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_root.osys = false;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_root.gotoAndPlay(196);<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>}<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>_root.stop();<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>_root.gSock.onXML = onrecv;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><font size=3><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>var local1;<p></p></font></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#936;font-family:宋体><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>local1 = "Wcheckos";</span></b><b><span lang=EN-US style=color:green;font-family:宋体>//</span></b><b><span style=color:green;font-family:宋体>相关的信息组织</span></b><b><span lang=EN-US style=color:#936;font-family:宋体><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><font size=3><b><span lang=EN-US style=color:#936;font-family:宋体><span style=mso-spacerun:yes>&nbsp;&nbsp;&nbsp; </span>_root.gSock.send(local1);</span></b><b><span lang=EN-US style=color:green;font-family:宋体>//</span></b><b><span style=color:green;font-family:宋体>发送数据</span></b><b><span lang=EN-US style=color:#936;font-family:宋体><p></p></span></b></font><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><b><span lang=EN-US style=color:#936;font-family:宋体><p><font size=3>&nbsp;</font></p></span></b><p></p><p class=MsoNormal style=margin:0;text-indent:21pt;text-align:left;mso-layout-grid-align:none align=left><span style=color:#000;font-family:宋体><font size=3>就写这么多了，也许相关的说明不是很清楚，主要是因为在做这个工作的时候，<span lang=EN-US>Flash</span>端都是公司的美工做的，我对<span lang=EN-US>Flash</span>也不是很熟悉。一直想给大家做一个<span lang=EN-US>Demo</span>程序，但是真的是由于本人对<span lang=EN-US>Flash</span>的操作实在是有限，如果有相关的<span lang=EN-US>Flash</span>高手愿意，可以联系我一起给大家做一个<span lang=EN-US>Demo</span>。我现在的<span lang=EN-US>Mail</span>为：<span lang=EN-US><a href=mailto:vcleaner@sina.com>vcleaner@sina.com</a></span>。这种应用一般使用在安装程序上的比较多，通过<span lang=EN-US>Socket</span>通信在<span lang=EN-US>VC</span>程序端调用相关的函数执行一些在<span lang=EN-US>Flash</span>中很难执行的操作，比如检测硬件，写系统注册表，<span lang=EN-US>Copy</span>文件，调用第三方的程序等等。</font></span></p></span><a id=more></a></div><footer class=post-footer><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
使用Flash彻底美化你的程序</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/enhancing-programs-with-flash/ title=使用Flash彻底美化你的程序>https://blogs.qipai360.cn/post/enhancing-programs-with-flash/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/i-love-you-true-meaning/ rel=next title="I Love You的真正含义"><i class="fa fa-chevron-left"></i> I Love You的真正含义</a></div><div class="post-nav-prev post-nav-item"><a href=/post/video-demo-application-splash-screen/ rel=prev title=将视频演示作为应用程序的启动封面>将视频演示作为应用程序的启动封面
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.152.2 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"enhancing-programs-with-flash","permalink":"https://blogs.qipai360.cn/post/enhancing-programs-with-flash/","title":"使用Flash彻底美化你的程序","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1761990624" defer></script></body></html>