<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.152.2"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_32_32_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_128_128_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Visual Studio 2010中C++项目升级指南"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta name=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blogs.qipai360.cn/imgs/avatar.jpg"><meta itemprop=keywords content="Rise,ZhangTuohui,技术,C++,Unity3D,Lua,NodeJS,C#,JavaScript,游戏开发,机器学习,深度学习,AI,编程,编程语言,编程技术,编程开发,游戏引擎,游戏设计,游戏制作,游戏开发者,游戏开发者博客,游戏开发者网站,游戏开发者工具,游戏开发者教程,游戏开发者学习,游戏开发者交流,游戏开发者分享,游戏开发者经验,游戏开发者心得,游戏开发者技巧,游戏开发者方法,游戏开发者思路,游戏开发者理念,游戏开发者文化,游戏开发者精神,游戏开发者信仰"><meta property="og:type" content="article"><meta property="og:title" content="Visual Studio 2010中C++项目升级指南"><meta property="og:description" content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blogs.qipai360.cn/post/c-project-upgrade-guide-for-visual-studio-2010/"><meta property="og:site_name" content="Rise的自留地"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rise"><meta property="article:published_time" content="2010-04-28 09:36:00 +0800 +0800"><meta property="article:modified_time" content="2010-04-28 09:36:00 +0800 +0800"><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1761990626"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "2b23669184fc49269e400525ac2447d9"}'></script><title>Visual Studio 2010中C++项目升级指南 - Rise的自留地</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Rise的自留地</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>记录生活中的点滴，分享编程技术和游戏开发经验。</p></div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>678</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-message"><a href=/message/ class=hvr-icon-pulse rel=section><i class="fa fa-comments hvr-icon"></i>留言板</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rise src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>Rise</p><div class=site-description itemprop=description>福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>678</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>34</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>117</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/rise-worlds title="Github → https://github.com/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:rise.worlds@outlook.com title="E-Mail → mailto:rise.worlds@outlook.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/rise-worlds title="知乎 → https://www.zhihu.com/people/rise-worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=https://twitter.com/riseworlds title="Twitter → https://twitter.com/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>
Twitter
</a></span><span class=links-of-social-item><a href=https://www.facebook.com/rise.worlds title="facebook → https://www.facebook.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
facebook
</a></span><span class=links-of-social-item><a href=https://youtube.com/@YiXuan title="YouTube → https://youtube.com/@YiXuan" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
YouTube
</a></span><span class=links-of-social-item><a href=https://instagram.com/rise.worlds title="Instagram → https://instagram.com/rise.worlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
Instagram
</a></span><span class=links-of-social-item><a href=https://t.me/riseworlds title="Telegram → https://t.me/riseworlds" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-telegram fa-fw hvr-icon"></i>
Telegram</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.qipai360.cn title=https://www.qipai360.cn target=_blank>Qipai360</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/flying_bat title=https://www.cnblogs.com/flying_bat target=_blank>博客园</a></li><li class=links-of-blogroll-item><a href=https://zishu.me title=https://zishu.me target=_blank>子舒的博客</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2004-10-06 15:24:00 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2418817></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5198></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2025-11-01 14:55:00 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/rise-worlds rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blogs.qipai360.cn/post/c-project-upgrade-guide-for-visual-studio-2010/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="Rise"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rise"><meta itemprop=description content="福兮祸兮，焉知所依？冬去冰泮，春来萌荣。朝生暮死，亦可惊鸿。知足者富，自足者强。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Visual Studio 2010中C++项目升级指南"><meta itemprop=description content="如何升级？  Visual Studio 2010支持来自VC6、Visual Studio 2002、Visual Studio 2003、Visual Studio 2005和Visual Studio 2008的升级。同Visual Studio的早期版本一样，你可以选择通过IDE的转换向导或者是命令行工具（Devenv/upgrade）来完成升级。  以下是升级过程中的一些建议：  1) 把升级环境与构建环境设置成相同的  升级过程中会尝试加载一些文件，另外还会评估一些值。如果你的项目中所使用的值不是在项目文件中自己定义的，例如在环境变量中定义的值，那就需要在升级之前事先设置好这些环境变量。如果这些环境变量设置不当，则可能会因为无法对值进行评估而出现警告或错误。  2)&nbsp; 在升级之前确保你已经安装了必要的平台  在一台没有可用平台的机器上对项目进行转换，可能会导致转换错误。例如，如果你想在Visual Studio Professional SKU中对安腾平台的一个项目进行转换，由于它不支持安腾平台，你就会看到像下面这样的转换出错信息：   Failed to upgrade 'Debug|<Itanium>'. Please make sure you have the corresponding platform&nbsp; installed under '%vctargetspath%\platforms\Itanium'. Cannot load the project due to a corrupt&nbsp; project file. The following error has occurred during XML parsing:&nbsp;&nbsp; File: D:\Sample\ConsoleApp\ConsoleApp.vcproj&nbsp;&nbsp; Line: 28&nbsp;&nbsp; Column: 5&nbsp;&nbsp; Error Message:&nbsp;&nbsp; System error: -2147154677.&nbsp;&nbsp; The file 'D:\Sample\ConsoleApp\ConsoleApp.vcproj' has failed to load.  　　这是因为转换过程需要那些平台的属性值才能成功进行。你可以通过查看以下目录获悉已安装了哪些平台：%ProgramFiles%\MSBuild\Microsoft.cpp\V4.0\Platforms （或者查看x64平台下的 %ProgramFiles(x86)%\MSBuild\Microsoft.cpp\V4.0\Platforms ）。  　　3) 如果可能的话，使用本地的多定向支持来对Visual Studio 2008工具集进行构建  　　在Visual Studio&nbsp; 2010中，我们新增了本地的多定向支持（Multi-Targeting），通过使用新的基于MSBuild的项目系统，你可以在Visual Studio 2010的IDE中为Visual Studio 2008工具集构建目标。关于这一特性，你可以看看这篇博客。我们建议用户，特别是拥有大型代码库的用户，在升级时先利用这一特性在Visual Studio 2010中构建Visual Studio 2008工具集的程序。这样，当你在升级过程中碰到问题，就可以把那些跟项目系统或构建系统相关的问题与工具的问题区别开来。这将会让你更加平滑地升级到Visual Studio 2010 工具集。  　　一旦升级完成，属性表文件(.Visual Studio props)就会被转换成新的格式(.props)。同样，项目文件（.vcproj）也会被转换为新的格式（.vcxproj）。值得注意的是，新的项目文件会与旧的项目文件同时生成。在转换过程中还产生了一种新的文件类型（.filter .vcxproj），该过滤器文件包含用来显示解决方案的资源管理器文件夹信息。该过滤器信息原本是项目文件的一部分，然而这种变化是必要的，因为只要项目文件发生变化，MSBuild就会请求重新构建。通过在一个单独的文件中保存过滤器信息，就可以在避免重新构建整个项目的情况下修改过滤器。  　　注意：升级过程不会转换.user文件。因此，你的调试和部署设置在转换后将不会被保留。  　　在Visual Studio 2010中，一个新的命令行升级工具 VCUpgrade.exe也被加入了进来。此命令行工具，适合在只有一个项目的情况下进行升级，因为它无法把解决方案文件作为输入，并将其解析成项目文件。VCUpgrade.exe位于 $（Visual Studio InstallDir）\ common7 \ Tools目录下，该工具也将附带在WinSDK的下一个版本中，这样用户就可以在没有Visual Studio IDE的情况下用命令行对WinSDK中的项目文件进行升级。  　　升级过程中的警告  　　以下是转换过程中，你可能会遇到的一些常见警告：  　　1) 链接器输出目录  　　在升级时你可能会看到的一个警告是MSB8012：$(TargetPath)和链接器的OutputFile属性的值不匹配：   - MSB8012: $(TargetExt) ('.dll') does not match the Linker's OutputFile&nbsp; property value 'C:\foo\Debug\MFCActiveX.ocx' ('.ocx') in project configuration 'Debug|Win32'.&nbsp; This may cause your project to build incorrectly. To correct this, please make sure that $(TargetExt)&nbsp; property value matches the value specified in %(Link.OutputFile).&nbsp;&nbsp; - MSB8012: $(TargetPath) ('C:\foo\Debug\MFCActiveX.dll') does not match the Linker's OutputFile&nbsp; property value 'C:\foo\Debug\MFCActiveX.ocx' ('C:\foo\Debug\MFCActiveX.ocx') in project&nbsp; configuration 'Debug|Win32'. This may cause your project to build incorrectly.&nbsp; To correct this, please make sure that $(TargetPath) property&nbsp; value matches the value specified in %(Link.OutputFile).  　　Link.OutputFile是在属性页中Linker-> General -> Output File 这一项中定义的值。默认情况下，它的值是$（OutDir）$（TargetName）$（TargetExt），与$（TargetPath）相同。当我们把一个应用程序从之前的版本转换过来时，并没有办法可以很好地解析出Link.OutputFile被$(TargetName)和$(TargetExt)的值，因为不同的用户可能用不同的方法对其进行了赋值。为了解决这一点，我们决定在转换过程中保留Linker.OutputFile中的值。在转换之后，$（TargetName）将默认为$（ProjectName），$（TargetExt）将默认为该类应用程序的默认扩展名：动态库文件为.dll，静态库为.lib，应用程序则为.exe，而Link.OutputFile值则将被保留。如果Link.OutputFile与$(TargetPath)不同，警告MSB8012会被记录在转换日志中。在构建应用程序时你也会看到同样的警告。  　　$（OutDir），$（TargetName）和$（TargetExt）在“常规”属性页中分别对应“Output Directory”，“Target Name”，“Target Extension”。你可以手动更改这些属性的值，这样你就不会再看到警告了。  　　－如果你的项目生成了导入库（Linker -> Advanced -> Import Library），而且链接器的输出目录不是默认目录，那么你可能还需要更改导入库的输出文件夹。否则，生成的导入库所在的目录就可能会与链接器的输出不同。  　　－调试。转换后命令被设为默认的$(TargetPath)。你可能需要做一些改动，这样当按下F5 (Debugging)或 Ctrl + F5 (Start without debugging)之后才能加载正确的可执行程序。  &nbsp;"></span><header class=post-header><h1 class=post-title itemprop="name headline">Visual Studio 2010中C++项目升级指南</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2010年04月28日 09:36:00 CST" itemprop="dateCreated datePublished" datetime="2010-04-28 09:36:00 +0800 +0800">2010年04月28日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/toolstips/ itemprop=url rel=index><span itemprop=name>ToolsTips</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>6993</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>14分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/post/c-project-upgrade-guide-for-visual-studio-2010/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p><strong>如何升级？</strong><p><a href=http://developer.51cto.com/art/200908/141551.htm><strong></strong>Visual Studio 2010</a>支持来自VC6、Visual Studio 2002、Visual Studio 2003、Visual Studio 2005和Visual Studio 2008的升级。同Visual Studio的早期版本一样，你可以选择通过IDE的转换向导或者是命令行工具（Devenv/upgrade）来完成升级。<p><strong><strong></strong>以下是升级过程中的一些建议：</strong><p><strong></strong>1) 把升级环境与构建环境设置成相同的<p><strong></strong>升级过程中会尝试加载一些文件，另外还会评估一些值。如果你的项目中所使用的值不是在项目文件中自己定义的，例如在环境变量中定义的值，那就需要在升级之前事先设置好这些环境变量。如果这些环境变量设置不当，则可能会因为无法对值进行评估而出现警告或错误。<p><strong></strong>2)&nbsp; 在升级之前确保你已经安装了必要的平台<p><strong></strong>在一台没有可用平台的机器上对项目进行转换，可能会导致转换错误。例如，如果你想在Visual Studio Professional SKU中对安腾平台的一个项目进行转换，由于它不支持安腾平台，你就会看到像下面这样的转换出错信息：<ol><li>Failed to upgrade 'Debug|&lt;Itanium>'. Please make sure you have the corresponding platform&nbsp;<li>installed under '%vctargetspath%\platforms\Itanium'. Cannot load the project due to a corrupt&nbsp;<li>project file. The following error has occurred during XML parsing:&nbsp;&nbsp;<li>File: D:\Sample\ConsoleApp\ConsoleApp.vcproj&nbsp;&nbsp;<li>Line: 28&nbsp;&nbsp;<li>Column: 5&nbsp;&nbsp;<li>Error Message:&nbsp;&nbsp;<li>System error: -2147154677.&nbsp;&nbsp;<li>The file 'D:\Sample\ConsoleApp\ConsoleApp.vcproj' has failed to load.</li></ol><p>　　这是因为转换过程需要那些平台的属性值才能成功进行。你可以通过查看以下目录获悉已安装了哪些平台：%ProgramFiles%\MSBuild\Microsoft.cpp\V4.0\Platforms （或者查看x64平台下的 %ProgramFiles(x86)%\MSBuild\Microsoft.cpp\V4.0\Platforms ）。<p>　　3) 如果可能的话，使用本地的多定向支持来对Visual Studio 2008工具集进行构建<p>　　在Visual Studio&nbsp; 2010中，我们新增了本地的多定向支持（Multi-Targeting），通过使用新的基于MSBuild的项目系统，你可以在Visual Studio 2010的IDE中为Visual Studio 2008工具集构建目标。关于这一特性，你可以看看这篇博客。我们建议用户，特别是拥有大型代码库的用户，在升级时先利用这一特性在Visual Studio 2010中构建Visual Studio 2008工具集的程序。这样，当你在升级过程中碰到问题，就可以把那些跟项目系统或构建系统相关的问题与工具的问题区别开来。这将会让你更加平滑地升级到Visual Studio 2010 工具集。<p>　　一旦升级完成，属性表文件(.Visual Studio props)就会被转换成新的格式(.props)。同样，项目文件（.vcproj）也会被转换为新的格式（.vcxproj）。值得注意的是，新的项目文件会与旧的项目文件同时生成。在转换过程中还产生了一种新的文件类型（.filter .vcxproj），该过滤器文件包含用来显示解决方案的资源管理器文件夹信息。该过滤器信息原本是项目文件的一部分，然而这种变化是必要的，因为只要项目文件发生变化，MSBuild就会请求重新构建。通过在一个单独的文件中保存过滤器信息，就可以在避免重新构建整个项目的情况下修改过滤器。<p><strong>　　注意：升级过程不会转换.user文件。因此，你的调试和部署设置在转换后将不会被保留。</strong><p>　　在Visual Studio 2010中，一个新的命令行升级工具 VCUpgrade.exe也被加入了进来。此命令行工具，适合在只有一个项目的情况下进行升级，因为它无法把解决方案文件作为输入，并将其解析成项目文件。VCUpgrade.exe位于 $（Visual Studio InstallDir）\ common7 \ Tools目录下，该工具也将附带在WinSDK的下一个版本中，这样用户就可以在没有Visual Studio IDE的情况下用命令行对WinSDK中的项目文件进行升级。<p>　　升级过程中的警告<p><strong>　　以下是转换过程中，你可能会遇到的一些常见警告：</strong><p>　　1) 链接器输出目录<p>　　在升级时你可能会看到的一个警告是MSB8012：$(TargetPath)和链接器的OutputFile属性的值不匹配：<ol><li>- MSB8012: $(TargetExt) ('.dll') does not match the Linker's OutputFile&nbsp;<li>property value 'C:\foo\Debug\MFCActiveX.ocx' ('.ocx') in project configuration 'Debug|Win32'.&nbsp;<li>This may cause your project to build incorrectly. To correct this, please make sure that $(TargetExt)&nbsp;<li>property value matches the value specified in %(Link.OutputFile).&nbsp;&nbsp;<li>- MSB8012: $(TargetPath) ('C:\foo\Debug\MFCActiveX.dll') does not match the Linker's OutputFile&nbsp;<li>property value 'C:\foo\Debug\MFCActiveX.ocx' ('C:\foo\Debug\MFCActiveX.ocx') in project&nbsp;<li>configuration 'Debug|Win32'. This may cause your project to build incorrectly.&nbsp;<li>To correct this, please make sure that $(TargetPath) property&nbsp;<li>value matches the value specified in %(Link.OutputFile).</li></ol><p>　　Link.OutputFile是在属性页中Linker-> General -> Output File 这一项中定义的值。默认情况下，它的值是$（OutDir）$（TargetName）$（TargetExt），与$（TargetPath）相同。当我们把一个应用程序从之前的版本转换过来时，并没有办法可以很好地解析出Link.OutputFile被$(TargetName)和$(TargetExt)的值，因为不同的用户可能用不同的方法对其进行了赋值。为了解决这一点，我们决定在转换过程中保留Linker.OutputFile中的值。在转换之后，$（TargetName）将默认为$（ProjectName），$（TargetExt）将默认为该类应用程序的默认扩展名：动态库文件为.dll，静态库为.lib，应用程序则为.exe，而Link.OutputFile值则将被保留。如果Link.OutputFile与$(TargetPath)不同，警告MSB8012会被记录在转换日志中。在构建应用程序时你也会看到同样的警告。<p>　　$（OutDir），$（TargetName）和$（TargetExt）在“常规”属性页中分别对应“Output Directory”，“Target Name”，“Target Extension”。你可以手动更改这些属性的值，这样你就不会再看到警告了。<p>　　－如果你的项目生成了导入库（Linker -> Advanced -> Import Library），而且链接器的输出目录不是默认目录，那么你可能还需要更改导入库的输出文件夹。否则，生成的导入库所在的目录就可能会与链接器的输出不同。<p>　　－调试。转换后命令被设为默认的$(TargetPath)。你可能需要做一些改动，这样当按下F5 (Debugging)或 Ctrl + F5 (Start without debugging)之后才能加载正确的可执行程序。<p>&nbsp;</p><a id=more></a><p><strong>　2) 属性表的排序</strong><p>　　如果你的应用程序有属性表，那么在转换过程中你可能会遇到下面的警告中：<ol><li>- All user macros reported below for configuration 'Debug|Win32' are used before their definition,&nbsp;<li>which can cause undesirable build results; this is not supported in this release.&nbsp;<li>You can resolve this by changing the inclusion order&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<li>of the consuming property sheets and making sure they come after the property sheets defining the user macros.&nbsp;&nbsp;<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - MSB4211: C:\foo\PropertySheet\foo.props;&nbsp;<li>The property "MyIncludePath" is being set to a value for the first time,&nbsp;<li>but it was already consumed at "C:\foo\PropertySheet\bar.props".</li></ol><p>　　该警告归因于MSBuild对其属性的评估方式：MSBuild按顺序依次评估其属性值。如果在派生的属性表中定义的属性在父属性表中被使用，那么其值就会被设为空。然而，VCBuild采用的是延迟评估方式。这样，即使是在派生属性表中定义的属性也可以在父属性表中使用。若要解决此问题，请按照警告消息改变属性表中的顺序，从而确保属性在定义后才被使用。<p><strong>　　升级后的行为变化</strong><p>　　尽管底层的构建系统已经发生了改变，但我们仍尽力让用户在迁移到Visual Studio 2010后有相同的使用体验。另外，我们还采取了一些措施来改进构建体验或是迎合MSBuild的某些特定要求。因此，一旦你迁移到Visual Studio 2010，就可能就会注意到以下一些变化。<p>　　1) 从“解决方案依赖”到“项目到项目的引用”<p>　　如果在一个旧版本Visual Studio版本下进行编译的C++程序被转换到Visual Studio 2010后，解决方案级定义的项目依赖关系便会被转化成项目到项目的引用（project to project references）。这一变化确保了C + +项目依赖关系能够在项目文件中被捕获。下面就是一个项目到项目的引用在项目文件中的样子：<ol><li>&lt;ItemGroup><li>&lt;ProjectReference Include="..\Cpp\Cpp.vcxproj"><li>&lt;Project>{c58574bf-9dd8-4cf8-b5b6-6551f2f3eece}&lt;/Project><li>&lt;ReferenceOutputAssembly>false&lt;/ReferenceOutputAssembly><li>&lt;/ProjectReference><li>&lt;/ItemGroup></li></ol><pre></pre><p>　　在项目文件中存放依赖关系有几个优点。首先，用户可以在不用解决方案的情况下构建一个项目，相关的项目会自动被构建。第二，它为那些拥有巨大的代码树又可能不会使用解决方案文件的用户提供了方便。 此外，许多客户都有好几个解决方案文件，每个文件都包含项目的不同子集。通过这种方式就可以让用户避免为每个解决方案设置依赖关系。另一个重要因素就是，使用项目到项目的引用使得构建过程更加可靠，尤其是在多核的环境下。这与Visual Studio早期版本的情况也是一致的。<p>　　－如果某个C#程序依赖于一个C++程序，并且这一依赖只使用了解决方案依赖关系表示，那么现在的这种转换并不会把解决方案依赖关系转换成项目到项目的引用。你可能会碰到因为不正确的构建顺序而导致的构建错误，尤其是使用命令行直接进行MSBuild构建的时候。要解决该问题，你得为C#和C++程序手动设置项目到项目的引用。<p>　　－在Visual Studio 2010中设置新的构建依赖关系时，通常都要用项目到项目的引用替代解决方案依赖。<p>　　2)&nbsp; 项目到项目引用属性的变化<p>　　转换后，CopyLocalDependencies和UseDependenciesInBuild属性会被去除。“Use in Build”属性改为“Reference Assembly Output”，以更好地表示该属性的作用。另外两个属性：“Link Library Dependencies”和“Use Library Dependency Inputs”增加到了被引用的那个项目中，以便被引用的项目控制它的输出是否被传递到引用它的那个项目中。以下是Visual Studio 2008和Visual Studio 2010项目到项目引用属性的对比图。<p><a href=http://images.51cto.com/files/uploadimg/20100310/0933400.jpg><img border=0 alt=对比图 src=http://images.51cto.com/files/uploadimg/20100310/0933400.jpg width=553 height=129></a><p>　　－把“Reference Assembly Output”设为“false”会允许该项目成为项目到项目引用的一部分，从而设置构建依赖关系，而它的输出不会被传递到引用它的那个项目的CL中。此属性用于被托管的程序。<p>　　－把“Link Library Dependencies”设为“false”，会允许该项目成为项目到项目引用的一部分，从而设置构建依赖关系，而它的输出不会被传递到引用它的那个项目的链接器中。<p>　　3）VC + +目录变化<p>　　Visual Studio 2010不再支持在Tools->Options中设置VC + +目录。相反，Visual Studio 2010引入了用户设置文件（Microsoft.cpp.&lt;Platform>.users.props）以控制包括全局搜索路径在内的全局设置。这些文件位于$(USERPROFILE)\appdata\local\microsoft\msbuild\v4.0目录。当迁移到Visual Studio 2010后，Visual Studio 2005或Visual Studio 2008的目录设置将会被移动到这些用户文件中。这些文件全局设置也会被导入到所有转换而来的以及新创建的项目中。<p><strong>　　下面是通过用户界面更改设置文件的步骤</strong>：<p>　　◆点击View.Property Manage打开属性管理器。<p>　　◆展开项目节点，然后是Configuration|Platform 节点，你将会看到针对每个Configuration|Platform 的"Microsoft.cpp.&lt;Platform>.users" 文件。这些就是提供全局设置的文件，跟以前的 tools/Options/VC++ 目录是类似的。<p>　　◆复选"Microsoft.cpp.&lt;Platform>.users"，右键点击弹出窗口的属性页<p>　　◆在属性窗口页中，单击左窗格中的"VC++ Directories"，添加诸如“Include Directories"的目录的路径，以分号隔开。<p>　　◆请确保关闭Visual Studio之前保存了刚才的设置。<p>　　◆重新启动Visual Studio，新的设置将会生效。<p>　　－注意：如果你想只改变一个项目的设置，你可以右键单击该项目，弹出属性页。更改“VC++ Directories”的设置，这些设置便被保存到项目文件中。<p>　　4) 自定义生成规则的改变<p>　　在Visual Studio 2008中，自定义生成规则是由.rules文件定义的。转换后，.rules文件将会变成三个单独的文件：.targets, .xml以及.props。转换后，你会在.rules所在的目录中发现这三个文件。请注意，没有UI可用于添加新的自定义生成规则。<p>　　5) 改动检查的变化<p>　　当你按下F5键，检查改动情况的窗口可能每次会弹出，即使是刚刚才重新构建了一次。你可以参照这个博客来解决这一问题。最有可能的的原因是某些文件被列为了该项目的的一部分，但却不在磁盘上了。由于这些文件是项目文件的一部分，更新检查机制每次都会检查它们是否存在。而如果在磁盘上不存在该文件，Visual Studio 2010就会认为需要重新构建一次。解决方法是，如果那些文件不存在了，请把它们从项目文件中删除掉。<p>　　Visual Studio 2010中的一个限制是，它还不支持可控增量构建(Managed Incremental build)。我们正在研究如何在未来版本中支持这一功能。<p><strong>&nbsp; 在Visual Studio 2010转换过程中的已知问题</strong><p>　　以下是在Visual Studio 2010的转换过程中已知存在的一些问题：<p>　　1)&nbsp; TargetFrameworkVersion<p>　　转换后，托管的C++项目将设为默认为针对4.0 Framework。这种设计背后的原因是，Visual Studio 2010构建器的不支持2.0，3.0或3.5 Framework。Visual Studio 2008的构建器则必须使用2.0，3.0或3.5 Framework。为了使转换后的C++应用程序能马上就能运行，我们决定将C++程序的默认TargetFrameWorkVersion 属性改成4.0。可以通过下面其中一种方法把C++应用程序重新定向到其它Framework（如3.5）：<p>　　编辑vcxproj文件，并在第一组定义中加入以下内容：<p>&lt;TargetFrameworkVersion>器v3.5“/ TargetFrameworkVersion”<p>　　打开Visual Studio 2010的命令行，设置TargetFrameworkVersion = v3.5，然后从命令行运行devenv.exe。这将把所有C++应用的目标框架设为v3.5。<p>　　在构建程序时传递/p:TargetFrameworkVersion = v3.5参数给MSBuild：MSBuild my.vcxproj /p:TargetFrameworkVersion =v3.5<p>　　请注意，要在安装了Visual Studio 2008的情况下才能把应用程序的定向到2.0，3.0或3.5 Framework。<p>　　对于C#/ VB应用程序，如果目标Framework已经安装在了计算机上，转换过程中则不会改变目标Framework。 如果目标Framework没有安装，你可以选择下载所需要的Framework或将目标Framework升级到4.0版。<p>　　－如果在你的解决方案中混合有CSharp / VB/托管C++项目，你可能会碰到它们分别针对不同目标Framework的情况。如果被引用项目的目标Framework比引用它的项目的Framework版本还高，你可能会收到警告MSB3258：<p>-The primary reference “foo, Version=x.x.xxx.xxxx, Culture=neutral, processorArchitecture=x86” has an indirect dependency on the .NET Framework assembly “mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089” which has a higher version “4.0.0.0” than exists in the current target framework. The version found in the current target framework redist list is “2.0.0.0”. By including the primary reference you may get compile and/or runtime errors.<p>　　－你也可能如C4691这样的警告：type referenced was expected in the unreferenced assembly ‘file’, type defined in current translation unit used instead, if the Framework version of the referencing project is higher.<p>　　－你需要把解决方法中的所有项目设为同一个版本的Framework。<p>　　2)&nbsp;&nbsp;&nbsp;&nbsp; 在makefile的"Output"属性中使用引号<p>　　如果某个项目的makefile中"Output"属性里有引号，转换将无法进行。解决方法是在转换前把"Output"属性里的引号去掉。<ol><li>&lt;Tool<li>Name="VCNMakeTool"<li>BuildCommandLine="nmake /nologo &amp;quot;OUT=$(OutDir)&amp;quot; &amp;quot;OBJ=$(IntDir)&amp;quot;"<li>ReBuildCommandLine="nmake /a /nologo &amp;quot;OUT=$(OutDir)&amp;quot; &amp;quot;OBJ=$(IntDir)&amp;quot;"<li>CleanCommandLine="nmake /nologo &amp;quot;OUT=$(OutDir)&amp;quot; &amp;quot;OBJ=$(IntDir)&amp;quot; clean"<li>Output="&amp;quot;$(OutDir)hlekernel.rom&amp;quot; &amp;quot;$(IntDir)hlekernel_gen.inl&amp;quot; &amp;quot;$(IntDir)hlekernel_gen.h&amp;quot;"<li>PreprocessorDefinitions="WIN32;_DEBUG"<li>IncludeSearchPath=""<li>ForcedIncludes=""<li>AssemblySearchPath=""<li>ForcedUsingAssemblies=""<li>CompileAsManaged=""<li>/></li></ol><p>　　3)&nbsp; $(IntDir) 和 $(OutDir)中的反斜杠。<p>　　$（IntDir）和$（OutDir）分别对应属性页中的“General -> Intermediate Directories”和“General -> Output Directories”。为了统一$（IntDir）和$（OutDir）的格式，如果没有以"\"结尾的话，转换过程中会自动在它们的属性值末尾追加“\”。如果末尾有“/”的话将会被删掉。<p>　　不过，如果$（IntDir）或$（OutDir）用在makefile或自定义生成中，Exec任务会用到它，这就可能导致构建过程中断。<p>　　在makefile中，如果它们以"\"结尾，nmake工具就无法评估它的值。例如，使用如下命令，<p>　　BuildCommandLine="nmake /nologo &amp;quot;OUT=$(OutDir)&amp;quot; &amp;quot;OBJ=$(IntDir)&amp;quot;"<p>　　因为$（OutDir）和$（IntDir）末尾有“\”，nmake工具不能正确地将其展开，OUT和OBJ的值会被置为空。为了解决这个问题，你需要在属性页删除$（IntDir）和$（OutDir）中的"\"。<p>　　如果$（OutDir）或$（IntDir）被传递给自定义生成，包括生成事件、自定义生成工具，以及自定义生成步骤，你可能会遇到构建失败，其原因是“\”可能被这些工具当成了转义字符。例如，如果你有一个跟下面类似的预生成事件：<ol><li>&lt;PreBuildEvent><li>&lt;Command>cl /c&nbsp; /Fo"$(IntDir)" "$(ProjectDir)\win32.cpp"&lt;/Command><li>&lt;/PreBuildEvent></li></ol><pre></pre><p>　　命令行是：cl /c /Fo"Debug\" "C:\foo\win32.cpp" instead of cl /c /Fo"Debug\\" "C:\foo\win32.cpp"<p>　　要解决这个问题，在传递给/Fo的值中的添加一个额外的“\”(C/C++ -> Output Files -> Object File Name)，以补偿被当作转义字符的"\"。<p>　　4) 解决方案资源管理器界面<p>　　在Visual Studio 2010中，解决方案资源管理器里的文件和文件夹显示由.vcxproj.filters文件控制。如果你有名字相同但位置不同的文件夹，例如“Native\Include”和 "Include"，那么在转换后，第二个"Include"和它里面的文件将不会显示在解决方案资源管理器中。若要解决此问题，你可以重新在解决方案资源管理器创建这个文件夹，并将相应的文件添加到文件夹中。<p>　　5) 只读的项目文件或目录<p>　　当你从一个只读目录中开始升级，或是对以前只读的项目文件进行重新转换时，都有可能碰到问题。务必确保这些目录和文件都是可写的，除非你能对这些文件自动进行检查，就像在集成资源管理系统（integrated source control system）中能做到的那样。</p></div><footer class=post-footer><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Visual Studio 2010中C++项目升级指南</li><li class=post-copyright-author><strong>本文作者： </strong>Rise</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blogs.qipai360.cn/post/c-project-upgrade-guide-for-visual-studio-2010/ title="Visual Studio 2010中C++项目升级指南">https://blogs.qipai360.cn/post/c-project-upgrade-guide-for-visual-studio-2010/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/black.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.zhihu.com/people/rise-worlds><span class=icon><i class="fa fa-book"></i>
</span><span class=label>知乎</span></a></div><div class=social-item><a target=_blank class=social-link href=https://twitter.com/riseworlds><span class=icon><i class="fab fa-twitter"></i>
</span><span class=label>Twitter</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.facebook.com/rise.worlds><span class=icon><i class="fab fa-facebook"></i>
</span><span class=label>facebook</span></a></div><div class=social-item><a target=_blank class=social-link href=https://youtube.com/@YiXuan><span class=icon><i class="fab fa-youtube"></i>
</span><span class=label>YouTube</span></a></div><div class=social-item><a target=_blank class=social-link href=https://instagram.com/rise.worlds><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://t.me/riseworlds><span class=icon><i class="fab fa-telegram"></i>
</span><span class=label>Telegram</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/ubuntu-10.4-wubi-installation-bug-fix/ rel=next title="Ubuntu 10.4的wubi安装BUG修正了"><i class="fa fa-chevron-left"></i> Ubuntu 10.4的wubi安装BUG修正了</a></div><div class="post-nav-prev post-nav-item"><a href=/post/the-method-to-prevent-lingoes-2.7-from-popping-up-advertisement-windows/ rel=prev title="禁止灵格斯2.7弹出“新奇英语 互动锐词”广告窗口的方法">禁止灵格斯2.7弹出“新奇英语 互动锐词”广告窗口的方法
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2004 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rise</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.152.2 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>豫ICP备2021009490号</a>
<img src=/imgs/gongan.png alt=豫公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41162302000074" target=_blank>豫公网安备 41162302000074 号</a></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"c-project-upgrade-guide-for-visual-studio-2010","permalink":"https://blogs.qipai360.cn/post/c-project-upgrade-guide-for-visual-studio-2010/","title":"Visual Studio 2010中C++项目升级指南","toc":false,"waline3":{"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"3.5.7"}}}</script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://blogs.qipai360.cn/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOA6L0YM4CiXf9","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"rise-worlds/rise-worlds.github.io","repoid":"MDEwOlJlcG9zaXRvcnk2MTAxMTA0MA==","theme":"transparent_dark"},"js":"https://giscus.app/client.js"},"hostname":"https://blogs.qipai360.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline3"},"views":{"enable":true,"plugin":"waline3"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://blogs.qipai360.cn/js/3rd"}},"version":"4.8.3","waline3":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o 可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄 (Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"search":true,"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"3.5.7"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"3.5.7"}}}</script><script type=text/javascript src="/js/main.min.js?=1761990624" defer></script></body></html>